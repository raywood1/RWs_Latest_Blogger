---
layout: post
title: "Windows 7:  KVM in a Multimonitor Setup"
date: 2011-03-25
---

<div class="post-body">
<p>I was using two monitors with two computers.  After <a href="https://web.archive.org/web/20151125210025/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-multiple-monitors-multiple.html">reflecting on multiple monitor</a> possibilities, I installed an <a href="https://web.archive.org/web/20151125210025/http://www.google.com/search?as_qdr=all&amp;num=50&amp;q=%22ASUS+EN210%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">ASUS EN210</a> video card in each computer.  This allowed me to connect dual displays.  I decided that monitor A would be available to both computers, and monitor B would be available only to computer B.  To make this happen, I connected monitor A to a keyboard-video-mouse (KVM) switch.  So computer A was visible only on monitor A, whereas computer B was visible across the two monitors (assuming that's where I had the KVM set).<br/>
<br/>
Problem:  every time I switched back to computer B on the KVM, monitor A would go blank.  This was not a problem when I was using the KVM only to switch the mouse and keyboard, leaving each monitor dedicated to one computer.  It arose only in the dual-monitor setup.  It seemed that the computer was not remembering the dual-monitor settings for monitor A on computer B.  Each time, I had to go back into Control Panel &gt; Display &gt; Change Display Settings &gt; Detect.  (This KVM problem also seemed responsible for screwing up Adobe Acrobat 9. It was no longer remembering my toolbar settings the way I had previously set them. This seemed to be fixed by going into Acrobat's Help &gt; Repair Acrobat installation.)<br/>
<br/>
<a href="https://web.archive.org/web/20151125210025/http://www.google.com/search?as_qdr=all&amp;num=50&amp;q=%22Windows+7%22+monitor+OR+display+detect+KVM&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">A search</a> led to <a href="https://web.archive.org/web/20151125210025/http://answers.microsoft.com/en-us/windows/forum/windows_7-hardware/kvm-switch-windows-7-creates-monitor-switching/84f41660-1933-4109-9b13-1ea8a1c27be7">the suggestion</a> that the problem I was having with monitor A was with the KVM:<br/>
<blockquote>It is a problem found with those KVM switches which did not pass the console display's EDID and DDC information to all the systems connected to the KVM switch. ... <br/>
Windows 7 checks display and display card constantly different from what XP and other operating systems did.<br/>
To solve this issue, just replace the KVM switch with those KVM switches supporting FULL TIME Active DDC function.<br/>
Please check ConnectPRO new UR or PR serial KVM switches which support Active DDC function to all the ports.</blockquote>That post pointed me toward <a href="https://web.archive.org/web/20151125210025/http://msdn.microsoft.com/en-us/windows/hardware/gg487352.aspx">a Microsoft webpage</a> with more technical information.  I did <a href="https://web.archive.org/web/20151125210025/http://www.google.com/search?as_qdr=all&amp;num=50&amp;q=%22Windows+7%22+KVM+EDID+%22full+time%22+%22active+DDC%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">another search</a> and saw references to ConnectPRO there too.  <a href="https://web.archive.org/web/20151125210025/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;as_qdr=all&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Windows+7%22+KVM+site%3Anewegg.com&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=f&amp;oq=">A different search</a> suggested that lots of users were running into this problem.  <a href="https://web.archive.org/web/20151125210025/http://www.newegg.com/Product/PowerSearch.aspx?N=100007790&amp;IsNodeId=1&amp;SubCategory=143&amp;GASearch=3">Newegg's Power Search</a> didn't offer an operating system selection, and they didn't seem to carry ConnectPRO KVMs.  A <a href="https://web.archive.org/web/20151125210025/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=MPY&amp;as_qdr=all&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;biw=938&amp;bih=837&amp;q=%22Windows+7%22+KVM+%22active+DDC%22&amp;tbs=shop%3A1&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=f&amp;oq=">Google Shopping search</a> led to two ConnectPRO KVMs, each costing at least $130.  I ran across <a href="https://web.archive.org/web/20151125210025/http://www.sevenforums.com/graphic-cards/127567-connection-monitor-via-vga-switch.html">a workaround</a> suggestion to hit Win-D before and after switching with the KVM, but apparently that worked only with XBOXes, or anyway it didn't work for me.  There was <a href="https://web.archive.org/web/20151125210025/http://msdn.microsoft.com/en-us/windows/hardware/gg487330.aspx">another workaround</a>, too technical for my blood.  <a href="https://web.archive.org/web/20151125210025/http://www.windows7update.com/windows-7-rc-versus-aten-kvm-switch-comments.html">Another thread</a> prompted me to check for the most current driver for my ASUS EN210 graphics card.  As I recalled, the usual advice was to look for the latest drivers on the chipset manufacturer's webpage, so after consulting the details on the EN210, I went to <a href="https://web.archive.org/web/20151125210025/http://www.nvidia.com/Download/Find.aspx?lang=en-us">the NVIDIA website</a> and searched for GeForce 210 drivers.  I went with the most recent WHQL-certified driver.  After reboot, I saw that this did not solve the problem.  Note:  the machine had all current Windows updates at this point.<br/>
<br/>
It seemed I had a choice.  I could go back to using one monitor per computer, or I could look for a hardware multimonitor solution.  Going back would mean waiting for Microsoft to fix this problem with Win7.  There was no guarantee that that would ever happen.  Basically, if I wanted multimonitor support for KVM-type functionality for two computers running Win7 (as distinct from one Win7 and <a href="https://web.archive.org/web/20151125210025/http://www.amazon.com/TRENDnet-2-Port-Switch-Cables-TK-209K/product-reviews/B000L4D42Q/ref=cm_cr_dp_all_summary?ie=UTF8&amp;showViewpoints=1&amp;sortBy=bySubmissionDateDescending">one WinXP</a>), it seemed I would either have to buy an expensive KVM or maybe come up with some other kind of <a href="https://web.archive.org/web/20151125210025/http://www.tomshardware.com/forum/2129-63-windows-compatibility">funky plugging and switching</a>.  For instance, I wondered whether I could make a go of it with two keyboards, two mice, and a switch just to flip monitor A from one computer to the other.  But this wouldn't circumvent the problem that Windows 7 was constantly polling the monitor, and that was the only thing that counted.  I found a device called the Geffen DVI Detective, which for $80 would remember the EDID and therefore defeat the problem (but only for monitors using DVI connectors).<br/>
<br/>
Then I saw that <a href="https://web.archive.org/web/20151125210025/http://www.amazon.com/s/ref=bl_sr_electronics?_encoding=UTF8&amp;node=172282&amp;field-brandtextbin=ConnectPro">Amazon carried</a> a bunch of ConnectPRO KVMs, and some were far less expensive.  They did not carry the PR-12, which was the one PS/2 (as distinct from USB) KVM that ConnectPRO offered for my humble purposes:  two computers, one keyboard, one monitor, one mouse.  USB did not work reliably for both keyboard and mouse when Win7 was not running -- when, for instance, I was booting from a CD, or was adjusting the BIOS settings before the operating system booted.  But then I remembered that my new motherboards had only one PS/2 port, and the PR-12 would definitely require two (one each for keyboard and mouse).  I did have the option of using USB mice, one dedicated to each computer, and in fact had been doing that for a while, partly for the reason of pre-boot capability just mentioned and partly to reduce the strain on either wrist.  Another option was to use <a href="https://web.archive.org/web/20151125210025/http://raywoodcockslatest.blogspot.com/2011/03/adding-ps2-port.html">an adapter</a> or some other gizmo to give me a second PS/2 port.<br/>
<br/>
From ConnectPRO's <a href="https://web.archive.org/web/20151125210025/http://connectpro.com/prod_kvm_usb.html">product comparison page</a>, it seemed there were several options to consider.  One was the choice between VGA and DVI.  DVI provided superior video, but VGA (using D-Sub connectors) was functioning well for me at the moment.  (DVI achieved using DVI-VGA adapters had, in my impression, the same risk of video problems as plain old VGA.)  It seemed that a couple of inexpensive video cards had eliminated problems of ghosting that I was getting when I had the monitors connected directly to the motherboards.  There was also the choice of two- or four-computer KVMs.  I needed only two.  Switching via hotkey was preferable to having to reach up and punch a button on the KVM in order to switch between computers.  All of the relevant ConnectPRO KVMs had All-time Full DDC, which was evidently the core need behind this KVM search.  ConnectPRO's Pro line of KVMs apparently did not have the Dynamic Device Mapping (DDM) technology that would remember attached USB peripherals (e.g., speakers, mice) and would thus eliminate lag time required for the switched computer to re-detect the devices.  It was confusing, shopping among these devices on Amazon, because there were various "kit" options that were described as "new" and yet did not appear on ConnectPRO's website, and also because now it started to look like some of these products did not have Full DDC and/or DDM.  What I came up with was a choice, for me, between <a href="https://web.archive.org/web/20151125210025/http://www.amazon.com/gp/offer-listing/B001TK8NR2/ref=dp_olp_new?ie=UTF8&amp;condition=new">the UR-12 PRO</a>, with VGA and DDC but not DDM and no hotkey option ($102 with shipping from ConnectPRO through Amazon); <a href="https://web.archive.org/web/20151125210025/http://www.amazon.com/ConnectPRO-UR-12-2-port-Switch-Cables/dp/B003HNF714/ref=sr_1_2?ie=UTF8&amp;s=electronics&amp;qid=1301093482&amp;sr=1-2">the UR-12 PLUS</a>, with VGA, DDC, DDM, and a hotkey option ($176); and the <a href="https://web.archive.org/web/20151125210025/http://www.amazon.com/gp/offer-listing/B003X5FM6Q/ref=dp_olp_new?ie=UTF8&amp;qid=1301094826&amp;sr=1-1&amp;condition=new">UD-12 PLUS</a>, which was the same as the UR-12 PLUS but with DVI (and therefore with VGA as an option, via adapter) ($191 from a couple of sellers).<br/>
<br/>
Since I was having no video issues at the moment, and might not have any again for some time, I decided to go with VGA rather than DVI, all other things being equal.  If I did get video problems, I could sell one KVM and upgrade to another later.  So then it was a question of whether I was willing to pay an extra $74 for DDM and a hotkey option.  DDM was nice -- I had noticed the lag in responsiveness at some point, hard to recall at the moment but apparently when I had upgraded from Windows XP to Windows 7 -- but that was not really bothering me much at present.  Those delays, and the hotkey, were especially important when I was doing a lot of switching between computers, which happened primarily when I was testing or tinkering with hardware or software on one machine and logging the developments on the other.  I was not presently doing much of that, and didn't plan to be doing much of it anytime soon.  It occurred to me that, if the DDM lags did bother me at such times, I could always dedicate one mouse, one monitor, and one keyboard to each computer at those times.  I could arrange that on my desk, and then the only lag would be the time needed to reorient my hands on the other keyboard.  Indeed, for purposes of working with the BIOS and such, I could simply keep a PS/2 keyboard always plugged in and standing off to the side of each computer, in addition to the USB keyboard connected to the KVM.  (PS/2 was not hot-swappable; it would be necessary to reboot to have the keyboard be recognized if it were not plugged in at time of bootup.)  Looking at the choice again, I reconsidered that the price difference between the UR-12 PLUS and the UD-12-PLUS was only $15.  From that perspective, I would choose the latter over the former, so as to wrap up the best product at not much additional cost; and in that case, the price difference between the solution with or without DDM, hotkey, and DVI was substantial:  the UD was almost twice the price of the UR.<br/>
<br/>
As long as I was sure I did want to use dual monitors on computer B, sometimes swapping monitor A between computers A and B, I would need Full DDC, and it seemed the choice was then to spend $102 on a ConnectPRO UR-12 PRO KVM.  If I hadn't gotten the video cards for only $18 each, the decision to add dual monitor capability (with KVM and video cards) would then have cost me more than $150.  It was worth it -- dual monitor capability added a lot to a workspace -- but it was turning into more hassle and expense than it should have been.  I belatedly realized that perhaps I should have looked for a motherboard with dual monitor capability and with enough video memory so that the computer would not struggle to switch between windows on the same monitor, as computer A had been doing before I added the video card.  Desk space permitting, that kind of expense also raised the question of perhaps having three dedicated monitors -- one for computer A and two for computer B, and recabling one of the latter to computer A if a multimonitor need arose there -- thereby reducing the KVM need to a simple $20-30 device that would swap keyboards and mice, assuming those were not likewise dedicated to single machines.  The temptation to just get a third monitor and forget about the Full DDC KVM would be even stronger if I were looking at the nearly $200 price tag for a ConnectPRO UD-12 PLUS KVM.  But even without that, as I considered the time I had devoted to screwing around with KVMs, on this and on previous occasions, I did think that possibly the best approach would be to go with the third monitor, wait for someone to compete with ConnectPRO and/or for Microsoft to get its act together -- to buy a third monitor as an interim solution, in other words, and to sell it when and if a superior KVM alternative emerged.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**Anonymous**:
For the record another thing you can try is just pulling the DDC pin out of the VGA or DVI connector. It stops windows from realizing the monitor has been switched off and it leaves dual monitor mode running the whole time.Pin 7 on a DVI connector and pin 12 on a VGA connector, just pull the pin out with some pliers and the issue goes away.

