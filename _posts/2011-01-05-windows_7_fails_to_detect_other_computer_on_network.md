---
layout: post
title: "Windows 7 Fails to Detect Other Computer on Network"
date: 2011-01-05
---

<div class="post-body">
<p>I was becoming acquainted with Windows 7.  Sometimes, when I booted it up, it would immediately recognize the other computer (running Windows XP) on my home network, and would also recognize the (Linux-based) Synology Network Attached Storage (NAS) device I had connected.  At other times, unfortunately, the Win7 computer would only see itself.  This post describes steps I took to resolve that inconsistency.<br/>
<br/>
I did <a href="//web.archive.org/web/20190906053714/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=Hy7&amp;rlz=1R1GGLL_en___US408&amp;q=%22Windows+7%22+network+%22doesn't+see+other%22+OR+%22doesn't+see+the+other%22+-Apple+-Mac&amp;aq=f&amp;aqi&amp;aql&amp;oq&amp;gs_rfai">a search</a> on this problem.  I was inspired to undertake this investigation after I used System Restore to restore an earlier state of the computer.  Those other devices were now not visible in Windows Explorer.  They had been visible just a few minutes earlier.  To my knowledge, I had not done anything that would have made those devices more visible, or less so.<br/>
<br/>
When I searched, I noticed <a href="https://web.archive.org/web/20190906053714/http://windows7forums.com/windows-7-networking/31988-windows-7-loses-drive-mapping-after-sleeping.html">a post</a> in which someone said that Windows 7 was also losing track of drive mapping after it went into sleep mode.  I wondered if that was related.  The previous day, the computer had magically mapped drive D, a network drive on the Synology NAS, without any instruction from me to do so.  The poster said that he was experiencing both of these problems.  That particular thread concluded without an indication of a solution.  <a href="https://web.archive.org/web/20190906053714/http://www.annoyances.org/exec/forum/win7/1285698021">One poster</a> said, "Ultimately this is just the nature of the way networking is sometimes."  But it seemed to me that it had never been that way between the XP machine and the NAS, or between the NAS and the Ubuntu setup that I had been using before I got Windows 7.<br/>
<br/>
I wondered if it was somehow an XP problem.  The WinXP machine was currently in touch with the NAS.  Was it possibly barring the Win7 machine from seeing either itself or the NAS?  I rebooted the WinXP machine, but that didn't make a difference on the Win7 machine.<br/>
<br/>
It wasn't a hardware problem, or even a networking problem per se.  Access to the Synology unit was through a web-based program.  On the Win7 computer, I could go into that Synology program and could communicate with the Synology NAS unit.  Synology could see the NAS unit, but Microsoft couldn't.  Apparently whatever was keeping Win7 from seeing the NAS was also keeping it from seeing the WinXP machine.  It was all or nothing:  either Win7 could see them both, or (as at present) it could see neither.<br/>
<br/>
After going online in Internet Explorer and accessing the Synology NAS from the Win7 machine, I rebooted the Win7 machine.  That did not make a difference.  The Win7 machine was still unable to see the others.<br/>
<br/>
In Control Panel &gt; Network and Sharing Center &gt; Troubleshoot problems, I tried the Incoming Connections option and said, "Find this computer on the network."  It came back with this advice:<br/>
<blockquote>Reconfigure your network<br/>
<br/>
To prevent problems other computers or devices might have when connecting to your computer, no more than one device should perform network address translation (NAT).</blockquote>I followed the link into Windows Help and Support, but that wasn't actually too helpful and supportive.  I clicked Next, and the Incoming Connections troubleshooter confirmed, "More than one device is performing network address translation (NAT)."  So, OK, which device?  I clicked "View detailed information" and went into Detection Details.  All I could find there that looked like it might be informative was a Network Diagnostics Log.  Following the links there in <a href="https://web.archive.org/web/20190906053714/http://www.eti1.co.uk/downloads/software/software.html?id_cms=52">the Help dialogs</a>, it seemed that, to open that up, I would have to use <a href="https://web.archive.org/web/20190906053714/http://www.eti1.co.uk/downloads/software/thermadata_v3.4.7.exe">ThermaData Logger</a> software.  This software seemed to be <a href="//web.archive.org/web/20190906053714/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=4cU&amp;rlz=1R1GGLL_en___US408&amp;q=%22ETI+Software%22+Therma+OR+ThermaData+OR+ThermaDataT&amp;aq=f&amp;aqi&amp;aql&amp;oq&amp;gs_rfai">almost completely unknown</a> through the vendor, ETI Software, that Win7 pointed me to, but I did find plenty of links for it <a href="//web.archive.org/web/20190906053714/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=KdU&amp;rlz=1R1GGLL_en___US408&amp;q=ThermaData+OR+ThermaDataT+software&amp;aq=f&amp;aqi=m1&amp;aql&amp;oq&amp;gs_rfai">elsewhere</a>.  I had no idea why Microsoft required me to download a 29MB file from a slow connection just to read a log file.  While I was waiting on that, I found <a href="https://web.archive.org/web/20190906053714/http://www.thermoworks.com/products/logger/thermadata_software.html">ThermoWorks</a> -- the need for using thermal logging software was another mystery -- and was right on the verge of downloading their <a href="https://web.archive.org/web/20190906053714/http://www.thermoworks.com/software/thermadata/THERMADATA_LOGGER_3_4_5.zip">ThermaData Software Suite for Windows</a> when I looked back at the Help dialog and decided to try instead downloading <a href="https://web.archive.org/web/20190906053714/http://www.eti1.co.uk/downloads/software/thermadatastudio/thermadataDataStudio_1_0_5.exe">ThermaData Studio 1.0.5</a>, which was apparently an entirely different deal.  That turned out to be a 12MB file.  While that was downloading, I went back to the dialog and clicked on the "Other Networking Configuration and Logs" link to open NetworkConfiguration.cab.  That led me to two text files:  ipconfig.all.txt and route.print.txt.  Neither contained any obvious references to NAT.  I installed ThermaData Studio.  Back in the dialog, I tried again on the link to the Network Diagnostics Log.  ThermaData Studio wasn't going to read it right there on the spot, so I downloaded the log and tried opening it from there.  But when I double-clicked on it, I got a message, "Windows can't open this file."  I went into the Start Menu and opened ThermaData Studio from there and tried to use it to view the file that I had downloaded.  At first, it didn't see anything -- it was looking for .msdb files -- but when I told it to look for .etl files, it found the download.  It gave me a completely empty file.  ThermaData Studio looked like solid software, but since I did not need it after all, I uninstalled it.<br/>
<br/>
We were left with the question of which devices on my system were set to NAT.  Trying another approach, I disconnected the WinXP machine from the network and re-ran the Win7 Incoming Connections troubleshooter.  That didn't eliminate the NAT problem.  I reconnected the WinXP machine, disconnected the modem from the router, and ran the troubleshooter again.  Now the NAT problem was gone, though now there was a new problem, where the troubleshooter said it needed more information.  So, OK, possibly the modem plus at least one other device was doing NAT on my network.  I had seen <a href="https://web.archive.org/web/20190906053714/http://en.community.dell.com/support-forums/network-internet-wireless/f/3324/t/19327823.aspx">a post</a> indicating that modems and routers can both do NAT, so I plugged everything back where it belonged and looked at the pages on <a href="https://web.archive.org/web/20190906053714/http://portforward.com/help/portforwarding.htm">port forwarding</a> and <a href="https://web.archive.org/web/20190906053714/http://apttech.wordpress.com/2009/09/04/how-to-put-a-motorola-netopia-3000-router-in-bridge-mode/">putting a router into bridge mode</a> that that post linked to.  Following what the latter seemed to be saying, I looked at a sticker on the bottom of my modem.  (I didn't seem to have a manual for it, but could probably have downloaded one.)  It gave me an IP address to enter into my Internet browser; and when I went to the appropriate page, it asked me for a code that appeared on that sticker.  This led me into the configuration software for the modem.  After poking around for a minute, I found a page for the modem's PPP location.  This seemed to be what I wanted.  It gave me two options:<br/>
<blockquote>PPP is on the modem.  This is the normal mode for this modem.  The PPP session is initiated from the modem.<br/>
<br/>
PPP is on the computer, gateway or router.  This should only be used if you need to run a PPPoE client on your PC or you use another device (e.g., gateway or router) to initiate a PPPoE session.  This is often referred to as "Bridged" mode.</blockquote>Since option A wasn't working for me, and since the post seemed to be saying that I should use option B, I switched to that and saved the change.  This gave me a Location Warning.  It said,<br/>
<blockquote>When using Bridged mode, your access to the modem becomes limited.  To return to the DSL modem user interface after this change you need to directly connect your PC to the modem without any gateway or router between the modem and the PC, and configure your computer appropriately.<br/>
<br/>
Configure the IP address of your computer to be on the same network as the modem by using an IP address of the form 198.168.1.x (except 192.168.1.254) and a network mask of 255.255.255.0.<br/>
<br/>
You may also return to the DSL modem user interface by resetting the modem back to its initial defaults.  All configuration changes and other settings will no longer be available if this is done.  To reset the modem press the "Reset" button located on the back of the modem.</blockquote>We still had a problem.  The modem was supposed to be restarting, but it wasn't working.  It had three green lights on, including the one for the ethernet (i.e., router).  But why wasn't its Internet light on?  I unplugged its power cord, waited a minute or so, and plugged it back in.  That didn't help.  I tried the same thing with its Internet (i.e., telephone) cord.  When it was unplugged, the modem's DSL light was flashing red.  So I seemed to have a mistaken understanding of the difference between its DSL and Internet lights.  Well, whatever.  It wasn't working, is the point.  I thought that possibly AT&amp;T (my ISP) needed the modem to be in the other mode.  I thought about calling them to ask, but Christ, to enter again into <a href="https://web.archive.org/web/20190906053714/http://raywoodcockslatest.blogspot.com/2010/12/at-phone-home.html">that vale of tears</a>:  no way.<br/>
<br/>
Well, I would have liked to research the modem situation further, but there was just one problem:  I couldn't, as I now had no Internet connection.  I ripped off the sticker on the back of the modem that said, "Remove only if advised by tech support" and there, in all its glory, behold:  the Reset Hole.  I jammed a paper clip into it and watched in amazement as this achieved ... nothing.  It seemed the Reset Hole had gone stale.  It took a couple of tries, and possibly the discovery that this unit required a minimum of 30 seconds of pressure in the hole to achieve the desired reset.  Even so, I could get online only by cabling the computer directly to the modem.  The router seemed to be dysfunctional.  There was, inevitably, a call to AT&amp;T after all, and it actually took only ten minutes<br/>
<br/>
I went back to the modem's webpage, but was now getting "Unable to connect."  Taking plan B, I cabled the WinXP computer directly to the modem, as advised above.  But still, no joy.  No Internet light on the modem; Unable to connect in Firefox.  Now I had really done it.  I had gone and given myself no alternative but to call AT&amp;T.  A half-hour later, we emerged with the discovery that I, in keeping with the spirit of the event, had lost my router password and unfortunately could not go online to figure out how to reset it, given that the reset button seemed to be having no effect no matter how thoroughly I massaged it.  Oh, and the modem was back in its original mode.  End of bridge mode strategy. <br/>
<br/>
I ran <a href="//web.archive.org/web/20190906053714/https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=router+%22can't+reset%22+Linksys&amp;ie=utf-8&amp;oe=utf-8">a search</a> on this reset problem.  It produced some possibilities.  One was that I needed to <a href="https://web.archive.org/web/20190906053714/http://www.ehmac.ca/mac-ipod-help-troubleshooting/58031-linksys-wireless-router-cant-reset-password.html#post604476">reset my TCP/IP preferences</a> to match the router's IP address.  Another was that I just wasn't following <a href="https://web.archive.org/web/20190906053714/http://nabtron.com/forgot-linksys-wrt54gr-password-how-to-reset-settings-of-the-router/180/">the right steps</a> to reset it.  Apparently it was <a href="https://web.archive.org/web/20190906053714/http://www.computing.net/answers/networking/cant-reset-linksys-router/19247.html">too early</a> to call it a brick; but even if it hadn't been, there seemed to be some kind of <a href="https://web.archive.org/web/20190906053714/http://forums.cnet.com/7723-7589_102-168303.html">de-bricking option</a>.  Or maybe I just needed to go through <a href="https://web.archive.org/web/20190906053714/http://en.kioskea.net/forum/affich-10899-trouble-with-linksys-router-wrt54gs">the full set of steps</a> for setting up the network properly.  The part that I may have left out, in resetting the router, was that I did not disconnect all except the power cable before doing the reset.  So I did that now, and held the reset button down for an overly long time.  I replugged the cable between it and a computer.  In the computer's web browser, I went to 192.168.1.1.  This connected me to the router's webpage.  The password to get in, after resetting, was admin.  Now I set Wireless SSDI Broadcast to Disable.  The webpage said I needed to initiate the push-button setup at this point.  It seemed they were referring to the backlit Cisco Systems logo on the front of the unit; pressing it revealed that it was in fact a button, and this produced a message on the webpage:<br/>
<blockquote>Accepting clients!<br/>
<br/>
You will be returned to the previous page after SES configuration completed.</blockquote>It then did its thing for a couple of minutes, and then I was back at the webpage.  The manual seemed to indicate that WPA2 Personal would provide the best available security for my setup.  I enabled Wireless MAC filtering.  The manual said that the option to Filter Internet NAT Redirection "uses port forwarding to block access to local servers from local networked computers."  That sounded vaguely like what someone had said I needed to make my network work again, so I enabled it.  <a href="//web.archive.org/web/20190906053714/https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=PPTP+L2TP+IPsec+router&amp;ie=utf-8&amp;oe=utf-8#sclient=psy&amp;hl=en&amp;source=hp&amp;q=PPTP+L2TP+IPsec+router+home&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=9bef8cda26d1a6ec">A search</a> led to <a href="https://web.archive.org/web/20190906053714/http://www.techspot.com/vb/topic81520.html">the advice</a> that I should not enable these until I needed them.  I disabled Wireless Access Web, in this wired setting.  A few more settings, and then I was done -- and still unable to connect to the router.  The troubleshooter was going to be unable to give me much help, it seemed until I connected the router to the modem, so I did that.  That still wasn't working, so I used the router's webpage Administration &gt; Diagnostic options to ping the local IP address of 192.168.1.1.  That worked, but was I just pinging the router itself?  I tried 192.168.1.100.  That worked too.  I thought maybe the Traceroute diagnostic would be more helpful.  It wasn't.<br/>
<br/>
The manual gave some troubleshooting steps.  Following its guidance, I made sure the router's light was solid green.  The other instructions weren't applicable.  For a moment there, I gave up on life.  Then I ate a piece of chocolate and tried removing that NAT Redirection filter.  That wasn't the solution, but it gave me enough cockeyed optimism to try the Internet Connections troubleshooter.  It -- a veritable font of sharp-eyed discernment -- said this:<br/>
<blockquote>Your broadband modem is experiencing connectivity issues.</blockquote>It said I had better power down the modem, wait 10 seconds until the lights were off, and then power it back up.  I decided to also plug its cable back in.  I was hoping that the troubleshooter would at least say, "Hey, we have found your modem -- so far, so good!" and I guess in a sense they did.  With everything duly de- and re-powered and cabled, I tried it again.  Now, by gum, we had a breakthrough:<br/>
<blockquote>Your computer appears to be correctly configured, but the device or resource (primary DNS server) is not responding.</blockquote>What could this mean?  I had no idea.  I rolled the dice again on the Incoming Connections troubleshooter.  While that was running, I realized that a minor miracle had occurred.  Very quietly, while I was over there fixating on the Win7 computer, the computer on which I was writing this post had connected to the Internet -- through the cable, through the router, through the modem, through thick and thin!  And ... er, no, it hadn't.  Correction on that.<br/>
<br/>
But at least there was a glimmer of hope.  By this point in the day, I had moved away from the Windows XP system, on the second computer:  I had rebooted with an Ubuntu live CD for maintenance purposes, and was therefore  writing this post in Firefox on that machine while it endured its maintenance throes.  And on that machine, for a minute there, I thought maybe it had made Contact.  But it had not.  I was in error.<br/>
<br/>
Well, I had blown a good part of a day on a single troubleshooting problem.  This was, thankfully, a less frequent experience than it had been in years past.  I really and truly hated networking, and it probably showed, by this point, in my failure to grasp some obvious solution or to utilize some true-blue technique.  I really had no clue.  The problem wasn't with the modem or the Internet connection; I could save this post when I connected directly from the modem to this computer.  Possibly the problem wasn't between the Win7 computer and the router; the troubleshooter had felt that everything was in place there.<br/>
<br/>
Trying something a little different, I got an ethernet switch off the shelf and connected both computers directly to the modem through that.  And, whoa, that changed everything instantly.  The Win7 computer popped up a dialog asking me to Set Network Location, and it was immediately connected to CNN.com, and the Ubuntu live CD spun up and updated this text shortly thereafter.  So.  It was the router.  I knew it all along.  What could this mean?  It could mean (a) the router was malfunctioning or (b) I did not have its settings right or (c) the real explanation, which I did not presently know.  Putting my money on (b), I reconnected the Win7 machine to the router, went to its webpage, and chose the Administration &gt; Factory Defaults option.  When it was done wiping out all my hard work, it required the no-username, "admin" password entry.  I ran the Win7 Incoming Connections troubleshooter again.  It said it needed more info.  I tried it again with the modem connected to the router.  (CNN.com was not responding at that point.)  This came back with the message about how the modem was experiencing connectivity issues.<br/>
<br/>
We seemed to have the beginnings of insight.  It appeared that I should have tried the ethernet switch and the factory defaults, right away, as alternatives to my custom configuration of the router.  Experiencing success with one or both of those alternative approaches would have clarified matters.<br/>
<br/>
But that wouldn't be networking -- because, now that I had unplugged and replugged the switch a few times, it was no longer doing the job on either computer.  Everything was connected to it, as before, and the modem's lights looked right, but neither computer was able to connect.  With the switch still connected, I tried rebooting the Win7 computer.  It was no use.  The Win7 machine was still not able to see the world, and the Ubuntu computer was pretending to connect.  I powered down the switch and tried a direct connection from the modem to the Ubuntu computer.  Still crawling.  I powered down the modem for a minute.  That did it:  the Ubuntu machine was now going online without a sweat.  I tried the switch again.  That worked on both machines now.  So apparently the switch did get confused and need some time off.<br/>
<br/>
The conclusion seemed to be that, if I needed a router, I needed to try a new one, and otherwise I should just use the switch and power it down for a while if it failed to work.<br/>
<br/>
Both computers were now going online successfully.  What did the Win7 troubleshooters have to say about this?  The Internet Connection troubleshooter said that it "couldn't identify the problem."  This was apparently tactful speech:  it seemed to mean that it couldn't identify *a* problem, but didn't want to tell the user that s/he was imagining things.  The Incoming Connections troubleshooter said this:<br/>
<blockquote>Troubleshooting was unable to automatically fix all of the issues found.  You can find more details below.<br/>
<br/>
Problems Found<br/>
<br/>
Windows requires more information to diagnose the problem.</blockquote>Here, too, there seemed to be a bit of a bullshit factor.  I had been taking these troubleshooters as though they meant exactly what they said -- that, in the latter case, there was a problem, though it was difficult to diagnose -- but now it began to seem that they might say this when there wasn't necessarily a problem.  Pointing me to an online source of the "more information" that the program needed was a funny gesture when, according to the troubleshooter itself, I might not be able to go online.  It seemed pretty lame, worthy of Windows 95.  After all, this was Microsoft's software reporting on Microsoft's software.<br/>
<br/>
What remained, it seemed, was to choose between the switch and a new router.  That was a question for <a href="https://web.archive.org/web/20190906053714/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-home-network-with-router-or.html">another post</a>.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**Anonymous**:
Well that would be the most rambling post I have ever waded through.Exceeded my attention span at about para 20.

**raywood**:
I hope you found a better solution somewhere else.  If so, you're welcome to post a link here.

**Anonymous**:
jfetzerRan onto this post while experiencing the same problem with my office network.  This is one of a great number of inexplicable difficulties encountered with Windows 7.  Maybe if you're a network engineer and enjoy spending hours attempting to diagnose strange errors, it's great.  My view is that this is the worst operating system I've ever tried to use.  Does MS actually expect non-experts to be able to drive this thing?  I've decided to finally break down and try Apple.  Simultaneously switching to Windows 7 and Office 2007 did me in.

