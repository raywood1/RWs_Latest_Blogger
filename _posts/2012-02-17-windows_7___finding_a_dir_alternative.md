---
layout: post
title: "Windows 7:  Finding a DIR Alternative"
date: 2012-02-17
---

<div class="post-body">
<p>I needed a DIR-type listing that would provide extended information about a file:  its name, date, and size, and also its path (i.e., the folder and subfolder where it was located), all on a single line of output.  DIR didn't seem to be capable of this, and neither did <a href="https://web.archive.org/web/20150816194138/http://www.makeuseof.com/tag/5-ways-to-print-folder-and-directory-contents-in-windows/" target="_blank">the utilities</a> I found with <a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=BT&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=dir+path+filesize+OR+%22file+size%22+%22Windows+7%27+CMD+OR+command&amp;oq=dir+path+filesize+OR+%22file+size%22+%22Windows+7%27+CMD+OR+command&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=3&amp;gs_upl=1303l9372l0l9759l27l14l0l0l0l0l429l2229l5.1.3.2.1l12l0" target="_blank">a search</a> (e.g., <a href="https://web.archive.org/web/20150816194138/http://www.karenware.com/powertools/ptdirprn.asp" target="_blank">Karen's Directory Printer</a>).<br/>
<br/>
<a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=zga&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22directory+listing%22+OR+%22file+list%22+%22Windows+7%22+date+time+path+%22alternative+to+DIR%22+OR+%22instead+of+DIR%22&amp;oq=%22directory+listing%22+OR+%22file+list%22+%22Windows+7%22+date+time+path+%22alternative+to+DIR%22+OR+%22instead+of+DIR%22&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=3&amp;gs_upl=284892l301222l0l301463l73l29l4l0l0l0l416l2735l11.9.2.0.1l23l0" target="_blank">Another search</a> raised the possibility that <a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=Pna&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Windows+7%22+Linux+utility&amp;oq=%22Windows+7%22+Linux+utility&amp;aq=f&amp;aqi=g-v1&amp;aql=&amp;gs_sm=3&amp;gs_upl=523345l525080l0l525360l13l12l0l0l0l0l281l1523l6.3.3l12l0" target="_blank">certain Linux utilities</a> brought over to Windows might have this kind of capability.  I didn't want to run a <a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?q=Linux+OR+Ubuntu+%22virtual+machine%22+%22on+Windows+7%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">Linux virtual machine</a> on Win7; I just wanted to be able to run Linux commands that might add functionality I wasn't getting in Windows 7.<br/>
<br/>
Linux commands were probably not the only alternative.  For instance, I could have learned how to use Windows <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/Windows_PowerShell#Scripting" target="_blank">PowerShell scripts</a>.  My general impression of the Microsoft approach (as in the contrast between original BASIC and VB) was that, unfortunately, something that could be done with one relatively simple command in another tool would require three or four lines of code, which I would be able to write only after mastering a handful of relatively abstruse programming concepts, in the Microsoft product.  This impression seemed borne out when <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/Windows_PowerShell#Scripting" target="_blank">a search</a> led to <a href="https://web.archive.org/web/20150816194138/http://gallery.technet.microsoft.com/scriptcenter/e789e7f7-41ef-4314-977c-51d98bde5234" target="_blank">an indication</a> that the DIR equivalent in PowerShell would require a multiline FOREACH loop.<br/>
<br/>
<a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/Cygwin#Alternatives" target="_blank">Preliminary inquiries</a> gave me the impression that <a href="https://web.archive.org/web/20150816194138/http://www.cygwin.com/" target="_blank">Cygwin</a> sought to provide a subsystem that would <a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=rjG&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=Cygwin+emulate&amp;oq=Cygwin+emulate&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=3&amp;gs_upl=9201l9201l0l11516l1l1l0l0l0l0l0l0ll0l0" target="_blank">emulate</a> a Linux machine within Windows.  There were <a href="https://web.archive.org/web/20150816194138/http://stackoverflow.com/questions/57627/msys-vs-cygwin" target="_blank">indications</a> that other projects (e.g., <a href="https://web.archive.org/web/20150816194138/http://www.mingw.org/wiki/MSYS" target="_blank">MSYS</a>) sought to provide a somewhat comparable (e.g., 110MB) environment.  These seemed a tad heavy for my purposes; I was looking for something more like <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/summary.html" target="_blank">GnuWin</a>, which was described as relying "only on libraries provided with any standard 32-bits MS-Windows operating system" and as not needing any Unix emulation.  Ideally, I would have some cool, relatively simple Linux-like commands available at the Windows command prompt.<br/>
<br/>
By this point in my investigation, several people had mentioned <a href="https://web.archive.org/web/20150816194138/http://www.gnu.org/software/coreutils/" target="_blank">CoreUtils</a>.  This turned out to be <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/packages.html" target="_blank">a package</a> within <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/summary.html" target="_blank">GnuWin</a>.  <a href="https://web.archive.org/web/20150816194138/http://www.gnu.org/software/coreutils/" target="_blank">The CoreUtils homepage</a> described it as "the basic file, shell, and text manipulation utilities of the GNU operating system."  <a href="https://web.archive.org/web/20150816194138/http://www.gnu.org/" target="_blank">GNU</a> was "a Unix-like operating system," in development <a href="https://web.archive.org/web/20150816194138/http://www.gnu.org/gnu/linux-and-gnu.html" target="_blank">since 1983</a>, that apparently provided <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/GNU/Linux_naming_controversy" target="_blank">most of the materials</a> used by <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/History_of_Linux" target="_blank">Linux</a> (which was, in turn, the source of <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/Debian" target="_blank">Debian</a> Linux, from which <a href="https://web.archive.org/web/20150816194138/http://raywoodcockslatest.blogspot.com/2011/01/farewell-ubuntu.html" target="_blank">Ubuntu</a> was built).<br/>
<br/>
To clarify, it appeared that the <a href="https://web.archive.org/web/20150816194138/http://www.gnu.org/software/coreutils/manual/coreutils#Introduction" target="_blank">CoreUtils</a> existed in <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/GNU_Core_Utilities" target="_blank">GNU</a>, and there was an offshoot called <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/packages/coreutils.htm" target="_blank">CoreUtils for Windows</a>.  Apparently this was what I would be getting through GnuWin.  There were other approaches to this sort of thing (e.g., <a href="https://web.archive.org/web/20150816194138/https://github.com/bmatzelle/gow/wiki" target="_blank">Gow</a>, <a href="https://web.archive.org/web/20150816194138/http://utools.com/" target="_blank">UTools</a>, <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/unxutils/" target="_blank">UnxUtils</a>), but my sense at this point was that GnuWin was <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/?source=directory" target="_blank">dominant</a> in this category.<br/>
<br/>
I looked at <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/packages/coreutils.htm" target="_blank">the list</a> of tools included in CoreUtils (for Windows).  I didn't count them, but I thought I remembered seeing an indication that there were more than 100 of them.  They were grouped into three main categories:  file utilities, text utilities, and shell utilities.  In the file utilities group, the description of the ls command was simply "lists directory contents,"; and vdir would apparently provide a "long directory listing."  These sounded like what I needed.  Examples in the text utilities category included comm ("compares two sorted files line by line") and uniq ("remove duplicate lines from a sorted file").  Examples in the shell utilities category included sleep ("suspends execution for a specified time") and uname ("print system information").<br/>
<br/>
Although I could have just clicked on <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/files/coreutils/5.3.0/coreutils-5.3.0.exe/download" target="_blank">a download link</a>, I went into the folder for <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/files/coreutils/5.3.0/" target="_blank">the latest version</a> and saw that it had not been updated since 2005.  This made me wonder whether I should have opted instead for Gow (short for GNU on Windows), which had apparently been updated as recently as <a href="https://web.archive.org/web/20150816194138/http://www.softpedia.com/get/System/OS-Enhancements/Gow.shtml" target="_blank">November 2011</a>.  I found a spate of (<a href="https://web.archive.org/web/20150816194138/http://www.ubuntubuzz.com/2011/12/easily-run-various-linux-commands-on.html" target="_blank">1</a> <a href="https://web.archive.org/web/20150816194138/http://www.ubuntubuzz.com/2011/12/easily-run-various-linux-commands-on.html" target="_blank">2</a> <a href="https://web.archive.org/web/20150816194138/http://ashu-geek.blogspot.com/2012/01/how-to-run-various-linux-commands-on.html" target="_blank">3</a> <a href="https://web.archive.org/web/20150816194138/http://betanews.com/2011/11/25/get-a-better-command-line-with-gnu-for-windows/" target="_blank">4</a> <a href="https://web.archive.org/web/20150816194138/http://www.techrepublic.com/blog/doityourself-it-guy/diy-add-gnu-command-line-goodness-to-your-windows-machine/1052" target="_blank">5</a>) brief summaries of Gow published about that time.  Their similarities raised the thought that they may have been written from similar press releases.  Not that that would necessarily be bad.  Any product being promoted in 2011 could count as fresh air against a 2005 alternative.  But it was not reassuring that none of these explained clearly whether Gow was genuinely different, or just a borrowing, from the seemingly better-documented and more widely used GnuWin.  I found <a href="https://web.archive.org/web/20150816194138/https://github.com/bmatzelle/gow/wiki" target="_blank">a page</a> stating that Gow had been developed by a corporation <a href="https://web.archive.org/web/20150816194138/https://github.com/bmatzelle/gow/downloads" target="_blank">in 2010</a> and used for some years before being released as open source.  This appeared to be an authoritative page.  It puzzlingly characterized GnuWin as being appropriate "if you want just one or two utilities."  <a href="https://web.archive.org/web/20150816194138/https://github.com/bmatzelle/gow/wiki/executables_list" target="_blank">A list</a> of Gow utilities seemed similar, at a glance, to the GnuWin list (above), though I noticed that it did not have vdir.  The seeming mischaracterization of GnuWin, combined with the sense of evasion in the press-release writeups, persuaded me to stick with Plan A.<br/>
<br/>
So now I did <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/files/coreutils/5.3.0/coreutils-5.3.0.exe/download" target="_blank">download</a> and install the <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/files/coreutils/5.3.0/" target="_blank">executable</a> (exe; not src.exe) version of CoreUtils (6MB).  But, weird thing, they didn't give me a way to run the program.  My Start Menu had links to several PDFs.  Actually, it was rather messed up:  they gave me four shortcuts to a total of two PDFs, and some of those links were buried about five layers deep in superfluous subdirectories.  They also gave me two links to CoreUtils Help files that, when I clicked on them, gave me the familiar "Why can't I get Help from this program?" message that Windows 7 kindly provided when I would try to run Help files written for Windows XP.<br/>
<br/>
Obviously, I ignored the manuals' actual contents and went looking for a way to run the program.  Weird thing:  I had all these redundant and dysfunctional help materials, and a link to an Uninstall routine, but no actual "Run CoreUtils" shortcut.  I was half-tempted to uninstall them as defective, when it occurred to me that, well, they're supposed to be run from the command line, not the Start Menu.  So, OK, I went to the command line and typed "ls."  Windows said, "'ls' is not recognized as an internal or external command, operable program or batch file."  Hmm.  The manual, then, if I must.  Or manuals, I should say:  a regular-looking manual and also what appeared to be the set of Linux MAN (i.e., manual) pages, both in PDF format.  Neither had installation instructions.  I went to the ls MAN page.  It seemed to say that "ls -a" would be a working command.  Well, not on my machine, it wasn't.<br/>
<br/>
I rooted around and found <a href="https://web.archive.org/web/20150816194138/http://www.askstudent.com/tips/how-to-use-unixlinux-commands-at-the-windows-command-prompt/" target="_blank">an article</a> on how to use CoreUtils.  It said that I would have to adjust the PATH environment variable to tell the system where to look for the CoreUtils command instructions.  My way of applying those instructions was as follows:  first, in Windows Explorer, find where the CoreUtils executables (e.g., ls.exe) were installed.  On a 32-bit Windows 7 system, the location would probably be C:\Program Files\GnuWin32\bin; on a 64-bit system, C:\Program Files (x86)\GnuWin32\bin.  With that folder selected, click on the address bar at the top of Windows Explorer, make sure the whole address was highlighted (Ctrl-A if necessary), and copy the address (Ctrl-C).  Now I went to Start &gt; Run &gt; SystemPropertiesAdvanced.exe (could have used sysdm.cpl and then the Advanced tab) &gt; Environmental Variables &gt; System Variables &gt; highlight Path &gt; Edit &gt; hit the End key.  There, I typed a semicolon (";") and then pasted in what I had copied from the Windows Explorer address bar.  (Could have typed it manually, using the 32-bit or 64-bit address just shown, but this was more accurate and it also forced me to verify the actual location.)  I OKed out of there and tried ls -a again on the command line.  Did I have to reboot to make the Path take hold?  Yes.  That was it.  I had ls, and it listed files.<br/>
<br/>
So now, how about getting all that information mentioned at the outset -- path, date, etc., all on one line?  First question:  how could I get command-line command help?  In Windows, it was DIR /?.  But the /? option gave me an error with ls.  "man ls" didn't work either.  Page 9 of the manual PDF said the MAN pages were no longer being maintained.  I wasn't sure if that applied to what looked like the MAN pages included with GnuWin.  There wasn't a MAN MAN page in that PDF.  Page 10 said --help might work.  I tried "ls --help" and experienced satisfaction.  What I was seeing there looked like what appeared on pages 50-52 of the man PDF, pages 60-70 of 176 (text pages 52-62) in the more explanatory help PDF.  I wasn't inclined to read 11 pages to figure out how to get my directory listing.  Skimming down through the ls --help output, I tried "ls -l -N -R."  Good, but no cigar:  the path wasn't on the same line as the filename; no improvement over DIR.<br/>
<br/>
The user's guide PDF didn't seem to think that there actually was a way to print the file's path on the same line as its date, filename, etc.  And so there I was.  I had come all this way with faith in my heart for the infinite possibilities of Linux.  I fervently believed that, with GNU, anything was possible.  But now, with my limited knowledge of Linux and such, cruel reality was saying Bismillah, no! we will not let you have all that stuff on one line of output.  There actually probably was a way to do it with some other tool, like the awe-inspiring <a href="https://web.archive.org/web/20150816194138/http://en.wikipedia.org/wiki/Grep" target="_blank">grep</a>, available in <a href="https://web.archive.org/web/20150816194138/http://gnuwin32.sourceforge.net/packages/grep.htm" target="_blank">a different GnuWin package</a>.  But I wasn't quite ready to go there.  In this project, grep looked, for me, like a bridge too far.<br/>
<br/>
I thought about posting a question in <a href="https://web.archive.org/web/20150816194138/http://sourceforge.net/projects/gnuwin32/forums/forum/74807" target="_blank">the GnuWin Help forum</a>.  But there had only been a handful of posts there in the last couple of months.  I also thought about going down the list of other utilities contained in CoreUtilities, so as to demonstrate to myself that this hadn't been a wild goose chase.  I thought about trying Gow after all, just in case its version of ls had different capabilities.  I thought about working up a kludge in which I would do a listing of all directories first (with e.g., "dir /ad /s /b") and then try to invent a way to append the pathname to each file line.<br/>
<br/>
But before pursuing those rather lame possibilities, I noticed <a href="https://web.archive.org/web/20150816194138/http://jpsoft.com/tccle-cmd-replacement.html" target="_blank">TCC/LE</a>, advertised as a complete, powerful replacement for Windows CMD.  (TCC was short for "Take Command Console.")  It got 3.5 stars from 43 voters at <a href="https://web.archive.org/web/20150816194138/http://www.softpedia.com/get/Desktop-Enhancements/Shell-Replacements/TCC-LE.shtml" target="_blank">Softpedia</a>, only a solitary vote (five stars) at <a href="https://web.archive.org/web/20150816194138/http://download.cnet.com/TCC-LE/3000-2094_4-206755.html?tag=contentMain;contentBody;1d" target="_blank">CNET</a> -- but it had apparently been updated there just a few days earlier.  At <a href="https://web.archive.org/web/20150816194138/http://majorgeeks.com/TCC_LE_d4655.html" target="_blank">MajorGeeks</a>, it averaged 4.07 from 38 voters.  The description said it had enhanced commands (specifically including DIR) with new options.  <a href="https://web.archive.org/web/20150816194138/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=vQz&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=allintitle%3A+TCC%2FLE+comparison&amp;oq=allintitle%3A+TCC%2FLE+comparison&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=3&amp;gs_upl=14589l20213l0l20404l22l14l3l0l0l0l443l1920l2.4.2.1.1l10l0" target="_blank">A search</a> didn't encourage the sense that there was a regular category of this sort of thing, with lots of competitors.  I downloaded and installed it.  The installation process seemed pretty slick, ending with a direct ride to <a href="https://web.archive.org/web/20150816194138/http://jpsoft.com/forums/" target="_blank">their forums</a>.  The installation left me with an open CMD window with a funky prompt, though apparently it was actually their own version of a command window.  (I did have another Win7 command window open throughout the installation.  It remained functional; I was able to close and open a new one after installation.)  I typed Help at their command prompt and went straight into their GUI help dialog, which actually made me say "Wow."  It wasn't spectacular; it was just good, and helpful, which I guess counts as spectacular after a long slog.  I replaced their ugly prompt with the ordinary Windows one by typing "prompt $P$g" at the prompt, though not without first amusing myself with variants (e.g., "Now what?").<br/>
<br/>
Eventually I discovered that their help dialog was more or less the same as their <a href="https://web.archive.org/web/20150816194138/http://jpsoft.com/help/index.htm?overview.htm" target="_blank">online help page</a>.  The manual had a large number of further instructions on how to tinker with the prompt and, it seemed, everything else.  Typing "option" at the prompt brought up settings, but not an obvious way to preserve prompt settings between sessions; it appeared the answer to that might lie somewhere within their SET command.  Anyway, I found information on their DIR command almost instantly, and also got a cursory version of it by typing dir /? at their prompt.  It led me to PDIR, and there I found the answer I was looking for.  What I had to type in a TCC/LE command window was this:<br/>
<blockquote>pdir D:\ /s /(dy-m-d zc fpn) &gt; dirlist.txt</blockquote>That gave me all of the information I was looking for, on a line-by-line basis, for every file on drive D, output into dirlist.txt.  Specifically, with the options in that sequence, I got the date (y-m-d), size (with commas), and the file path and name.<br/>
<br/>
I took a quick look at their list of <a href="https://web.archive.org/web/20150816194138/http://jpsoft.com/help/index.htm?commands.htm" target="_blank">Commands by Category</a>.  I also saw that they had a number of video and textual <a href="https://web.archive.org/web/20150816194138/http://jpsoft.com/all-tutorials/take-command-tutorials.html" target="_blank">tutorials</a>.  An impressive program.  But in any case, this investigation was done.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
This may be an appropriate place to link toa coupleotherpostswhose first paragraphs describe basic DIR usage.  A concise summary of DIR options is available by typing "DIR /?" on the command line.There were also various directory printers that I could have used, though they might not be as powerful for getting the locations of files of the desired type (e.g., *.JPG) across multiple directories.

**Jose Florez**:
The promtpt is set in a file called tcstart.bat which is read every time TCC starts. Please note that the location of the batch file is set by running "option" and writing a path where the file can be located. This path goes under "TCSTART/TCEXIT Path".

