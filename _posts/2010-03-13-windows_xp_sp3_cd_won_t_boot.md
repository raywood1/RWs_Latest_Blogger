---
layout: post
title: "Windows XP SP3 CD Won't Boot"
date: 2010-03-13
---

<div class="post-body">
<p>I was trying to install Windows XP on a <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=pk9&amp;rlz=1R1GGGL_en___US333&amp;q=compaq+presario+cq60-420us&amp;btnG=Search">Compaq Presario CQ60-420US</a> laptop.  I had just gotten it back from HP service in Texas, where they supposedly replaced the motherboard to fix a nonworking wired network interface card (NIC).  They had reinstalled Vista on it, which I thought was very nice of them, and now the NIC still did not work for purposes of accessing the Internet, but did work for half of a crossover cable connection with another computer.  That is, the other computer could access the laptop, but not vice versa.<br/>
<br/>
So I had decided to try to see if WinXP would fare better than Vista on these problems.  I wiped out the Vista partition, used GParted to create a new partition, and stuck the WinXP installation CD into the CD drive.  Unfortunately, XP would not boot from the CD.  GParted had just booted from the CD, so I was pretty sure it wasn’t the drive hardware per se.  With the WinXP CD inserted, the computer would recognize that there was a CD in its drive, and would say, “Press any key to boot from CD,” but this just caused the thing to grind away, apparently trying to read and act upon the information on the CD, before eventually (after maybe five minutes) giving me a <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=KaU&amp;rlz=1R1GGGL_en___US333&amp;q=bsod+%22blue+screen+of+death%22+%22a+problem+has+been+detected+and+windows%22&amp;btnG=Search">BSOD</a> (blue screen of death).<br/>
<br/>
<div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">I found that this problem occurred with a WinXP CD, containing <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?q=slipstream+sp3+xp&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;client=firefox-a&amp;rlz=1R1GGGL_en___US333">slipstreamed SP3</a>, that I had used to install XP on another computer; but it appeared somewhat different with an SP2 XP CD.   With that CD, the system went all the way through "Setup is loading files" and said, "Setup is starting Windows" before giving me the BSOD.  Then again, this may have been what was happening when the SP3 CD was grinding away; perhaps it was just not reporting all of the drivers it was loading.</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br/>
</div>To fix this, one suggestion said to disable BIOS virus detection.  But the BIOS did not have a virus detection option.  Someone else said laptop CDs are not eager to boot from DVDs, but this was definitely WinXP on a CD.<br/>
<br/>
The BIOS Setup seemed willing to let me try to boot from a USB drive.  I wondered if I could install WinXP from a 4GB USB jump drive that I had lying around.  To try it, I rearranged the Boot Order so that USB Diskette on Key / USB Hard Drive came first.  I wasn’t too sure how to do the rest of this process, so I started by just copying the WinXP CD directly to a 4GB USB drive.  While that was underway, I researched the question and found that there were <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=R1n&amp;rlz=1R1GGGL_en___US333&amp;q=install+xp+from+usb+sp3&amp;btnG=Search">many websites</a> on how to do this, and all of them sounded complicated.<br/>
<br/>
At the same time, I continued trying to figure out what was wrong with the laptop’s DVD drive.  <a href="https://web.archive.org/web/20190906053805/http://en.kioskea.net/forum/affich-71927-my-laptop-won-t-boot">One source</a> said that they solved the problem by flashing the BIOS on the laptop.  This seemed like a more comprehensive kind of solution, so I decided to try this second – right after inserting the USB drive with a copy of the Windows XP CD and verifying that, no, it wouldn’t install WinXP by itself; booting from that USB drive would just give me “Invalid system disk.  Replace the disk, and then press any key.”<br/>
<br/>
It seemed odd that the system would boot a Vista CD but would require a BIOS update in order to boot a WinXP CD.  Or at least it had booted a Vista installation CD previously.  I decided to try that again.  Sure enough, with the Vista installation CD inserted, I got “Press any key to boot from CD or DVD” and then “Windows is loading files.”  I thought about trying to slipstream Vista into a WinXP CD, but got <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=LF&amp;rlz=1R1GGGL_en___US333&amp;q=slipstream+%22xp+sp3%22+%22vista+sp2%22&amp;btnG=Search">some warnings</a> that maybe this would not be a good idea.<br/>
<br/>
So, continuing with the current plan, I went to the HP-Compaq <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareCategory?lc=en&amp;dlc=en&amp;cc=us&amp;product=3979087&amp;">download page</a> and looked for a WinXP <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareList?os=228&amp;lc=en&amp;dlc=en&amp;cc=us&amp;product=3979087">BIOS update</a> for this laptop.  All I saw there was a <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareDownloadIndex?softwareitem=ob-70726-1&amp;lc=en&amp;dlc=en&amp;cc=us&amp;os=228&amp;product=3979087">firmware update</a> named sp43474.exe, for the GSA-T50L optical drive, dated April 2009.  Firefox 3.5.8 wouldn’t download it to my other computer; I had to right-click and use the <a href="https://web.archive.org/web/20190906053805/https://addons.mozilla.org/en-US/firefox/addon/35">IE View extension</a> to download successfully.  The problem now was that this update was an .exe file, which I would only be able to install from within a running Windows installation.  Catch-22!<br/>
<br/>
Just to be sure, I double-clicked on the sp43474.exe file on the other computer.  It said, “This software update will upgrade the firmware of your system’s optical drive GSA-T50L to rev SC05.”  I had done a printout to PDF from a system information utility before sending the laptop to Texas, so now I searched it for a reference to this model of DVD drive.  It said that, actually, what I had (at least before sending the laptop to Texas) was an Optiarc DVD RW AD-7561S ATA Device.  This seemed to be <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=cHV&amp;rlz=1R1GGGL_en___US333&amp;q=ad-7561S+sony+&amp;btnG=Search">made by Sony</a>, whereas the GSA-T50L was <a href="https://web.archive.org/web/20190906053805/http://www.lge.com/us/support/product/support-product-profile.jsp?customerModelCode=GSA-T50L&amp;matchedModelCode=NOT_MATCHED&amp;searchEngineModelCode=GSA-T50L&amp;initialTab=warranty&amp;targetPage=support-product-profile">made by LG</a>.  I supposed that both might ultimately have been made by the same Chinese sweatshop somewhere, but I preferred to try to find a driver for the Optiarc.  But I was curious why my laptop would have <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareDownloadIndex?softwareitem=ob-70726-1&amp;lc=en&amp;dlc=en&amp;cc=us&amp;os=228&amp;product=3979087">an unofficial CD drive</a>.  I was not able to find any references to the Sony Optiarc AD-7561S drive on <a href="https://web.archive.org/web/20190906053805/http://www.sony-optiarc.us/en/html/search.php?m=and&amp;s=score&amp;h=10&amp;fromWG=1&amp;k=ad-7561s&amp;x=0&amp;y=0">the Sony Optiarc page</a>, so apparently it was an older or in some sense unsupported model.  I stumbled across <a href="https://web.archive.org/web/20190906053805/http://forum.rpc1.org/viewtopic.php?f=12&amp;t=46126">a recent thread</a> in which someone else was tired of hassling with HP, couldn’t find a firmware update, and was at the point of just installing the wrong update to see what would happen.  Same problem in <a href="https://web.archive.org/web/20190906053805/http://club.myce.com/f86/optiarc-dvd-rw-ad-7561s-256748/">another thread</a>.  I even found <a href="https://web.archive.org/web/20190906053805/http://forums13.itrc.hp.com/service/forums/bizsupport/questionanswer.do?admit=109447627+1268341557022+28353475&amp;threadId=1357240">a thread</a> on an official HP forum where they were talking about this problem.  As one participant in that last thread said, “There does not seem to be any updates for the 7561s at all.”  So, OK, updating the firmware was not an option; the more likely option was to send the machine back to HP for a replacement, assuming they were willing.  I couldn’t do that now -- I needed the laptop -- so we were back at the option of installing XP from the USB.  I went through <a href="https://web.archive.org/web/20190906053805/http://raywoodcockslatest.blogspot.com/2010/03/using-bootable-usb-drive-to-install.html">a long effort</a> of that nature, but ultimately abandoned it and came back to this post.<br/>
<br/>
While that long effort was underway, I began looking into other possibilities.  One was to adapt an Acronis True Image backup (or you could try <a href="https://web.archive.org/web/20190906053805/http://www.macrium.com/reflectfree.asp">Macrium</a> for freeware) of a Windows XP installation from another machine, so that it would work on this laptop's different hardware.  The Acronis option that I would need, to avoid a BSOD, seemed to be <a href="https://web.archive.org/web/20190906053805/http://www.downloadatoz.com/howto/how-acronis-universal-restore-works.html">Universal Restore</a>, which would apparently cost <a href="https://web.archive.org/web/20190906053805/http://www.acronis.com/backup-recovery/advanced-server/universal-restore.html">at least $365</a> (list).  Alternately, it seemed that OEMs use <a href="https://web.archive.org/web/20190906053805/http://club.myce.com/f3/has-anyone-used-acronis-true-image-migrate-one-computer-new-one-166729/">Sysprep</a> to deploy the same operating system installation on many computers, but it looked like more <a href="https://web.archive.org/web/20190906053805/http://support.microsoft.com/default.aspx?scid=kb;en-us;302577&amp;sd=tech">hassle</a> than it would be worth for just one system.  I also <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?q=install+xp+from+network&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;client=firefox-a&amp;rlz=1R1GGGL_en___US333">looked into</a> the possibility of installing XP <a href="https://web.archive.org/web/20190906053805/http://www.networkcert.net/xp/install.htm#network">via network</a> connection.  This led me to a site that specialized in <a href="https://web.archive.org/web/20190906053805/http://bootdisk.com/">boot disks</a>.  I didn’t see how I could use any of that, unfortunately -- at least not without a substantial additional time commitment, which was impossible. <br/>
<br/>
The effort to install XP from the USB did not pan out, so at this point I returned to this post.  There seemed to be two basic options.  Either find a way to develop or adapt an Acronis image from another machine so that it would work on the laptop, or get to a command prompt (via USB drive, network connection, or otherwise) and run an installation command (seemingly something like X:\i386\winnt /s:X:\i386, where the /S switch defines the location of the startup files) to install WinXP from scratch.<br/>
<br/>
I wondered if (a) Windows updates were being designed and revised to defeat the Acronis approach and (b) it would be possible to bail out of a WinXP basic installation before installing many hardware drivers, and make an Acronis image at that point.  I tried that, but WinXP would crash almost immediately; and as with other efforts, it would not boot into Safe Mode either.  I figured that putting the Acronis image on the laptop would at least have installed the I386 folder there, so now maybe it was just a question of getting to a command prompt.  I didn't need <a href="https://web.archive.org/web/20190906053805/http://www.nu2.nu/pebuilder/">BartPE</a> on a USB stick for that; I could boot BartPE from a CD.  I had a CD version of BartPE from 2007.  I guessed it would probably work, since XP was much older than that.  But it seemed that whatever caused the laptop to crash when I had the WinXP CD inserted was also going to reject WinXP as part of a BartPE CD.<br/>
<br/>
I also had an Ultimate Boot CD for Windows (<a href="https://web.archive.org/web/20190906053805/http://www.ubcd4win.com/">UBCD4Win</a>).  The UBCD ground away for a long time, eventually showed me the WinXP splash screen -- and didn't crash!  Instead, it gave me a choice, "Select shell to start." It still seemed to be in its process, so I waited, and it chose the automatic option for me.  It gave me an option of setting up networking, but I didn't know how to answer the question as to which sort.  I tried to cancel, but it seemed intent upon continuing, so I just used the default options.  I went to Start &gt; Command Prompt and typed DIR C: (using capital letters here just to indicate the actual command; DOS is not case-specific) and, no, the I386 folder was actually not installed there yet.  I put the WinXP CD in the CD drive and typed DIR X: because it looked like X was the letter that UBCD had assigned to the CD drive.  I typed COPY X:\I386 C:\ and it copied files.  Then it froze.  I killed that window and tried running Start &gt; Programs &gt; File Management &gt; Explorers.  None of the explorer programs would run.  Eventually I realized this was because I had removed the UBCD disc.  I put it back in and tried again.  The explorers still didn't work.  I had belatedly realized that COPY was probably not the best command, so I tried XCOPY X:\I386 C:\I386 /E /H /Y.  It copied lots of stuff, and not the way I intended.  Now all the stuff that should have been in the C:\I386 folder was instead in the root (C:\) folder.  Oops.  I wound up deleting it all and starting over.  There were just a few files in C:\ that I couldn't delete (i.e., biosinfo.inf, bootfix.bin, config.sys, and mstask.inf), and of course several folders (i.e., Documents and Settings, I386, Program Files, and Windows).  Problem:  there was no WINNT.EXE file to be found.  On my other computer, it was in C:\I386, but it was not in that folder on either the laptop or the WinXP CD.  I carried it over via jump drive.  It took UBCD a minute to recognize the jump drive, but it did.  I typed WINNT.EXE and hit Enter.  I got this:<br/>
<blockquote>Windows XP Setup</blockquote><blockquote>This program does not run on any 32-bit version of Windows.</blockquote><blockquote>Use WINNT32.EXE instead.</blockquote><blockquote>Setup cannot continue.  Press ENTER to exit.</blockquote>So, OK, I jumped WINNT32*.* over to C:\I386.  (The USB flash drive was recognized as drive G, as I discovered by feeling around.  That is, I tried D: and got a partition; tried E: and got a partition; tried F: and got an error; tried G: anyway and there it was.)  But it froze.  It would copy the WINNT32.* files, but not the WINNT32*.DLL files, not even one at a time.  I tried running C:\I386\WINNT32.EXE anyway.  It gave me an error:<br/>
<blockquote>The file C:\I386\WINNT32U.DLL could not be loaded or is corrupt.  Setup cannot continue.</blockquote>I didn't have that particular one on the jump drive, so I went back to the source machine and tried to jump it over.  But I got the same problem:  the command window froze and had to be killed.  I rebooted the computer with an Ubuntu 9.10 CD and then copied all of the WINNT32*.* files (and a WINNT32 folder) from the source computer to the laptop's C:\I386 via jump drive.  Back in UBCD, I tried running that same WINNT32 command and got that same "could not be loaded or is corrupt" error.  <a href="https://web.archive.org/web/20190906053805/http://www.marteydodoo.com/2006/06/16/installing-windows-vista-beta-2-on-256-mb/">One post</a> suggested this sort of message might be due to insufficient RAM.  <a href="https://web.archive.org/web/20190906053805/http://support.microsoft.com/kb/255106">A Microsoft webpage</a> said that I should double-click on WINNT32.MSI.  I wasn't in a GUI, so I just tried typing WINNT32.MSI at the command line.  This opened a dialog asking me what program I wanted to use to open this kind of file.<br/>
<br/>
Since I had a command prompt using UBCD, I tried <a href="https://web.archive.org/web/20190906053805/http://www.vandomburg.net/installing-windows-xp-from-usb/">a different approach</a>.  The command I used this time was:<br/>
<blockquote>X:\i386\winnt32.exe /syspart:C: /tempdrive:C: /makelocalsource</blockquote>But this gave me an error, stating that this command was not recognized.  I tried it again, inserting a BartPE jump drive and replacing X: with H: since H was where the jump drive was.  This worked, but it just gave me the same error message I had gotten a long time earlier:<br/>
<blockquote>Setup cannot continue because upgrade functionality is disabled and your copy of Windows XP only allows upgrades.</blockquote>I tried replacing H with C, since I had already copied I386 to C.  This just gave me the message about WINNT32U.DLL being unloadable or corrupt.  <a href="https://web.archive.org/web/20190906053805/http://forum.soft32.com/windows/Problem-ugrading-XP-Home-XP-Pro-ftopict386281.html">One post</a> led me to think that this problem might be unique to my WinXP SP3 disc, so I loaded an SP2 disc and tried winnt32.exe with that.  That did not seem to achieve anything:  the disc spun up and then down and I was back at the command prompt.  I tried it again with the SP3 CD.  Same result.  Apparently I had mistyped the command previously.<br/>
<br/>
I thought maybe I could run winnt if I could find a 16-bit DOS equivalent.  My search led to <a href="https://web.archive.org/web/20190906053805/http://www.freedos.org/">FreeDOS</a>, where I downloaded <a href="https://web.archive.org/web/20190906053805/http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.0/fdfullcd.iso">FDFullCD.iso</a>.  I burned it and booted the laptop with it.  I indicated that I wanted to boot FreeDOS, and then chose option 3, FreeDOS Live CD with HIMEM + EMM386.  But I got this error:<br/>
<blockquote><span class="Apple-style-span" style="color: black;"><span class="Apple-style-span" style="text-decoration: none;">Selected page frame e000 not available, searching automatically</span></span></blockquote><blockquote>No suitable page frame found.  EMS functions limited.</blockquote>I gathered that EMM386 was not a good option in this case.  I rebooted and tried again, this time choosing option 4, HIMEM only.  This produced a bunch of error messages, but at least it put me to an A: prompt.  Drive B appeared to be a RAM drive.  The program did not recognize drive C.  I thought this must be because it was an NTFS drive, but no, FreeDOS did not recognize any drive, including the CD drive.  I booted FreeDOS again, and this time chose option 5, FreeDOS Live CD only.  I still got some error messages, including "There is no CDROM, or the wrong CD-ROM!"<br/>
<br/>
I guessed that whatever kept this CD-ROM drive from recognizing WinXP was also impairing its recognition of the FreeDOS CD somewhat.     In that case, I wondered if I could install the contents of the WinXP CD from a bootable FreeDOS USB drive.  To make that, I <a href="https://web.archive.org/web/20190906053805/http://tuxtweaks.com/2009/09/create-a-bootable-freedos-usb-drive-on-linux-with-unetbootin/">followed instructions</a> to install Unetbootin on my Ubuntu machine, and then used Unetbootin to make a FreeDOS bootable USB stick.  When that was done, I checked its properties and saw that Ubuntu indicated the filesystem type was msdos.  I copied the /I386 folder from the slipstreamed WinXP SP3 CD to the USB stick, put the USB into the laptop, and rebooted.  After a Unetbootin screen, I was back at the FreeDOS menu.  I tried option 3; same errors as before.  I tried option 5.  This time, it recognized the USB drive as drive C.  Then I realized that this was no help; it still couldn't see the partition on the hard drive where I wanted to install WinXP.  Well, could I reformat that partition as FAT32?  I formatted another USB drive as FAT32, put it into the laptop, and rebooted from the FreeDOS stick.  It did recognize the FAT32 USB drive.  Now, could I install WinXP on a FAT32 partition?  It <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?q=%22install+windows+xp+on+a+fat32%22+OR+%22install+windows+xp+on+fat32%22+&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;client=firefox-a&amp;rlz=1R1GGGL_en___US333">looked like</a> it was supposed to be possible.  I pulled out the USB drives, rebooted the laptop with GParted, and replaced the NTFS partition where I had planned to install WinXP with a FAT32 partition.  (I figured this would be much faster than trying to convert from NTFS to FAT32.)  Of course, now I was wondering whether the FAT32 alternative would also have made a crucial difference with some of the attempts to install from UBCD.  When GParted was done, I rebooted with the FreeDOS stick.  Sure enough, now I could see the FreeDOS stick as drive C and the WINXP partition as drive D.  I tried using XCOPY, but it didn't work.  I wasn't sure how to copy subfolders etc. in FreeDOS.  Rather than research it, I removed the FreeDOS USB, rebooted with UBCD, plugged in the FreeDOS stick, found that WINXP was now drive C and the FreeDOS stick was drive G, and therefore used XCOPY G:\I386\*.* C:\I386 /E /H /Y to copy the I386 folder from the FreeDOS to WINXP.  This time around, that ran very smoothly.  I rebooted with the FreeDOS USB stick.  I went into the I386 folder on the WINXP partition (which was drive D in this case), and typed WINNT.  Windows XP Setup asked me where the XP files were located.  It defaulted to D:\I386, so I left it at that.  Next, it said this:<br/>
<blockquote>Windows XP Professional Setup</blockquote><blockquote>Setup did not detect SmartDrive on your computer.  SmartDrive will greatly improve the performance of this phase of Windows Setup.</blockquote><blockquote>You should exit now, start SmartDrive, and then restart Setup.  See your DOS documentation for details about SmartDrive.</blockquote>I looked into SmartDrive.  Along the way, I ran across the ingenious suggestion that I could use an <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=sX1&amp;rlz=1R1GGGL_en___US333&amp;q=%22ide+to+usb+adapter%22&amp;btnG=Search">IDE to USB adapter</a> and, with that, could use the internal CD drive on a desktop computer as an external drive for some other computer (if I had needed to do that).  (This would require leaving the CD drive's power connected in the host computer.)  <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?q=smartdrive&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;client=firefox-a&amp;rlz=1R1GGGL_en___US333">SmartDrive</a> itself was an MS-DOS disk cache program, to speed up file transfer times.  It appeared that FreeDOS might have its own cache arrangement, presumably faster if I could get HIMEM and/or EMM386 to load.  The best I could do was to reboot, choose FreeDOS option 3, ignore the FreeDOS boot error messages, and continue past the WinXP setup message about SmartDrive.  WinXP setup next said, "Please wait while Setup copies files to your hard disk."  It copied files for a while, and then froze.  I had heard something about how WINNT would only start the process, so I rebooted with UBCD, went into C:\I386, and typed "winnt32.exe /syspart:C: /tempdrive:C: /makelocalsource" and, this time, it worked!  It gave me "Welcome to Windows Setup" and then asked for my WinXP's product key.  I went through the various options, accepting the defaults (including the offer to upgrade my drive to NTFS), and it began the installation process.  It estimated that it would take 52 minutes, instead of the usual 39.  But then something happened.  I turned away, and when I looked back, we were back at the UBCD prompt.  I ran WINNT32 again, just like before, but this time I said No to the option of upgrading to NTFS.  It didn't matter.  I ran it a third time, and again it crashed, shortly after it finished "Copying Installation Files."  No error message or anything.  I rebooted UBCD and tried installing again from the I386 folder that I had added to the bootable FreeDOS USB drive, using the command "G:\i386\winnt32 /syspart:C: /tempdrive:C: /makelocalsource" (because G was where the system saw the FreeDOS USB drive). <br/>
<br/>
So now I wondered whether I could boot to a very WinXP-compatible 32-bit command line.  I started with Vista.  My Vista installation was not booting at this point, probably because I had told GParted to hide the Vista partition, so I inserted the Vista DVD and rebooted.  I went with its Repair Your Computer option but didn't proceed with the repair, choosing instead <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=pBi&amp;rlz=1R1GGGL_en___US333&amp;q=%22vista+CD%22+OR+%22vista+dvd%22+intitle:%22command+prompt%22&amp;btnG=Search">the steps</a> necessary to get a command prompt.  I inserted the FreeDOS USB and found it at drive H.  But before trying it, I went to C:\I386 and ran that WINNT32 command again.  It proceeded just as it had done in UBCD, except I didn't recall having to agree to the license agreement in the UBCD process.  It crashed -- it put me back to the command line -- just as it had done in UBCD.  I tried again, this time starting from the I386 folder in the FreeDOS USB.  I even swapped out the Vista CD for the WinXP CD, just in case that would make any difference.  It didn't.  Another crash.  I took out all bootable items, rebooted, and got "Disk error.  Press any key to restart."  So, no, it had not by some magic completed the process.<br/>
<br/>
I rebooted UBCD.  On another computer, I copied C:\Windows\system32\chkdsk.exe to a new Utilities folder on the FreeDOS USB.  I plugged in the FreeDOS USB, navigated to C:, and typed D:\Utilities\chkdsk /r.  It ran.  I told it to force a dismount.  It quickly checked files and slowly checked free space.  It found no problems.  I rebooted with GParted and had it check the filesystem on the WINXP partition.  No problem there either.  I wondered if the presence of even a hidden Vista partition was screwing things up for WinXP.  I deleted both partitions and recreated WINXP.  The WinXP CD would still not boot.  The Vista CD would still boot, and it gave me a command line from which I could run winnt32.  Even so, it crashed again.  I wondered whether the problem was with my SP3 CD.  I made another folder on the FreeDOS USB, naming it I386-SP2, and copied the I386 folder to it from the WinXP SP2 CD that I had used in making the SP3 CD (i.e., having the same product key).  I tried running WINNT32 again from the Vista command prompt, using this I386-SP2 folder as the source.  This gave me an error:<br/>
<blockquote>Setup was unable to build the list of files to be copied.</blockquote><blockquote>The system cannot find the path specified.</blockquote>I verified that the WINXP partition was still drive C, and that it contained an I386 folder.  <a href="https://web.archive.org/web/20190906053805/http://support.microsoft.com/kb/301933">The problem</a> seemed to be that the I386 folder has to be named I386 -- nothing more, nothing less.  I renamed I386-SP2 to be I386 and re-ran the WINNT32 command.  It crashed again, in exactly the same way as before.  I checked C: to see what WINNT32 was actually doing there.  The answer: not much.  It was creating files named $WIN_NT$, with the extensions .~BT and .~LS, along with a file named textsetup.sif, and it had copied NTLDR over.  And that was about it.  I deleted those $WIN_NT$ files and tried WINNT32 again, this time using the product code from my other WinXP CD.  It crashed, of course.<br/>
<br/>
<a href="https://web.archive.org/web/20190906053805/http://www.trap17.com/index.php/Error-Installing-Windows-Xp-error-7-Ntkrnlmpexe_t27488.html">Someone said</a> that a problem something like this one sounded like it might be due to a bad CPU or other hardware.  Of course, that was always possible.  I wasn't ready for that yet; after all, everything else seemed to work OK.  But I was running out of other theories.  Then I stumbled into <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=1RP&amp;rlz=1R1GGGL_en___US333&amp;q=%22install+xp%22+compaq+cq60-420us&amp;btnG=Search">a search</a> from which I gathered that "downgrade" was an official searchable term, especially where Vista was concerned.  <a href="https://web.archive.org/web/20190906053805/http://www.pcmag.com/article2/0,2817,2287700,00.asp">PC Magazine</a> had a two method article, but neither method would work for me since I wasn't able to boot from the XP CD.  I found what looked like <a href="https://web.archive.org/web/20190906053805/http://h30434.www3.hp.com/t5/Operating-systems-and-software/General-XP-Downgrade-Guide-for-HP-Laptops/m-p/83267">the consummate downgrading guide</a>, with specific information for my laptop model.  For a CQ60 with an Intel CPU, it seemed to say that I should slipstream the ICH9 SATA driver (ICH9M-E/M SATA AHCI Controller) into the XP installer using nLite.  To get the ICH9, I downloaded and unzipped <a href="https://web.archive.org/web/20190906053805/http://downloadcenter.intel.com/T8Clearance.aspx?sType=&amp;agr=Y&amp;ProductID=2991&amp;DwnldID=17883&amp;url=/17883/eng/f6flpy3289.zip&amp;PrdMap=&amp;strOSs=44&amp;OSFullName=Windows%20XP%20Professional*&amp;lang=eng">f6flpy3289.zip</a>, but I did not understand why the highly regarded CherylG was telling me that I would find my driver inside iaAHCI.inf.  In the process of digging around for the driver she named, I contracted a virus, which prompted me to get up-to-date on Spybot Search and Destroy and on the <a href="https://web.archive.org/web/20190906053805/https://addons.mozilla.org/en-US/firefox/addon/3456">Web of Trust</a> add-on for Firefox.  I eventually found the driver on an <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareDownloadIndex?softwareitem=ob-61954-1&amp;lc=en&amp;dlc=it&amp;cc=it&amp;product=3777259&amp;os=2093&amp;lang=it">HP webpage</a> (though not the downloads webpage <a href="https://web.archive.org/web/20190906053805/http://h10025.www1.hp.com/ewfrf/wc/softwareList?os=228&amp;lc=en&amp;dlc=it&amp;cc=it&amp;lang=it&amp;tool=&amp;query=Presario%20CQ60-420US&amp;product=3979087">for my laptop</a>).  I ran it on another computer (it was an .exe file) and it tried to install itself but then said the computer didn't meet the requirements, which I assume meant something about its particular CPU.  The conclusion there seemed to be that it would help to run it on a computer whose hardware was very different from the target computer, so that it would just extract but would not install.  I didn't know if it would run on the laptop from the Vista prompt, but anyway this was not the concept of slipstreaming, so I went back to the first one that CherylG had pointed toward.  Then I <a href="https://web.archive.org/web/20190906053805/http://www.nliteos.com/download.html">downloaded nLite</a> and looked at the <a href="https://web.archive.org/web/20190906053805/http://maxeasyguide.blogspot.com/2008/04/preparations-for-winxp-installation-cd.html">recommended guide</a> for slipstreaming the driver.  Now that I saw the guide, I understood why CherylG was pointing me toward an .inf file.  She apparently didn't mean that I somehow had to extract the driver from iaAHCI.inf; I just had to include that .inf file in the slipstream.  This seemed to be the only thing I had to slipstream, so I went ahead with it.<br/>
<br/>
The slipstreaming process began by copying the entire SP3 CD to a folder on the hard drive that I called SP3CD.  I started to install nLite, which required the Microsoft .NET Framework 2.0.  Installing that required trying to update .NET Framework 1.1 and then downloading a tool to uninstall it when the updates failed, and then manually doing registry edits etc. to uninstall it when the tool failed.  That ran overnight.  Next morning, when that was done, I followed the <a href="https://web.archive.org/web/20190906053805/http://maxeasyguide.blogspot.com/2008/04/preparations-for-winxp-installation-cd.html">MaxEasyGuide</a> to slipstreaming with nLite.  The first time, for some reason, it did nothing.  Second time, it made a file that I called SP3-SATA.ISO, containing the ICH9M-E/M SATA AHCI Controller driver from within iaAHCI.inf -- and now I understood what CherylG was saying.  Next question:  what was I supposed to do with this thing?  I decided to open it with <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?q=%22ultraiso&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;client=firefox-a&amp;rlz=1R1GGGL_en___US333">UltraISO</a> and copy its I386 folder to another folder.  Then I ran Beyond Compare to see how different it was from the original slipstreamed SP3 I386 folder.  It looked like there were a couple dozen differences in files.  So, OK, the nLite process seemed to have done something.  I wasn't sure I had done all of these steps right, but I decided to give it a shot.  I used Beyond Compare to synchronize the I386 folder on the FreeDOS USB with the I386 folder I had just extracted from SP3-SATA.ISO.  Whoa.  Many, many differences.  I forgot -- I had been using the SP2 I386 folder.  I changed that around and re-ran the comparison.  Still tons of differences!  Oh, I knew why.  It was because of the timechange.  The files were mostly the same, but some had been created an hour before the others of similar name.  I told Beyond Compare to ignore unimportant differences and did a full refresh, but that made no difference.  I bit the bullet and upgraded 6,992 files on the FreeDOS USB.  While that was underway, I re-ran the nLite and Beyond Compare processes, just to be sure.  Everything looked good.  I put the updated FreeDOS USB drive into the laptop and re-ran the WINNT32 command.  Alas, that wasn't the answer.<br/>
<br/>
I found <a href="https://web.archive.org/web/20190906053805/http://h30434.www3.hp.com/t5/Operating-systems-and-software/XP-Downgrade-for-CQ60-420us-How-Find-All-Drivers/m-p/113508">another thread</a> that seemed to say that CherylG's advice on drivers was for an AMD CPU, whereas my CQ60-420US had an Intel CPU.  But some respondents said they were definitely using the Intel drivers and it still wasn't working.  Unfortunately, the drivers they pointed to were no longer availlable at the Intel website.  <a href="https://web.archive.org/web/20190906053805/http://h30434.www3.hp.com/t5/Operating-systems-and-software/SATA-drivers-to-XP-solution-on-0x0000007B-BSOD/m-p/114120">Daniel Potyrala</a> advised that I download and run CPU-Z in order to find out not only my CPU type but also my chipset.  I couldn't very well run CPU-Z without an operating system.  Since it seemed that having Vista on the same hard drive did not explain why I could not even run WINNT32, it seemed to be time to restore the Vista partition using GParted and Acronis.  Adam Pash assured me that it didn't matter which came first, WinXP or Vista, so I left the WinXP partition in place (in hopes that it would someday be operational) and just added the Vista partition behind it.  I downloaded the appropriate version of <a href="https://web.archive.org/web/20190906053805/http://www.cpuid.com/cpuz.php">CPU-Z</a>, jumped it over to the laptop, and installed and ran it.  CPU-Z said that my mainboard chipset was an Intel GL40, which meant that I needed to slipstream . . .  the ICH9M-E/M SATA AHCI Controller driver, just like before.  So Mr. Potyrala was wrong; CherylG had given me the right tip.  But then <a href="https://web.archive.org/web/20190906053805/http://www.msfn.org/board/topic/103136-integrate-ich9-sata-drivers-on-xp-cd/">Fernando1 said</a> there were different drivers for 32-bit and 64-bit CPUs.  My <a href="//web.archive.org/web/20190906053805/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=UFc&amp;rlz=1R1GGGL_en___US333&amp;q=pentium+t4200+penryn+32-bit+OR+64-bit&amp;btnG=Search">T4200 Pentium (Penryn)</a> was a 64-bit.  It was hard to tell the two apart; the driver names were the same.  I repeated the nLite process.  This time, the Textmode driver I selected was the ICH9 SATA AHCI Controller (Desktop ICH9R).  There were, again, some differences, so once again I updated the FreeDOS USB drive and tried it in the laptop, this time typing  "I:\i386\winnt32 /syspart:F: /tempdrive:F: /makelocalsource" because the FreeDOS USB was at I: and the WinXP partition was now at F.  That didn't work, so I tried once more, this time selecting the ICH8R/ICH9R SATA RAID Controller.  That didn't work either.<br/>
<br/>
It was time to quit.  The webpages to remember, for future reference, included <a href="https://web.archive.org/web/20190906053805/http://forums13.itrc.hp.com/service/forums/bizsupport/questionanswer.do?admit=109447627+1268607808640+28353475&amp;threadId=1362676">Quang Do's post</a> in an HP forum, listing drivers and their sources; ditto <a href="https://web.archive.org/web/20190906053805/http://www.techsupportforum.com/hardware-support/driver-support/409158-solved-no-connection-after-downgrade-xp-compaq-presario.html#post2321121">Riskyone101</a>; and perhaps a post, <a href="https://web.archive.org/web/20190906053805/http://www.boot-land.net/forums/index.php?showtopic=10138&amp;hl=livexp+script">by wimb</a>, that I really didn't understand.  The approach to remember was to use Unetbootin in Ubuntu to quickly create a FreeDOS bootable USB drive, if I needed 16-bit support, or just a Vista DVD or UBCD, if I could go straight to 32-bit support; to format the target drive in FAT32 rather than NTFS if necessary; to use nLite to create a slipstreamed ISO, assuming I could find the right drivers, and UltraISO to extract files from that ISO to load via USB drive if necessary.  I didn't know why WinXP could not run on the laptop, and I wasn't sure what else to try at this point.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**Anonymous**:
I was also having the "Setup Was Unable to Build the List of Files to Be Copied" and struggled for 4 days.turns out that the [Directories] section in dosnet.inf contained some wrong directories.

