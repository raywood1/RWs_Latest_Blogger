---
layout: post
title: "Creating a Bootable Windows 7 USB Drive for Installation / System Repair / Recovery - First Cut"
date: 2012-05-08
---

<div class="post-body">
<p>Normally, if I booted a computer from a Windows 7 installation DVD, I could get into <a href="https://web.archive.org/web/20151125205406/http://windows.microsoft.com/en-us/windows7/What-are-the-system-recovery-options-in-Windows-7" target="_blank">System Recovery Options</a> (e.g., Startup Repair, System Restore, Command Prompt) that would let me run various diagnostics.  Unfortunately, my laptop did not have a CD/DVD drive.  So if I wanted to see those Windows 7 startup repair options, it seemed that I would have to find a way to do so by booting the computer from a USB flash drive instead.  This post describes the steps I took to develop a USB drive that would give me those options.  It also incidentally describes how to make a bootable copy of the Windows 7 installation DVD on a USB drive.<br/>
<br/>
One approach was to put the entire Windows 7 installation DVD on a USB drive.  The DVD contained about 3GB of material, so this would require a USB drive of 4GB or larger.  Another approach was to put just a Windows 7 System Repair or Recovery CD on a USB drive.  This would require only about 150MB, so I could use a smaller, older, cheaper, or otherwise unused USB flash drive.  The Recovery CD option might load faster than a full Windows CD, but it would not be useful for installation or for recovering system files.<br/>
<br/>
Either way, the first step was to get the necessary files.  The Windows installation files would traditionally be purchased on a DVD, but it was also possible to <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=qiN&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22download+Windows+7%22+site%3Amicrosoft.com&amp;oq=%22download+Windows+7%22+site%3Amicrosoft.com&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_l=serp.3...7752.11552.0.11602.19.11.0.0.0.0.723.2063.5j2j1j5-1j1.10.0...0.0.KhJm5dk-kH4" target="_blank">download</a> them.  Similarly, the Windows 7 System Repair Disc was ordinarily a CD, but it could be copied or converted to files on a hard drive.<br/>
<br/>
To get a System Repair Disc, I had to search my computer for "<a href="https://web.archive.org/web/20151125205406/http://technet.microsoft.com/en-us/magazine/ff621489.aspx" target="_blank">system repair disc</a>."  That didn't work in my case -- I must have renamed the relevant shortcut -- so I searched for various combinations of "create," "system," "repair," and "recovery."  I could also have used Control Panel &gt; Backup and Restore &gt; Create a system repair disc.  The option of <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=download+%22Windows+7%22+%22recovery+CD%22&amp;oq=download+%22Windows+7%22+%22recovery+CD%22&amp;aq=f&amp;aqi=g2g-v1g-q2&amp;aql=&amp;gs_l=serp.3..0l2j0i15j0i22l2.5218.5976.0.7522.9.8.0.0.0.3.177.842.3j5.8.0...0.0._Ir8kXCiPWs" target="_blank">downloading</a> the file(s) needed for a system repair CD was apparently disappearing.  In any case, eventually I found and used the link to a little Windows 7 program whose title bar read simply, "Create a system repair disc."  This created the recovery CD.<br/>
<br/>
Next, the files that weren't already in ISO format needed to be converted to ISO.  The <a href="https://web.archive.org/web/20151125205406/http://www.microsoftstore.com/store/msstore/cat/categoryID.44066700" target="_blank">downloaded versions</a> of Windows 7 evidently came in ISO format.  By contrast, the installation DVD and the recovery CD were not in ISO format.  To convert them to ISO, I started by using <a href="https://web.archive.org/web/20151125205406/http://www.magiciso.com/" target="_blank">Magic ISO Maker</a>.  It warned me that it would not create an ISO larger than 300MB, but this seemed to be a bluff to motivate an immediate purchase.  <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=%22Format+Factory%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">Format Factory</a> would apparently have been one among many <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=l8N&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22convert+to+ISO%22+freeware&amp;oq=%22convert+to+ISO%22+freeware&amp;aq=f&amp;aqi=g1g-q3&amp;aql=&amp;gs_l=serp.3..0j0i22l3.22417.26050.0.27075.25.20.0.0.0.0.951.2475.12j7j6-1.20.0...0.0.i7zvlEUlTZE" target="_blank">freeware alternatives</a>.  When I remembered that <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=ImgBurn&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">ImgBurn</a> would create ISOs from files or discs, however, I deleted the Magic ISO output and used ImgBurn instead, since it had worked well for me in other sorts of projects in the past.<br/>
<br/>
Once I had an ISO, I had a choice between two different approaches to get it properly unpacked and operational on the USB drive.  A dedicated USB drive would focus solely on one version of Windows 7 (e.g., 32-bit vs. 64-bit, Home vs. Ultimate).  This dedicated approach seemed likely to be relatively simple and reliable, and would probably be all that most users would need.  By contrast, a <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=Lg3&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Windows+7%22+%22from+USB%22+OR+%22from+a+USB%22+multiboot+XP+Linux&amp;oq=%22Windows+7%22+%22from+USB%22+OR+%22from+a+USB%22+multiboot+XP+Linux&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_l=serp.3...123764.127428.0.131108.9.9.0.0.0.0.310.1256.4j3j1j1.9.0...0.0.01k2NymQbvA" target="_blank">multiboot</a> USB drive would allow the user to install and/or run two or more different operating systems (potentially including e.g., Windows XP and Linux).  I decided to go with the dedicated, single-system approach.<br/>
<br/>
I started with the Windows 7 system recovery CD, which ImgBurn had now converted to a file I called Win7SysRepair.iso.  There seemed to be several ways to put this ISO onto a bootable USB drive.  <a href="https://web.archive.org/web/20151125205406/http://www.sevenforums.com/tutorials/92177-boot-windows-7-system-repair-disc-usb-using-grub4dos.html" target="_blank">One approach</a> involved using Grub4DOS.  Another was to use Microsoft's Windows 7 USB/DVD <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;safe=off&amp;client=firefox-a&amp;hs=G2O&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=site%3Amicrosoft.com+%22Windows+7+USB%2FDVD+Download+Tool%22&amp;oq=site%3Amicrosoft.com+%22Windows+7+USB%2FDVD+Download+Tool%22&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_l=serp.3...4030.13122.0.13962.17.16.0.0.0.1.495.2699.4j8j2j1j1.16.0...0.0.ejivDSEtSqU" target="_blank">Download Tool</a>.  I ran that Tool.  It called for a few simple steps.  First, I plugged in the little 512MB USB flash drive on which I was going to install the Windows 7 system recovery CD files.  Then I pointed the Download Tool toward the newly created Win7SysRepair.iso.  I clicked the USB Device button, and the Tool found the USB drive.  I clicked Begin Copying and confirmed that it was OK to erase the USB drive.  The tool said, "Creating bootable USB device."  The first time I tried it, it failed, with this error message:<br/>
<blockquote class="tr_bq">We were unable to copy your files.  Please check your USB device and the selected ISO file and try again.</blockquote>I assumed this was due to interference from <a href="https://web.archive.org/web/20151125205406/http://antirun.net/" target="_blank">AntiRun,</a> which I was using to keep an eye on USB drives.  I shut down AntiRun and tried again.  But no, the Tool failed the second time too.  To troubleshoot this problem, I ran <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=%22creating+bootable+USB+device%22+%22we+were+unable+to+copy+your+files%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">a search</a> and saw that this was a rare error.<br/>
<br/>
<a href="https://web.archive.org/web/20151125205406/http://keyable.blogspot.com/2012/01/windows-7-usbdvd-download-tool-unable.html" target="_blank">The problem</a> seemed to be that the Tool was formatting the USB drive as NTFS.  I thought the solution would be to go to Start &gt; Run &gt; diskmgmt.msc and quick-reformat the USB drive with a FAT32 file system (using a volume label of no more than eight characters).  But I still got the same error.  <a href="https://web.archive.org/web/20151125205406/http://4sysops.com/archives/windows-7-usbdvd-download-tool-wudt-is-unable-to-copy-files/" target="_blank">Another source</a> said the problem was that the Microsoft programs (diskmgmt.msc and also the Tool) failed to use the Clean command.  In other words, my USB stick had residual formatting from some previous use.<br/>
<br/>
The advice was to fix this problem by opening a command window <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=command+OR+cmd+window+administrator&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">with Administrator rights</a> and type "diskpart" at the prompt.  This started the DiskPart program, with its own DISKPART&gt; prompt.  The next step was to type "list disk" to see what drives were connected to the computer.  This showed me that, as expected, the last disk was the smallest:  491MB.  That was surely my USB drive.  (It seemed pretty important not to be reformatting the wrong drive.)  That 491MB drive was Disk 2.  So I typed "select disk 2."  It informed me that Disk 2 was now selected.  I typed "list disk" again to check and, sure enough, there was an asterisk next to Disk 2.  So I was ready to type "clean."  It said, "DiskPart succeeded in cleaning the disk."  With that done, I could type these remaining commands in DiskPart, one at a time:<br/>
<blockquote class="tr_bq">create partition primary<br/>
select partition 1<br/>
active<br/>
format quick fs=fat32<br/>
assign<br/>
exit</blockquote>I exited the command window and tried Microsoft's Windows 7 USB/DVD Download Tool again.  It still failed.  I tried again, this time using a different USB drive.  This time was even worse:  previously, it had failed at the 99% mark, but with this drive the copying process didn't even start.  I tried using an ISO built from a System Recovery CD created on another computer, running a different version of Windows.  But the Windows Download Tool said this:<br/>
<blockquote>Invalid ISO File<br/>
<br/>
The selected file is not a valid ISO file.  Please select a valid ISO file and try again.</blockquote>I got that error twice, with ISOs created by ImgBurn and also by Magic ISO Maker.  It was time to give up on the Microsoft Download Tool, reformat the USB drive, and try another approach.<br/>
<br/>
I went back to look at <a href="https://web.archive.org/web/20151125205406/http://www.sevenforums.com/tutorials/92177-boot-windows-7-system-repair-disc-usb-using-grub4dos.html" target="_blank">the Grub4DOS approach</a> mentioned above.  I wouldn't be using it to install multiple bootable operating systems on my little 512MB USB flash drive, but it looked like a straightforward process anyway; I figured maybe the education would come in handy later.  For this approach, I needed to download and install <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=multibootISO&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">MultibootISO</a>.  I found what appeared to be a popular, current version of this program on <a href="https://web.archive.org/web/20151125205406/http://www.pendrivelinux.com/yumi-multiboot-usb-creator/" target="_blank">a Pendrivelinux webpage</a>.<br/>
<br/>
On closer inspection, what we downloading was now called YUMI (short for Your Universal Multiboot Installer).  YUMI was apparently a successor to both MultibootISO and <a href="https://web.archive.org/web/20151125205406/https://www.google.com/search?q=%22Universal+USB+Installer%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">Universal USB Installer</a>.  YUMI was portable; no installation required.  YUMI didn't have a built-in option for installing Windows 7.  I got the feeling that YUMI was not going to replace MultibootISO for this particular task.  Nonetheless, I tried.  In YUMI, I selected "Try an Unlisted ISO."  YUMI didn't complain that the ISO was invalid.  It seemed to think it had succeeded.  Sadly, the USB drive wasn't bootable, at least not in the laptop where I tried it.  I tried again and, whoa, success!  Apparently I had just not hit Esc quickly enough to bring up my laptop's bootable USB drive menu when the laptop was first starting up, or maybe I had hit Esc too many times and escaped my way right out of that menu.  But now, on this second go, YUMI gave me the Windows 7 recovery CD functionality, running from my USB drive.<br/>
<br/>
Well.  This YUMI thing was pretty cool.  When I started this post, I thought I would just be content with the Windows 7 installation DVD.  For that purpose, my spare 4GB USB flash drive was sufficient.  But now I wanted to try YUMI with a large USB drive that would accommodate the Windows 7 installation DVD as well as other operating systems and other bootable CDs.  But this would have to await purchase of a 16GB or larger USB flash drive.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
A later postupdates this one.

