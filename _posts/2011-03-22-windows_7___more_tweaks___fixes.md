---
layout: post
title: "Windows 7:  More Tweaks & Fixes"
date: 2011-03-22
---

<div class="post-body">
<p>I had installed <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-second-try.html">a customized version</a> of Windows 7, and then <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/02/windows-7-additional-tweaks.html">tweaked it</a> in a variety of ways.  This post describes additional random issues that needed to be fixed.  Some of these issues are described in separate posts:<br/>
<ul><li><a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/03/windows-7-remove-installshield-update.html">Remove the InstallShield Update Manager</a>.</li>
<li>Eliminate the "<a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/03/windows-7-you-need-permission-to.html">You need permission to perform this action</a>" error message.</li>
<li><a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/04/speed-up-browsing-by-disabling-internet.html">Eliminate the option</a> to speed up browsing by disabling add-ons in IE 9.</li>
</ul><strong>Verify That You Have Access to That Directory</strong><br/>
<br/>
I was working along, minding my own business, when Adobe Acrobat 9 Pro decided to update itself.  Then it gave me this error message:<br/>
<br/>
<blockquote>Error 1310.  Error writing to file:<a href="https://web.archive.org/web/20180315053946/http://www.blogger.com/goog_2050705859"></a>C:\Config.Msi\c33075c.rbf.<br/>
Verify that you have access to that directory.</blockquote>I clicked Retry.  The message returned.  <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Error+1310.++Error+writing+to+file%22+Acrobat&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=f&amp;oq=&amp;as_qdr=all&amp;num=50&amp;cad=h">A search</a> led to a seemingly comprehensive <a href="https://web.archive.org/web/20180315053946/http://kb2.adobe.com/cps/408/kb408730.html">Adobe webpage</a> on the problem.  (The webpage said that <a href="https://web.archive.org/web/20180315053946/http://kb2.adobe.com/cps/408/kb408730.html#products">products affected</a> included Creative Suite 4.0, which included Acrobat.)  I had to cancel out of the error message and the Acrobat update to proceed with the steps it advised.  I started by trying <a href="https://web.archive.org/web/20180315053946/http://kb2.adobe.com/cps/408/kb408730.html#main_Vista">the option</a> of changing properties on the folder named in the error message:  Windows Explorer &gt; right-click on C:\Config.msi &gt; Properties &gt; Security tab &gt; Advanced &gt; Owner tab &gt; Edit &gt; select Administrators &gt; click box "Replace owner on subcontainer and objects" &gt; OK &gt; OK.  Now the Properties dialog was closed.  That gave it a chance to adjust itself.  Now I went back into the same right-click on C:\Config.msi &gt; Properties &gt; Security tab &gt; Advanced dialog, but this time I went to Permissions tab &gt; Change Permissions &gt; verify Full Control for SYSTEM and also for Administrators &gt; check the two boxes (i.e., "Include inheritable permissions" and "Replace all child object permissions") &gt; Apply.  I saw that I now had two different entries for SYSTEM and Administrators here, so I departed from the official instructions here to remove the ones that did not have Inherited permissions.  I had to remove them one at a time.  The "Replace all child object permissions" box did not stay checked.  I went back into Acrobat.  It started doing the update installation again.  The error recurred.  Going back to that same webpage, I tried the option of renaming C:\Config.msi to C:\Config.msi.old.  The error recurred.  I rebooted; same thing.  But now Acrobat was seeing that it wanted to install an update, so I let it.  Apparently this was different from whatever it had been trying to install before but had failed; this one succeeded.  It required another reboot.  After the reboot, the problem was gone:  I was able to start Acrobat without having it first try to run that failing update.  I wondered if perhaps renaming C:\Config.msi had triggered the update that apparently solved the problem.  A week or two later, unfortunately, I found that Acrobat was still malfunctioning.  I tried a repair and that didn't solve the problem, so I uninstalled it and tried alternatives.<br/>
<br/>
<strong>Revise Robocopy</strong><br/>
<br/>
In <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/02/windows-7-additional-tweaks.html">a previous tweak</a>, I had set up a Robocopy script to mirror my data drive to another internal drive every hour.  Now I wanted to have incremental backups, so that I would back up changed files every hour or two, with a reset every 24 hours.  Ultimately, my solution to this item was to install <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?as_qdr=all&amp;num=50&amp;q=%22Backup+Maker%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">Backup Maker</a> (see below) and let it do its thing.  I didn't like its nag screen, though, and felt that more work on a Robocopy solution might have been better.<br/>
<br/>
<strong>Running AvaFind in Windows 7</strong><br/>
<br/>
I had bought a license for <a href="https://web.archive.org/web/20180315053946/http://www2.think-less-do-more.com/avafind/">AvaFind</a>, a file finder utility, but I'd had <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/01/instant-file-find-acceptable-while-we.html">problems</a> trying to use it in Windows 7.  AvaFind had not been updated since version 1.5, back around 2003.  I had tried using it in <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/02/windows-7-additional-tweaks.html">compatibility mode</a> for Windows XP SP3, but that hadn't worked very well; it was still crashing.  As a temporary workaround, I installed a shortcut to AvaFind in my Start Menu, and just clicked there to restart it whenever it crashed.<br/>
Meanwhile, on a second machine, I was getting an error message when I tried to install AvaFind.  The error message was:<br/>
<br/>
<blockquote>Ava Find Internal Error<br/>
Ava Find has detected an internal error and must be closed.  Error information was saved to AvaFindErrorData.zip on your desktop.<br/>
Ava Find Version:  1.5.218.040106-1058p</blockquote>The failed installation left an error log file on the desktop.  I unzipped it and found that the log insisted on being printed as a PDF.  The error message inside that PDF was:<br/>
<blockquote>[0x0008062e] Win32Exception 0x80070003: SHGetFolderPath[0x18 COMMON_STARTUP] failed. (0x80070003 The system cannot find the path specified.)</blockquote>I did <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=[0x0008062e]+OR+0x0008062e+Win32Exception+0x80070003&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=f&amp;oq=&amp;as_qdr=all&amp;num=50&amp;cad=h">a search</a> but found nothing.  <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Windows+7%22+OR+Win7+[0x0008062e]+OR+0x0008062e+OR+0x80070003+Win32Exception+OR+SHGetFolderPath&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=m1&amp;aql=f&amp;oq=&amp;as_qdr=all&amp;num=50&amp;cad=h">Another search</a> turned up some results, but then it occurred to me that AvaFind was functioning correctly on another machine, so what would happen if I just copied over its C:\Program Files\AvaFind folder?  I did that and double-clicked on AvaFind.exe.  It ran.  But getting it to function as a registered copy apparently required installation.  I stored a copy of the AvaFind folder in my customized Start Menu, where I kept all my portables, but I also went ahead and installed it.  As time passed, though, AvaFind was still not working well.  Ultimately, <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/05/windows-7-file-finder-review-of.html">I adopted Everything</a> as a good alternative.<br/>
<br/>
<strong>Capture Streaming Video</strong><br/>
<br/>
I was <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/02/windows-7-additional-tweaks.html">once again</a> looking for video capture freeware.  I had previously tried <a href="https://web.archive.org/web/20180315053946/http://camstudio.org/">Camstudio</a>, but had audio problems and poor quality, and <a href="https://web.archive.org/web/20180315053946/http://www.utipu.com/tipcam-download/">TipCam</a>, which seemed temperamental.  I found <a href="https://web.archive.org/web/20180315053946/http://emoney.al.ru/capture-streaming-video-and-audio/all-streaming-video-recording-software.htm">a list of programs</a> and tried several.  Among these, <a href="https://web.archive.org/web/20180315053946/http://tetora.orz.ne.jp/forum/gasdown/download.cgi">GetASFStream</a> would only work with a URL, which wasn't helpful for my purposes because the video I was trying to download would pop up in a separate window without its own URL.  I had previously found <a href="https://web.archive.org/web/20180315053946/http://www.nchsoftware.com/capture/index.html">Debut</a> to be excellent, but it had stopped working after a trial period, requiring me to spend $30 to continue.  Not an unreasonable expectation, but I was not doing much video capturing and had just decided to do without, at that price.  <a href="https://web.archive.org/web/20180315053946/http://atube-catcher.dsnetwb.com/video/content/banco-datos-Welcome-Home-Page.html?q=content/banco-datos-Welcome-Home-Page.html">aTubeCatcher</a> had some pretty good reviews <a href="https://web.archive.org/web/20180315053946/http://download.cnet.com/aTube-Catcher/3000-2071_4-10969422.html?tag=contentMain;contentBody;1d">on CNET</a>, so that was one option.  Other options included <a href="https://web.archive.org/web/20180315053946/http://www.streamtransport.com/">StreamTransport</a> (significantly less praised <a href="https://web.archive.org/web/20180315053946/http://download.cnet.com/StreamTransport/3000-2071_4-75300618.html?tag=mncol;1">on CNET</a>), <a href="https://web.archive.org/web/20180315053946/http://www.hensence.com/en/coojah/">Coojah</a> (not listed on CNET), <a href="https://web.archive.org/web/20180315053946/http://www.orbitdownloader.com/Grab-Pro.htm">Orbit Grab Pro</a> (a Firefox extension) and <a href="https://web.archive.org/web/20180315053946/http://www.orbitdownloader.com/index.htm">Orbit Downloader</a> (heavily downloaded and fairly well liked <a href="https://web.archive.org/web/20180315053946/http://download.cnet.com/Orbit-Downloader/3000-2071_4-10600926.html?tag=mncol;2">on CNET</a>), and the <a href="https://web.archive.org/web/20180315053946/http://rtmpdump.mplayerhq.hu/">RTMPDump</a> command-line option.  I had previously used Orbit; I saw some remarks about bugs on the CNET page; I decided not to start there.  The CNET review said I would need a URL for aTubeCatcher, so I didn't start there either.  There seemed to be <a href="https://web.archive.org/web/20180315053946/http://www.gromkov.com/faq/capture/record_streaming_video.html">another option</a>, involving some technical adjustments.  Before trying it, I wondered whether maybe Debut had changed their licensing policies or had forgotten me -- it had been a year or more since I had last tried them out.  When I closed this post, this was still an area in development on my system.<br/>
<br/>
<strong>Internal Incremental Backup</strong><br/>
<br/>
I had previously used <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/02/windows-7-additional-tweaks.html">a Robocopy script</a> to mirror a hard drive to an internal partition, and had used the built-in Windows 7 Task Scheduler (taskschd.msc) to run it.  There were several things not to like about this arrangement.  First, I had the script running in a batch file, and I couldn't figure out how to teach batch files to run minimized.  So I would be working along, and then suddenly this thing would pop up and start running.  Second, Task Scheduler didn't have an option to run every two or three hours, and that was what I was needed, because otherwise this script was popping up every hour and running for a good chunk of that hour.  I wasn't sure whether it was actually slowing the system down that much; I just didn't want it running that frequently if it was going to be so visible.  Third, my Robocopy settings were doing a mirror, whereas I decided what I really needed was incremental backups, so that I would have multiple copies of files that I was working on, going back in time.  I came to appreciate the value of this once again, as if I had not learned it many times before, when a file I was working on got corrupted and then got backed up, overwriting the last good copy, so I lost several hours' work.<br/>
<br/>
I decided to scrap the Robocopy approach and go with a more traditional backup program.  For right now, I decided to start with the <a href="https://web.archive.org/web/20180315053946/http://windows.microsoft.com/en-US/windows7/products/features/backup-and-restore">built-in Windows 7 backup program</a> (Control Panel &gt; Backup and Restore).  But it didn't have an hourly option.  I found <a href="https://web.archive.org/web/20180315053946/http://maximumpcguides.com/windows-7/set-backup-and-restore-to-backup-your-computer-hourly/">a webpage</a> that said I could set up an hourly backup by going into Task Scheduler &gt; left pane &gt; Task Scheduler Library &gt; Microsoft &gt; Windows &gt; WindowsBackup.  This didn't give me the options they were seeing, so I assumed I first had to have the built-in Backup and Restore program set up.  So I went back into Control Panel and finished setting up a backup.  But now I wasn't sure if the built-in backup program could do incremental backups.  I found one of the invariably useful <a href="https://web.archive.org/web/20180315053946/http://www.techsupportalert.com/best-free-backup-program">Gizmo webpages</a>.  It recommended <a href="https://web.archive.org/web/20180315053946/https://www.ascomp.de/index.php?controller=products&amp;action=show&amp;product=backupmaker&amp;tab=description">Backup Maker</a>.  German homepage, but mostly English <a href="https://web.archive.org/web/20180315053946/https://www.ascomp.de/index.php?controller=products&amp;action=show&amp;product=backupmaker&amp;tab=download">download page</a>.  Backup Maker was not my ideal, but it worked.<br/>
<br/>
<strong>Adobe Acrobat 8:  Comment &amp; Markup Toolbar Reverts to Default</strong><br/>
<br/>
I was using Acrobat 8.2.6 in Windows 7.  I had a problem that I had also encountered when using Acrobat 8 in Windows XP.  The problem was that, when I would start Acrobat, often it would start with what was, I guessed, the default set of tools in the Comment &amp; Markup toolbar.  I would select the tools I wanted, lock the toolbars, shut down Acrobat in an orderly way (i.e., File &gt; Exit), and yet the default set would reappear when I opened certain documents.  It seemed that the desired set of tools had to be set manually for each PDF document -- that those that I had not yet opened in Acrobat 8 would favor the default set of tools until otherwise instructed.<br/>
<br/>
I ran <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=oGp&amp;as_qdr=all&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Acrobat+8%22+tools+toolbar+%22don%27t+want%22+open+OR+start&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=">a search</a> and found <a href="https://web.archive.org/web/20180315053946/http://www.justskins.com/forums/acrobat-toolbar-reverts-to-48753.html">a thread</a> with a few suggestions.  I tried the one about deleting my preference file.  I wasn't sure where to find that.  As I poked through <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=oyW&amp;as_qdr=all&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Acrobat+8%22+%22preference+file%22+-Mac&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=">another search</a> to locate it, I saw that deleting the preference file seemed to be common advice for fixing random problems with Acrobat.  It took <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=Xir&amp;as_qdr=all&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Acrobat+8%22+%22preference+file%22+location+OR+%22where+is%22+-Mac&amp;tbs=&amp;lr=&amp;as_filetype=&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=">yet another search</a> to find <a href="https://web.archive.org/web/20180315053946/http://blog.gilbertconsulting.com/2007/08/deleting-preference-files-revisited.html">a post</a> that seemed to address the topic.  The advice here was that I could automatically delete a preference file in some Adobe products by holding Ctrl-Alt-Shift as the program starts.  Just click the Acrobat icon, he said, and immediately hold those three keys down until the program finished starting.  This did not work for me, regardless of whether I started holding those keys down before or immediately after clicking on the Acrobat icon.<br/>
<br/>
I decided to search for the preferences file and delete it directly.  As advised in <a href="https://web.archive.org/web/20180315053946/http://thedailyreviewer.com/design/view/pdf-presets-location-10230618">one thread</a>, I tried looking for it in C:\Documents and Settings\All Users\Documents\Adobe PDF\Settings.  Unfortunately, I was not able to open that folder.  Attempts to do so gave me an error message:<br/>
<br/>
<blockquote>Location is not available<br/>
C:\Documents and Settings is not accessible.<br/>
Access is denied.</blockquote>In Windows Explorer, I right-clicked on the folder and used the nifty "Take Ownership" context menu option that I had previously installed via <a href="https://web.archive.org/web/20180315053946/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-win7regeditreg.html">registry edit</a>.  Now I was able to go in.  I had to repeat that step for the Documents subfolder.  But Adobe was not in there.  I had a general sense that, in Windows 7, the "Documents and Settings" folder was just a placeholder or shortcut to a different folder, but I didn't yet know clearly where that other folder was, and right-clicking on the Documents folder itself gave no clues.  Searches for pref*.dat gave me only Adobe Updater preference files.  <a href="https://web.archive.org/web/20180315053946/http://65.181.155.238/forum/general-acrobat-topics/changing-program-attach-email-command">It was possible</a> that the problem was due to a flaw in the registry rather than in a preferences file, but I wasn't sure how to find a registry problem either.<br/>
At the time when I closed this post, this problem was still unresolved.<br/>
<br/>
<strong>Do You Want to Allow This Webpage to Access Your Clipboard?</strong><br/>
<br/>
For some reason, I suddenly started getting this question whenever I tried to copy and paste something in Win7.  It may have been the result of an upgrade to Internet Explorer 9.  The solution was to go into Control Panel &gt; Internet Options &gt; Security tab &gt; Trusted Sites (green checkmark) &gt; Sites &gt; Add this website to the zone.  (This seemed to be the more conservative approach; I guessed that the more adventurous approach would have been to do these same steps under the Internet icon rather than under the Trusted Sites icon, so that they would apply to all websites.)  I added the website in question.  To do it, I had to unclick the "Require server verification" option.  Then I went to Trusted Sites &gt; Custom Level.  In the Scripting section, not far from the bottom of the long list of settings, I checked Enable under "Allow Programmatic clipboard access."  <br/>
<br/>
<strong>Schedule Defragmenting</strong><br/>
<br/>
I thought I had already taken care of this, but it appeared I had set up automatic defragging for use with a third-party program that I no longer had installed.  Third-party programs may well have been superior for this purpose, but I was OK with just average defragmenting for the time being.  With guidance from <a href="https://web.archive.org/web/20180315053946/http://support.microsoft.com/kb/555098">a Windows 98 webpage</a> that came up in response to a search, I automated the Win7 defragger by going into Start &gt; Run &gt; taskschd.msc &gt; Action &gt; Create Basic Task.  I went through the wizard to set it up.  When I got to the Action step, I said Start a Program.  The program I wanted was Defrag.exe, and it was to "Start In" the C:\Windows\System32 folder.  In the "Add arguments" space, I typed "/c /u /x" from among <a href="https://web.archive.org/web/20180315053946/http://www.windowsnetworking.com/kbase/WindowsTips/Windows7/AdminTips/Admin/NewCommand-LineParametersforDefrag.exeinWindows7.html">the possible options</a>.  At the end, I checked the option to go into the task's properties.  There, under the General tab, I checked "Run with highest privileges" (not the same as high priority) and "Configure for" Windows 7.  Under the Settings tab, in addition to whatever was already checked, I checked "Run task as soon as possible after a scheduled start is missed."<br/>
<br/>
The problem with those settings, as I soon discovered, was with the /c option, which would defrag all volumes, and perhaps also with the /x option, which was much slower than I had expected.  Even though I had this scheduled to run during the night, I would sometimes find that it was continuing on into the daytime.  I had a choice:  set up different defragmenting tasks to run on different nights, or switch to a different defragging program.  <a href="https://web.archive.org/web/20180315053946/http://www.microsoft.com/windows/compatibility/windows-7/en-us/Details.aspx?type=Software&amp;p=Smart%20Defrag&amp;v=IObit&amp;uid=1&amp;l=en&amp;pf=0&amp;pi=0&amp;s=Smart%20Defrag&amp;os=64-bit">Microsoft</a> said IOBit's Smart Defrag was compatible with Windows 7, as it had been with Windows XP, and it still had <a href="https://web.archive.org/web/20180315053946/http://download.cnet.com/Smart-Defrag/3000-2094_4-10759533.html">great ratings</a> on CNET, so I decided to download and use it after all.  I decided not to go with the option of using Security 360, which IOBit offered as another freebie after Smart Defrag installed.  That decision was based on criticisms I saw in <a href="https://web.archive.org/web/20180315053946/http://www.google.com/search?q=%22Security+360%22+compatible+antivirus&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">several posts</a> I viewed about it.  Anyway, with Smart Defrag installed and configured, I disabled the Defrag.exe scheduled task described in the previous paragraph.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
