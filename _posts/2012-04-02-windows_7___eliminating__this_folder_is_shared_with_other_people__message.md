---
layout: post
title: "Windows 7:  Eliminating "This Folder Is Shared With Other People" Message"
date: 2012-04-02
---

<div class="post-body">
<p>I had installed Windows 7.  Now, when I would try to move or delete some folders, I would get this message:<br/>
<blockquote>This folder is shared with other people.<br/>
<br/>
If you move this folder, it will no longer be shared.</blockquote>That message was correct:  I had, in fact, shared the parent folder (and all of its subfolders, including this one) with my other computer.  And I wanted existing and newly created subfolders to continue to be shared.  I just didn't want to receive this warning.<br/>
<br/>
I tried the approach of going into Control Panel &gt; HomeGroup &gt; Leave the homegroup, because someone advised that this was the solution.  It wasn't.  I tried <a href="https://web.archive.org/web/20151102172838/https://www.google.com/search?q=%22This+folder+is+shared+with+other+people.%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">a search</a>.  This led to <a href="https://web.archive.org/web/20151102172838/http://social.technet.microsoft.com/Forums/fi-FI/w7itprogeneral/thread/6b8d5a57-2929-44d1-93ef-a9d825d9e17a" target="_blank">a thread</a> with some heartwarming rants about what a dumbass feature this was.  That thread also contained the suggestion that, at least for purposes of deleting (as distinct from moving) folders, a workaround was to cut and paste files and folders into Recycle Bin, rather than trying to delete them directly.  There was also a command line alternative that supposedly worked for wiping out lots of subfolders:<br/>
<blockquote class="tr_bq">for /D %d in (*) do rmdir /S /Q "%d"</blockquote>My guess was that the command line would also work for moving, in a pinch:  type MOVE /? for guidance.  But I didn't want a command-line solution.  The thread also offered a couple of other complicated workarounds with potential side effects.  Before going that route, I tried the suggestion to take ownership of the folder in question.  I had <a href="https://web.archive.org/web/20151102172838/http://raywoodcockslatest.blogspot.com/2011/12/windows-7-tweaked-installation-latest.html" target="_blank">already added</a> a Take Ownership context menu (i.e., right-click) option in Windows Explorer, so I used that now.  I used it at the level of the entire partition.  That didn't solve the problem.  I tried it again on the top-level folder.  That didn't do it either.  I verified that I had already given Full Control to Everyone in the Sharing context menu option, so that wasn't the solution either.<br/>
<br/>
<a href="https://web.archive.org/web/20151102172838/http://forums.techarena.in/networking-security/1357175.htm" target="_blank">Another thread</a> contained messages repeating the view that, as a deliberate feature of Windows, this couldn't be changed.  I took a look in <a href="https://web.archive.org/web/20151102172838/https://www.google.com/search?q=TweakNow+PowerPack+2012&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">TweakNow PowerPack 2012</a>, in case they had a fix.  I hadn't really used TweakNow previously, but now I saw it wasn't really a tweaker in the sense that <a href="https://web.archive.org/web/20151102172838/http://www.thewindowsclub.com/ultimate-windows-tweaker-v2-a-tweak-ui-for-windows-7-vista" target="_blank">Ultimate Windows Tweaker</a> (UWT) was.  So I ran UWT instead.  But no, UWT didn't seem to have a solution either.  So far, the only solution I had seen was that some people had repartitioned their drive and reinstalled Windows from scratch.  But that was a pretty draconian solution, and it didn't seem to guarantee against a recurrence of the problem.<br/>
<br/>
Back in Windows Explorer, I right-clicked on the drive being shared and selected Properties &gt; Security tab &gt; Edit &gt; Add &gt; Everyone &gt; Check Names &gt; OK &gt; Allow Full Control &gt; OK.  That took a while, as it went through the drive, with a message that said, "Setting security information" various files and folders.  This was obviously not a very secure solution.  Nor was it logically related to sharing.  It was just a guess.<br/>
<br/>
In <a href="https://web.archive.org/web/20151102172838/http://www.pcreview.co.uk/forums/folder-shared-other-people-t2987385.html" target="_blank">another thread</a>, someone said that they noticed this behavior began when they installed RC-1 (i.e., Windows 7, First Release Candidate).  As noted above, people had been saying it was a built-in Windows feature.  But there was at least the possibility that some program had triggered it.  In that spirit, someone else in that same thread offered the belief that it might be related to Windows Mail.  That was a possibility.  I had installed Windows Live Mail.  I didn't like it much -- it was very slow to start.  But I had already uninstalled it.  There didn't seem to be much more I could do on that front.  I tried running <a href="https://web.archive.org/web/20151102172838/https://www.google.com/search?q=%22Glary+Registry+Cleaner%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">Glary Registry Cleaner</a>, just in case that would make a difference.  It identified a lot of problems, but did not fix this particular one.  In <a href="https://web.archive.org/web/20151102172838/http://www.pcreview.co.uk/forums/folder-shared-other-people-t2988053.html" target="_blank">another thread</a>, someone suggested that the culprit might be the network sharing service in Media Player 11.<br/>
<br/>
I saw recurrent references to the C:\Users\[username]\Appdata\Local\Temp\WPDNSE folder.  For username Ray, mine had nothing in it.  Evidently they came to that folder because its name was appearing in an error message.  I wasn't getting that.  The general idea seemed to be that one user might somehow be linked to another user at that folder.  That was interesting.  I looked into the possibility that this "shared folder" problem might be due to the existence of an unnecessary user account.  As described in <a href="https://web.archive.org/web/20151102172838/http://raywoodcockslatest.blogspot.com/2012/04/windows-7-deleting-excess-user-accounts.html" target="_blank">another post</a>, I pruned out some extraneous user accounts.  But that did not resolve this problem.<br/>
<br/>
Over time, the problem appeared less frequently.  It seemed that there might have been an ownership or sharing event, occurring at one time, that became less relevant as my folders went through various processes of being renamed, moved, reshared, and so forth.  <a href="https://web.archive.org/web/20151102172838/http://www.abxzone.com/forums/showpost.php?p=1448880&amp;postcount=12" target="_blank">One post</a> gave me the idea that the problem might be in Windows Explorer &gt; select a folder &gt; right-click &gt; Properties &gt; Sharing tab &gt; Advanced Sharing &gt; Permissions.  At this moment, the only group or user listed there was Everyone.  <a href="https://web.archive.org/web/20151102172838/http://social.technet.microsoft.com/Forums/fi-FI/w7itprogeneral/thread/6b8d5a57-2929-44d1-93ef-a9d825d9e17a" target="_blank">It seemed</a> that, previously, there might have been additional entries there, for Ray, Administrators, and/or System.  The post made me think that, even though all roads seemed like they should lead to Mecca, the mere presence of multiple people here would confuse Windows.  Maybe the original warning that "This folder is shared with other people" was Windows' way of telling me that it was going to remove the others and leave only Everyone on the list.  I didn't test this; this was just an idea from that post.  At the time when I decided to close this post, it's not so much that the problem had disappeared as that it had become more rare.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
I spoke too soon.  The problem came back later.  And then it went away again.  This is among the reasons cited ina later poston the option of switching to a Windows Explorer replacement for at least some purposes.

**Anonymous**:
http://support.microsoft.com/kb/2493924/en-us"HKEY_CLASSES_ROOT\Directory\shellex\CopyHookHandlers\SharingDeleting this registry key causes the share enumeration in Explorer to be ignored while creating or renaming a folder."Don't forget to restart your computer.

**Anonymous**:
Teracopy seems to get past the issue.  Integrates with explorer.

**Lewis**:
Thanks for this - because the standard del command with /y doesn't do the trick.

