---
layout: post
title: "Recognizing Partitions Automatically in Ubuntu 9.04"
date: 2009-07-19
---

<div class="post-body">
<p><span class="Apple-style-span" style=" ;font-family:georgia;"><div>In Ubuntu 9.04 (Jaunty Jackalope), disk partitions normally remain unmounted until you mount them manually.  One way to do this is to start Ubuntu's File Browser (also known as Nautilus).  You can do this by choosing the Places &gt; Computer menu option.  In File Browser, just double-click on the drive you want to mount, and its name will appear under the File System &gt; Media folder there in File Browser.  You can also mount drives by typing commands into Ubuntu's command-line window (Applications &gt; Accessories &gt; Terminal).  First, type "sudo mkdir /media/[drivename]" to create a mount point. After doing this for all unrecognized drives, type "sudo mount -a".</div><div>
</div><div>But instead of doing this sort of thing, I wanted the system to recognize my drives on bootup, so that I would not have to mount them manually each time I rebooted.  In my first approach to this problem, I typed "sudo ntfs-config."  This approach worked OK on one computer, where I was doing a clean installation -- where, that is, I had formatted the partition before installing 9.04 on it.  But on another computer, I installed 9.04 on top of 8.04 without formatting the partition.  This was advantageous in that it preserved lots of files and settings from before.  The drawback was that I was running into funky problems with ntfs-config. </div><div>
</div><div>On this system, I got an error message when I ran ntfs-config.  The message was, literally, "Error : An error occured when trying to configure [partition name], please retry. Thanks."  (For those who are searching with the correct spelling, let me retype that error message:  "Error: An error occurred when trying to configure . . . ."  When I tried to examine the partition in GParted <span class="Apple-style-span" style=" ;font-family:Georgia;">(i.e., System &gt; Administration &gt; Partition Editor (see above))<span class="Apple-style-span" style=" ;font-family:georgia;">, I got this:  "Warning: Unable to read the contents of this file system!"  The partition had been available a minute earlier, when I had booted into Windows XP, and I had shut down WinXP normally before rebooting into Ubuntu. So I didn't think the partition was truly hosed.</span></span></div><div>
</div><div><span class="Apple-style-span" style=" ;font-family:Georgia;"><span class="Apple-style-span" style=" ;font-family:georgia;">I found <a href="https://web.archive.org/web/20190906053752/http://ubuntuforums.org/showthread.php?t=217009">a very, very long thread</a> on the subject, but <a href="https://web.archive.org/web/20190906053752/http://ubuntuforums.org/showpost.php?p=6389187&amp;postcount=2015">post no. 2015</a> in that thread said the thread's advice was outdated for purposes of newer versions of Ubuntu.  In <a href="https://web.archive.org/web/20190906053752/https://bugs.launchpad.net/ubuntu/+source/ntfs-config/+bug/111103?comments=all">another thread</a>, <a href="https://web.archive.org/web/20190906053752/https://bugs.launchpad.net/ubuntu/+source/ntfs-config/+bug/111103/comments/4">someone said</a> they got this error message after installing a newer version without formatting the partition, and solved it by deleting the mount points.  I had a fresh backup of the partition in question, so I tried taking that approach. First, I opened File Browser and went to File System &gt; Media &gt; CURRENT.  File Browser said that partition was empty.  When I right-clicked on it, however, File Browser didn't give me an option of deleting it.  Its Properties said it was owned by root, so I logged in as root (see above), typed "cd /media", typed "dir" to make sure CURRENT was there, typed "dir CURRENT" to make sure it was empty, and then typed "rm -r CURRENT" to delete it.  I restarted the system, started File Browser, went to Computer (in the Tools bar), double-clicked on CURRENT, and it was there, with all its contents.  CURRENT was formatted in ext3 (i.e., Linux).  I had another partition that was having the same problem.  It was formatted in NTFS (i.e., Windows).  But now that I had rebooted, it too was available and looking fine.</span></span></div><div>
</div><div>I dropped this issue for the time being.  Next day, when I rebooted, I found that, predictably, the various partitions were not mounted.  In Terminal, I typed "sudo gedit /etc/fstab."  My fstab file did not show the partitions I wanted to be mounted automatically.  I reviewed <a href="https://web.archive.org/web/20190906053752/http://raywoodcockslatest.blogspot.com/2008/08/vmware-in-ubuntu-ongoing-developments.html">one of my old posts</a> on ntfs-3g.  It seemed to say that ntfs-config was the solution.  I tried running ntfs-config again.  This time, it ran.  It recognized two NTFS partitions.  Now I just had two ext3 partitions to set up for automatic mounting.  I went back into fstab and saw the lines that ntfs-config had added.  I hadn't thought to save the fstab file from my previous installation; it would have been handy to copy over the relevant lines.  From the previous post, I gathered that the trick was to write something like this in fstab:</div><div>
</div><div><span class="Apple-style-span" style="font-family:'courier new';">/dev/sda3 /media/VMS ext3 defaults 0 0</span></div><div>
</div><div>for the VMS partition, and likewise for the other ext3 partition.  I double-checked that I had the right device addresses by checking them in System &gt; Administration &gt; Partition Editor (i.e., GParted).  I rebooted, but the ext3 partitions were still not automounted, though the NTFS partitions continued to be automounted nicely.  I didn't know why the line just shown, for the VMS ext3 partition, did not work in fstab now; according to the old post, it had worked in Ubuntu 8.04.  <a href="https://web.archive.org/web/20190906053752/https://help.ubuntu.com/community/AutomaticallyMountPartitions#Using pysdm">Ubuntu documentation</a> said something about pysdm, so I looked into that.  They suggested typing this into Terminal:</div><div>
</div><div><span class="Apple-style-span" style="font-family:'courier new';">sudo apt-get install pysdm</span></div><div>
</div><div>but I saw it was available in Synaptic (i.e., Ubuntu's System &gt; Administration &gt; Synaptic Package Manager menu pick), so I used that instead to install pysdm.  I typed "pysdm" at the Terminal prompt, but got an error message indicating that I had to have root privileges, so I tried again with "sudo pysdm."  (Also available via System &gt; Administration &gt; Storage Device Manager.) That gave me a Storage Device Manager (SDM) window that listed some, but not all, of my partitions.  I noticed that, if I started pysdm while I still had the foregoing /dev/sda3 line for my VMS partition in my fstab file, SDM would not give me an option of configuring the VMS partition; but if I deleted that line from fstab and then started pysdm and clicked on sda3, SDM would give me a "Configure now?" dialog with the message, "/dev/sda3 hasn't been configured.  Do you want to configure it now?"  I said OK.  I told it to set the mount point to File System &gt; Media &gt; VMS.  Then I clicked on the Assistant button and saw that the option was checked that said "The file system is mounted at boot time."  I also checked the option that said, "Check file system at mount time" on the options dialog's Mounting tab.  I didn't change any other options.  When I checked OK to leave Assistant, I saw an error message in Terminal:  "wrong fs type, bad option, bad superblock on /dev/sda3, missing codepage or helper program, or other error."  I went back into Assistant and removed the "Check file system" option I had just checked.  This time, when I left Assistant, I got Warning messages that said, "Unknown option: rw" and "nouser is not suitable for user" and "Unknown option: async."  I clicked on the "Set defaults" button in SDM and then clicked Apply.  This produced no additional Warning messages in Terminal.  Trying once more, I just went into Assistant and immediately executed, and this did produce the same Warning messages, plus an additional one that said, "Unknown option: defaults."  I tried just emptying out the Options box altogether in SDM.  Then I clicked Apply.  I did the same with the other ext3 partition that was not yet mounting automatically.  I restarted the system.</div><div>
</div><div>It occurred to me that I may not have restarted the system previously, but may merely have logged out and logged back in.  Ubuntu 9.04 seemed to require two steps to reboot, and it seemed that I had forgotten to take that second step last time around.  This occurred to me right around the time when I tried to restart the system and found that it froze with a black screen.  Evidently my fstab file was not presently in an acceptable form.  I punched the computer's reset button and rebooted with the Ubuntu installation CD, chose the "Try Ubuntu" option, and edited fstab as above.  (Note that there's an fstab on the CD too; make sure you're editing the one on the hard drive.)  I saw that I had failed to add the preferred mountpoint for one of my ext3 partitions:  it said "/media/sdc5" instead of "/media/CURRENT."  I fixed that and rebooted without the CD.  This time, the system booted OK.  But those two ext3 partitions were still not automounted.</div><div>
</div><div>In File System &gt; media (i.e., /media), I noticed that there was a mount point for the VMS partition, but it had nothing in it.  I typed "dir" to make sure there was nothing there, and then typed "sudo rm -r VMS" to delete it.  I also deleted the "sc5" mountpoint mentioned above.  In File Browser, I clicked on the Computer button at the top and then double-clicked on each of these two partitions (i.e., VMS and CURRENT) to create mountpoints (i.e., /media folders) for them.  I tried rebooting again.  They still weren't automounting, and the mount points I had created for them were gone, as I should have expected.  Incidentally, at this point <a href="https://web.archive.org/web/20190906053752/http://www.scribd.com/doc/15124069/Understandingfstab">I discovered</a> that the custom was apparently to mount fixed hard drives at /mnt, and use /media for removable hard drives.</div><div>
</div><div>About this time, I discovered that I had commented out the lines added by SDM (i.e., I put # signs (also called hash marks) in front of each of those lines).  I forgot.  I had done that to troubleshoot fstab, and then didn't go that route after all, and forgot to remove them.  So I removed the hash marks now and rebooted.  But that wasn't the solution.  I re-ran SDM, went through more or less the steps described above, and rebooted.  This time, it worked:  the partitions were automounted, and their contents were visible.  Not sure exactly what was different this time, but something was.  So I guess the conclusion is, if it doesn't work in SDM the first time, tinker around for a while, reboot a couple of times, try SDM again, and reboot.</div></span></p>
<div style="clear: both;"></div>
</div>

---
### Comments
