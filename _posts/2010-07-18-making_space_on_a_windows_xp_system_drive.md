---
layout: post
title: "Making Space on a Windows XP System Drive"
date: 2010-07-18
---

<div class="post-body">
<p>I wanted to make space on my computer's C drive.  For some purposes, it could be more sensible to just install a bigger hard drive or make a larger partition for drive C.  But for other purposes (in my case, where drive C was in a virtual machine (VM) in VMware Workstation and you really didn't want to deal with the slowness and overhead of a huge virtual drive), there might be no alternative but to make space.  Drive C had a habit of just continuing to grow and grow, if you let it; I had one that got up to around 35GB.<br/>
<br/>
I started with a general-purpose <a href="https://web.archive.org/web/20190906053718/http://www.webdevelopersnotes.com/how-do-i/free-up-disk-space.php">Web Developers Notes</a> cleanup page.  I was already doing one thing they suggested, which was to use <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=portable+windows+software&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">portable versions</a> of various utilities.  IrfanView, for example, was available in both an installed version and a portable version.  Typically, there was no difference in functionality; the main thing was just that you had to create a link to the portable version if you wanted to have it listed in your Start &gt; Programs list.  Portable versions could be run from anywhere, which means they wouldn't have to be on drive C.  So could installed versions, in theory; but in practice, programs didn't always run correctly and updates were not always applied, when the program was not located where the programmers expected it to be.  Back in the late 1990s, I did spend an enormous amount of time trying to figure out which installed programs could safely be installed somewhere other than the default location, but ultimately I concluded it wasn't worth the hassle.  In short, if it was a portable version, I put it in a folder labeled "Installed Here" on drive D; otherwise, I installed it on C.  Those who hadn't done this during installation could, as advised, uninstall from C and reinstall on D.<br/>
<br/>
I was also doing another thing they suggested, which was to keep data files (including e-mail) on a separate partition.  Program files went onto drive C if they had to be on drive C, or if they would be a lot less hassle if they were on drive C (e.g., see previous paragraph).  Stuff generated by me and by the rest of the world went on drive D whenever possible.  It helped, for this purpose, to <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=%22move+the+my+documents+folder%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">relocate those folders</a> (unwanted by me, at least) that Windows automatically created, including "My Documents" and "My Pictures" and "Microsoft, I Need Your Help in Telling Me Where to Put Everything."  Also, in Microsoft Office programs (among many others), I could change settings to store files by default in a folder that was not on drive C.  Then you could back up drive C once every couple of months - whenever you had accumulated enough new program installations and adjustments -- using Acronis or some other drive mirroring program, while continuing to back up your drive D (data) partition on a daily if not hourly basis. <br/>
<br/>
Another suggestion was to delete programs that were not being used via Control Panel &gt; Add or Remove Programs.  It was unwise to remove programs that you need, or to remove programs whose function was unclear.  No point making extra work for yourself or screwing up your system.  (Incidentally, <a href="https://web.archive.org/web/20190906053718/http://en.kioskea.net/faq/403-command-prompts-for-windows">the command</a> to <a href="https://web.archive.org/web/20190906053718/http://www.geekgirls.com/articles/2010/03/xp-control-panel-shortcuts/">open Add or Remove Programs</a> was this:<br/>
<blockquote>rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,,</blockquote>That was a pretty funky command, and for future reference I saved <a href="https://web.archive.org/web/20190906053718/http://en.kioskea.net/faq/403-command-prompts-for-windows">a webpage</a> containing others like it.  I will be combining these commands in a single batch file (below) for one-click all-purpose cleanup.)<br/>
<br/>
Another space-saving step they recommended, which I rejected for my purposes, was to empty out the browser cache (in e.g., Internet Explorer, Firefox).  Why bother?  It would fill up again -- I would <i>want </i>it to fill up again, so as to load pages faster and save the cookies that would store my login information for many webpages -- and I would still need the disk space to accommodate it.  This step would make sense for a one-time task, like making an image of drive C.  For more enduring space saving, the more sensible step was to go into those browsers and make the cache smaller.<br/>
<br/>
A step they should have recommended, but didn't, was to <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=GPE&amp;rls=org.mozilla:en-US:official&amp;q=%22move+the+page+file%22+xp&amp;aq=f&amp;aqi&amp;aql&amp;oq&amp;gs_rfai&amp;gs_upl=799,163,2,0,136,146,0,2">move the page file</a>.  It could be huge.  After moving it and rebooting, I made sure there was not still a copy on drive C.  There was also apparently <a href="https://web.archive.org/web/20190906053718/http://www.petri.co.il/pagefile_optimization.htm">a Microsoft utility</a> to protect against performance degradation due to pagefile fragmentation.<br/>
<br/>
Moving the paging file was more complicated in my case, because I was using VMware.  (In other words, those who are not using VMware should skip this paragraph.)  In the case of my virtual machine, it seemed to be preset to about 2GB.  Then I came across <a href="https://web.archive.org/web/20190906053718/http://communities.vmware.com/thread/220242">a mention</a> of the option of setting up a separate virtual drive, within my virtual machine, for the paging file.  The advice, there, was to go into VMware Workstation for this virtual machine and choose VM &gt; Settings &gt; Hardware tab &gt; Add &gt; Hard Disk &gt; Next &gt; Create a new virtual disk &gt; IDE, Independent, Persistent &gt; Next.  I set the disk capacity at a 4GB single file, which seemed like plenty when combined with the 2GB of RAM I was allocating to the VM.  Then, continuing with the advice, I powered up the VM and, with a series of right clicks, I initialized, partitioned, and formatted that drive, set its drive letter to I (so that it would not interfere with D or other drives I was already using), and set its pagefile.  I varied somewhat from the advice on one point; I set the size of the drive I pagefile to a minimum and maximum of 3.5GB, <a href="https://web.archive.org/web/20190906053718/http://www.petri.co.il/pagefile_optimization.htm">having heard</a> that making the system enlarge the file could take a hit on performance.  (I originally tried 4GB, but Windows gave me warnings that the pagefile drive was running out of free space.)  Finally, they advised me to reboot again and set drive I to nonpersistent. This, it seemed, would take care of the problem of <a href="https://web.archive.org/web/20190906053718/http://www.petri.co.il/pagefile_optimization.htm">pagefile fragmentation</a>.<br/>
<br/>
They also recommended defragmenting the hard drive.  I used <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=%22smart+defrag%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">Smart Defrag</a> for this purpose.  It was supposedly running all the time, but I included it in my batch file anyway because it always seemed to have things that needed to be done whenever I did open it.<br/>
<br/>
They suggested using WinXP's Disk Cleanup (command line:  cleanmgr).  Good idea, but typically this made less space than one might have imagined.  Again, there was a tradeoff:  you could make more space by deleting things that might cost you extra time (e.g., Office setup files) whenever you did next need them. <br/>
<br/>
Another possibility was to run a program to see which files and folders were most space-consuming. <a href="https://web.archive.org/web/20190906053718/http://www.raymond.cc/blog/archives/2007/04/30/find-out-what-files-and-folders-are-taking-up-hard-drive-spaces/">Raymond</a> recommended <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=treesize&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">TreeSize Free</a> and <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=JDiskReport&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">JDiskReport</a>, both of which were portable freeware. <br/>
<br/>
Someone at <a href="https://web.archive.org/web/20190906053718/http://helpwithwindows.com/techfiles/clean_hd.html">HelpWithWindows.com</a> recommended deleting unneeded old files.  Some of this was already being taken care of, for me, via <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=dHI&amp;rls=org.mozilla:en-US:official&amp;q=%22advanced+windowscare%22+-%22advanced+systemcare%22&amp;aq=f&amp;aqi&amp;aql&amp;oq&amp;gs_rfai&amp;gs_upl=5501,390,13,8,237,1487,0,12,7:1">Advanced WindowsCare 2</a>, which I had included in my Startup folder.  Still, I used <a href="https://web.archive.org/web/20190906053718/http://www.pcreview.co.uk/forums/showpost.php?s=0c608fc469d72702f58e9d7d48fba9f0&amp;p=4434573&amp;postcount=9">a complex command</a> to open a search dialog, where I could search for files matching these patterns.<br/>
<blockquote>*.bak<br/>
*.chk<br/>
*.gid<br/>
*.old<br/>
*.tmp<br/>
*.~mp<br/>
*.$$$<br/>
*.000<br/>
~*.*<br/>
*~.*</blockquote>Not every file coming up in those searches would deserve deletion, but many would.<br/>
<br/>
These steps, combined, freed up about 2GB (10%) of my drive C.  The <a href="//web.archive.org/web/20190906053718/https://www.google.com/search?q=%22batch+file%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">batch file</a> I wrote to automate some of these steps looked like this:<br/>
<blockquote>start rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,,<br/>
start "" "C:\Program Files\IObit\IObit SmartDefrag\IObit SmartDefrag.exe"<br/>
start cleanmgr<br/>
start "" "D:\Miscellany\Installation\Installed Here\TreeSizeFree.exe"<br/>
start "" "D:\Miscellany\Installation\Installed Here\JDiskReport.exe"<br/>
type nul &gt; %temp%\1.fnd &amp; start %temp%\1.fnd &amp; del /q /f "%temp%\1.fn</blockquote>It ran slowly, but it did tend to automate the steps needed in the process.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
