---
layout: post
title: "VMware Workstation, Ubuntu Host, Windows XP Guest:  Automated Way to Map Network Drives"
date: 2010-07-31
---

<div class="post-body">
<p>I was using Windows XP virtual machines (VMs) in VMware Workstation 7 on Ubuntu Linux.  I wanted to automate the process of mapping network drives.  I typically used the <a href="https://web.archive.org/web/20120906044942/http://www.google.com/search?q=xp+%22map+network+drive%22+vmware&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">Map Network Drive</a> technique in Windows Explorer for this purpose.  It appeared possible to automate this with <a href="https://web.archive.org/web/20120906044942/http://practicalsbs.wordpress.com/2008/03/13/directly-creating-a-mapped-network-drive-within-an-xp-workstation-registry/">a registry edit</a>, but apparently a  more typical and robust approach was to use <a href="https://web.archive.org/web/20120906044942/http://www.google.com/search?q=%22net+use%22+map+network+drive+xp+-vista+-%22windows+7%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">the "net use" command</a>.<br/>
<br/>
The net use command could be entered <a href="https://web.archive.org/web/20120906044942/http://engr.oregonstate.edu/computing/personal/110">from the command line</a>.  I was more interested in saving it <a href="https://web.archive.org/web/20120906044942/http://techrepublic.com.com/5208-11190-0.html?forumID=40&amp;threadID=201239&amp;messageID=2097319&amp;tag=content;leftCol">in a batch file</a> that I could apply to multiple network drives and could re-run anytime without having to remember or research the proper syntax.  <a href="https://web.archive.org/web/20120906044942/http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/net_use.mspx?mfr=true">Microsoft seemed to say</a> that, for my purposes, the command to map a network drive would look something like this:<br/>
<blockquote>net use d: "\\vmware-host\Shared Folders\DATA" /persistent:yes</blockquote><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">where DATA was the name that I had given to the drive in Ubuntu.  This resulted in an entry in Windows Explorer that read, "Data on 'vmware-host\Shared Folders' (D:)."  I was not able, at this point, to automate the process of right-clicking and renaming that to be simply "DATA."</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br/>
</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">I combined several of those commands in a batch file.  A batch file was just a file created in Notepad, with one command on each line.  I also included a comment, in case I wanted to write an "undo" batch file.  The line just shown, made permanent and accompanied by that comment, looked like this:</div><blockquote>net use d: "\\vmware-host\Shared Folders\DATA" /persistent:yes</blockquote><blockquote>; to disconnect, use this (I think):  net use d: "\\vmware-host\Shared Folders\DATA" /delete</blockquote><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">I saved that batch file in the folder containing my various WinXP installation materials.  So then, for future installations, all I had to do was to double-click on that batch file in Windows Explorer, or start it from the command line or from another batch file, and my drive mapping would proceed automatically.</div></p>
<div style="clear: both;"></div>
</div>

---
### Comments
