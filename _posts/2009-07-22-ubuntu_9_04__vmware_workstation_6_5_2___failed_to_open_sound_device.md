---
layout: post
title: "Ubuntu 9.04, VMware Workstation 6.5.2:  Failed to Open Sound Device"
date: 2009-07-22
---

<div class="post-body">
<p><div><div><div>I wanted to have multiple virtual machines (VMs) open at once in VMware Workstation 6.5.2, running on 64-bit Ubuntu 9.04 (Jaunty Jackalope).  If I tried to do this in a single session of Workstation, it would crash or malfunction whenever I tried to close or suspend or de-maximize one of the VMs.  <a href="https://web.archive.org/web/20190906053754/http://raywoodcockslatest.blogspot.com/2009/05/installing-vmware-workstation-652-on.html">The workaround</a> I arrived at was to open multiple sessions of Workstation, each dedicated to just one VM.</div><div><div>
</div><div>After starting to use this approach, I got an error message telling me that I had too many VMs. I didn't write down the exact wording of that message, but shortly thereafter I got another one, one that I had <a 09="" 2008="" com="" href="https://web.archive.org/web/20190906053754/http://raywoodcockslatest.wn%20the%20exact%20wording%2C%20but%20that%20was%20the%20gist%20of%20it.%20%20shortly%20thereafter%2C%20i%20encountered%20a%20problem%20i%20had%20%3Ca%20href%3D/">encountered previously</a>:  trying to play sound in a VM gave me a "Failed to open sound device /dev/dsp" error message.</div></div><div>
</div><div>At about the same time, it seems, there was a new version of VMware Tools. I installed that on each of my VMs. I don't know if that new version materialized before or after this audio problem, or whether it was involved in the creation or solution of this audio problem.</div><div>
</div><div>I first tried <a href="https://web.archive.org/web/20190906053754/http://communities.vmware.com/thread/179268">an approach</a> that I had tried before:  replace "/dev/dsp" or "Auto detect" with "/dev/audio" in each VM.  To change that, I had to power down (not just suspend) each VM, close Workstation, and then start Workstation again as root (i.e., type "sudo vmware" at the Terminal prompt).  Then, in Workstation, go to VM &gt; Settings &gt; Sound Card &gt; Use physical sound card.  There, type in "/dev/audio" and save.  Then save.  Repeat for each VM.  Then exit and restart Workstation as an ordinary user.</div><div>
</div><div>At first, that seemed to solve it for me, but then the problem returned, so I tried <a href="https://web.archive.org/web/20190906053754/http://communities.vmware.com/thread/179268">the suggestion</a> to (1) install "paprefs" in Synaptic, (2) go to Ubuntu's System &gt; Preferences &gt; PulseAudio Preferences, (3) check the top-level boxes on all three tabs, and (4) reboot.  Then, in each VM, I went to VM &gt; Removable Devices &gt; Sound Card &gt; Connect.  This time for sure:  I was able to hear audio in each VM.  But then, after a day or two of using the system, I was getting a "Failed to open sound device /dev/audio" error message.</div><div>
</div><div>The rest of the message, at least in this case, was, "Device or resource busy.  Failed to connect virtual device sound."  "Busy" seemed to imply that another VM, or Ubuntu itself, was hogging the sound resource.  The sound card device was disconnected in all three of the VMs I had open at that time, but I was getting sound in Ubuntu (System &gt; Preferences &gt; Sound &gt; Test).  It seemed the problem might apply to VMware generally.  To make sure VMware was able to access my soundcard, <a href="https://web.archive.org/web/20190906053754/http://ubuntuforums.org/showthread.php?t=1206775">nxmehta</a> suggested these steps:</div><div>
</div><div>sudo apt-get install alsa-oss </div><div>echo '#!/bin/bash' &gt; ~/vmware </div><div>echo 'LD_PRELOAD=libaoss.so exec /usr/bin/vmware.orig "$@"' &gt;&gt; ~/vmware </div><div>sudo mv /usr/bin/vmware /usr/bin/vmware.orig </div><div>sudo mv ~/vmware /usr/bin/vmware </div><div>sudo chmod 755 /usr/bin/vmware </div><div>sudo chmod +s /usr/lib/libaoss.so.*</div><div>
</div><div>I tried them and they didn't work.  Rereading his post, I guessed (he didn't actually say) that I should have shut down VMware before trying.  When I rebooted and connected the sound card again (VM &gt; Settings), it worked.  But the next day, after a bit of usage and another reboot, it was giving me stuttering sound.  This was happening even when I was using only one VM.  <a href="https://web.archive.org/web/20190906053754/http://communities.vmware.com/thread/163605">Another thread</a> had a couple of suggestions, including installing a second sound card dedicated to VMware.  The suggestion I tried, from that thread, called for typing "sudo gedit /etc/pulse/daemon.conf" and then changing some settings, as follows:</div><div>
</div><div>high-priority = yes</div><div>nice-level = -11</div><div>realtime-scheduling = yes</div><div>realtime-priority = 5</div><div>default-fragments = 4</div><div>default-fragment-size-msec = 4</div><div>resample-method = speex-float-3</div><div>
</div><div>Some of these changes were already made in my daemon.conf file, but realtime-scheduling was originally no, resample-method was src-linear, default-fragments was 8, and default-fragment-size-msec was 10.  I unintentionally made these changes while VMware Workstation was still running.  All of my VMs were either suspended or powered down.  I then exited and restarted Workstation and fired up one of the powered-down VMs in which I had just encountered stuttering audio.  The audio was still stuttering.  <a href="https://web.archive.org/web/20190906053754/http://communities.vmware.com/message/1236250;jsessionid=9BD3367305AB485EC3EF7D0D2025B721#1236250">Someone suggested</a> that the problem may have arisen because s/he did an upgrade rather than a clean installation of Ubuntu 9.04, but in my experience I did have days of successful use of audio on the upgraded system before this started happening.  Moreover, I was not having the stuttering audio problem when I played audio in Ubuntu, only when I played it in a Windows XP VM.</div><div>
</div><div>In case it was a Windows problem, I installed the <a href="//web.archive.org/web/20190906053754/https://www.google.com/search?hl=en&amp;q=%22K-Lite+Mega+Codec+Pack%22&amp;sourceid=navclient-ff&amp;rlz=1B3GGGL_enUS318US318&amp;ie=UTF-8">K-Lite Mega Codec Pack</a> in my WinXP VM and rebooted but, alas, this did not prove to be the silver bullet, and the problem occurred regardless of whether I played audio in IrfanView, Windows Media Player, or Media Player Classic. I powered up another VM that had been suspended during the foregoing operations and verified that it, too, was still having the stuttering problem.</div><div>
</div><div>Several days passed.  It seemed that I would have to go back through the various suggestions, correct my mistakes, re-try what I had seemingly done right, and keep digging for more solutions.  This, I knew, could be a huge time sink.  I decided instead to see if I could find an alternative.  Since I wanted to reduce my dependence on Windows anyway, I looked into the possibility of using IrfanView, at least, on Ubuntu itself, via Wine.  That investigation is the subject of another post which, like this one, appears in my blog <a href="https://web.archive.org/web/20190906053754/http://raywoodcockslatest.blogspot.com/2009_07_01_archive.html">this month</a>.</div></div></div></p>
<div style="clear: both;"></div>
</div>

---
### Comments
**Anonymous**:
Using xubuntu 9.04 here and I have the same issue as you.. after a few google search I found this link:http://communities.vmware.com/thread/27890outdated but it may hold some relevance as to how to get it fixed.. I personally disliked using pulseaudio after installing it which caused all my media playback to either be muted or causes the media player to crash.I suppose there is a need to have some sort of a sound server in which I have tried looking for one but I couldn't find it.There is the option of using pulseaudio server but I searched on the vmware community board which yielded nothing.

**raywood**:
In a later post (at http://raywoodcockslatest.blogspot.com/2009/08/ubuntu-904-vmware-workstation-652.html), I describe more efforts to make this work.  At the end of that post, there is a link to my next step, which was to try VirtualBox instead of VMware.

