---
layout: post
title: "Windows 7:  HTML (MHT) Files:  Batch Printing/Converting to PDF"
date: 2012-01-26
---

<div class="post-body">
<p><div style="text-align: left;">I had a bunch of MHT files in a folder.  (MHT was <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?q=mht+mhtml&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">apparently</a> short for mhtml, which was short for MIME html.)  I produced these files in Internet Explorer (IE).  To do this in a recent version of IE, the approach would be to look at a webpage and hit Ctrl-S &gt; Save as type &gt; Web archive, single file (*.mht).  The MHT format would try to build everything on the screen into a single file, unlike the HTML formats (which would either save only the HTML text or create a subfolder to contain the images and other stuff appearing on the webpage).</div><br/>
<strong>Attempts to Print MHTs Directly</strong><br/>
<br/>
My goal now was to print those MHT files.  I had <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=d4a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=bullzip+pdf+printer&amp;oq=bullzip+pdf+printer&amp;aq=f&amp;aqi=g10&amp;aql=&amp;gs_sm=e&amp;gs_upl=4397l6891l0l7009l12l8l0l2l2l2l265l1109l1.2.3l6l0" target="_blank">Bullzip PDF Printer</a> set as my default printer, and its settings (the default, I think) would have it pop up a dialog for each file being printed, asking me what I wanted to call the PDF output.  This wasn't as slick as having a command-line PDF printer that would automatically print a file with a name specified on the command line, but I believed I had two options there.  One would be to change Bullzip so that it just printed without a dialog; the other was to hit Enter for each file and let Bullzip print the PDF with the default filename.  Either way, I could then come back in a second pass, using <a href="https://web.archive.org/web/20151118082655/http://raywoodcockslatest.blogspot.com/2012/01/windows-7-batch-file-to-sort-files.html" target="_blank">a batch file</a> and/or <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=a7a&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22Bulk+Rename+Utility%22+freeware&amp;oq=%22Bulk+Rename+Utility%22+freeware&amp;aq=f&amp;aqi=g-v3&amp;aql=&amp;gs_sm=e&amp;gs_upl=6205l7441l0l7643l9l6l0l0l0l0l189l652l2.3l5l0" target="_blank">Bulk Rename Utility</a> to alter filenames as desired.<br/>
<br/>
I actually would have had a one-pass command-line option, if I had been able to get <a href="https://web.archive.org/web/20151118082655/http://www.printhtml.com/" target="_blank">PrintHTML</a> to work with MHTs.  I was briefly hoping that maybe I could use PRN from the command line, but <a href="https://web.archive.org/web/20151118082655/https://forums.oracle.com/forums/thread.jspa?threadID=2275882" target="_blank">Francois Degrelle</a> said PRN would only work with text files.  <a href="https://web.archive.org/web/20151118082655/http://powershell.com/cs/blogs/karl-prosser/archive/2009/02/10/print_2D00_file_2D00_function.aspx" target="_blank">A PowerShell function</a> would have been another possibility, if I had known how to proceed with something like that.  There also appeared to be some <a href="https://web.archive.org/web/20151118082655/http://www.robvanderwoude.com/printfiles.php" target="_blank">older approaches</a> that could provide a good way to spend a huge amount of time on something that wouldn't work, for reasons I couldn't understand.<br/>
<br/>
I ran <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=SNE&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=batch+print+html&amp;oq=batch+print+html&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=e&amp;gs_upl=17538l22730l0l22827l9l7l0l5l5l1l4000l4194l0.1.9-1l2l0" target="_blank">a search</a> and found <a href="https://web.archive.org/web/20151118082655/http://whatrevitwants.blogspot.com/2010/03/how-to-print-large-set-of-drawings-to.html" target="_blank">a webpage</a> that made me think that <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=PaG&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=PDFCreator+OR+%22PDF+Creator%22+freeware&amp;oq=PDFCreator+OR+%22PDF+Creator%22+freeware&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=e&amp;gs_upl=14436l16347l0l16371l9l9l0l7l0l1l181l220l1.1l2l0" target="_blank">PDFCreator</a> might be a <a href="https://web.archive.org/web/20151118082655/http://www.pdfforge.org/pdfcreator" target="_blank">more useful</a> PDF printer than Bullzip, for present purposes and also for the future.  PDFCreator was favorably reviewed on <a href="https://web.archive.org/web/20151118082655/http://download.cnet.com/PDFCreator/3000-2064_4-10558866.html" target="_blank">CNET</a> and <a href="https://web.archive.org/web/20151118082655/http://www.softpedia.com/get/Office-tools/PDF/PDFCreator-look4soft.shtml" target="_blank">Softpedia</a>, so I downloaded and installed it.  But it didn't seem to be printing PDFs automatically from these MHTs.  It would just open the MHT in Microsoft Word, my default word processor, and then it would sit there.  So I didn't continue to try using PDFCreator for this project.<br/>
<br/>
Then again, Bullzip did the same thing:  it opened the MHT in Word, and then stopped.  This happened even after I went into Bullzip's options and changed them to what seemed to be the most streamlined approach possible.  Word was resource-intensive; I couldn't very well open a hundred documents in it at once.  Not that that was an option anyway.  If I highlighted more than 15 MHTs in Windows Explorer, the right-click context menu wouldn't even give me a Print option.<br/>
<br/>
Wordpad was less resource-intensive than Word, but it would open the MHT files as source code, same as Notepad:  not pretty.  I would also get the MHT opened in Word when I right-clicked on a couple of MHTs and selected "Convert to Adobe PDF."  (I got that option because I had Acrobat installed.)<br/>
<br/>
The easiest way to just open the MHTs and print them manually, if I wanted to do that, seemed to be to select a bunch of them and hit Enter, and they would open in tabs in my web browser.  For some reason, they were opening in Opera, whereas I would have thought that Firefox would be the default, as it was for other kinds of web-type files.  I couldn't even open them in Firefox by doing File &gt; Open inside Firefox:  somehow they would still open in Opera.  I could have uninstalled Opera and then tried again, if I really cared; but in any event I still wasn't getting an automated solution.<br/>
<br/>
<strong>PDF via Internet Explorer &gt; Print All Linked Documents</strong><br/>
<br/>
<a href="https://web.archive.org/web/20151118082655/http://whatrevitwants.blogspot.com/2011/02/batch-print-html-files-in-folder.html" target="_blank">Diamond Architects</a> suggested creating an HTML file that would have links to all of the HTML files in a folder, and then using Internet Explorer to print that one HTML file, using Alt-F &gt; Print &gt; Options tab &gt; Print all linked documents.  The .mht files were obviously not .html files, but they contained HTML code.  So it seemed like the same approach would work either way; or, at worst, I thought I could probably just type REN *.MHT *.HTML in a command window opened in that folder, and mass-rename them that way.  I tried that.  It made a mess.  The files didn't look right anymore.  So I renamed them back to MHT.  (The easy way to open a command window in any folder was to go into <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=etZ&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=intitle%3A%22Ultimate+Windows+Tweaker%22+%22Windows+7%22&amp;oq=intitle%3A%22Ultimate+Windows+Tweaker%22+%22Windows+7%22&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=e&amp;gs_upl=6029l6834l0l7212l8l6l0l0l0l0l209l770l1.3.1l5l0" target="_blank">Ultimate Windows Tweaker</a> &gt; Additional Tweaks &gt; Show "Open Command Window Here."  With that installed, a right-click in Windows Explorer would open up that option.)<br/>
<br/>
But anyway, to test the "print all linked documents" concept, I needed to create the HTML file containing links to all those individual files.  For that, I tried Arclab's <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=SxZ&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=intitle%3A%22Arclab+Dir2HTML%22&amp;oq=intitle%3A%22Arclab+Dir2HTML%22&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=e&amp;gs_upl=4174l4857l0l5614l8l5l0l0l0l0l486l1526l0.1.2.0.2l5l0" target="_blank">Dir2HTML</a>. But it didn't create links.  It just gave me a list of files.  If that was going to be the output, I preferred the kind of list I would get from this command:<br/>
<blockquote>DIR *.mht /a-d /b &gt; dirlist.txt</blockquote>That gave me a file, dirlist.txt, containing entries that looked like this:<br/>
<blockquote>File Name 1.mht<br/>
File Name 2.mht</blockquote>To get them to function like links in an HTML file, I would have to change those lines so they looked like this:<br/>
<blockquote>&lt;a href="One File Name.mht"&lt;/a&gt;<br/>
&lt;a href="Another File Name.mht"&lt;/a&gt;</blockquote>I could achieve that with a search-and-replace in Word, using ^p as the end-of-line character.  That is, I could search for ^p and replace it with this, including the quotation marks:<br/>
<blockquote>"&gt;&lt;/a&gt;^p&lt;a href="</blockquote>That would put "&lt;/a&gt; at the end of each line, and &lt;a href=" at the start of the next.  Then I could paste the results back into dirlist.txt.  Note:  if smart quotes were turned on in Word, I would then have to do two additional search-and-replace operations, copying and pasting a sample of an opening and a closing smart quotation mark into Notepad's replace box, because smart quotes wouldn't work right.  Then I might have to manually clean up the first and last lines in dirlist.txt.  Another way to do this would be to paste the contents of dirlist.txt into Excel and massage them there.  (For Excel instructions, go to <a href="https://web.archive.org/web/20151118082655/http://raywoodcockslatest.blogspot.com/2012/01/batch-merging-many-scattered-jpgs-into.html" target="_blank">this post</a> and search for CHAR(34).)  If I was going to do much of this, Excel would definitely be the way to go, because then I could just drop the new filenames into a column and let preexisting formulas parse them and output the HTML lines automatically.<br/>
<br/>
That basically gave me an HTML file.  Now I would just have to add its opening and closing lines.  I wasn't sure what those should look like, so I right-clicked on some random webpage, selected "View Source" (an option that may not be available in all browsers, at least not without some add-ons; I wasn't sure), and decided that what I needed for an opening line would be "&lt;!DOCTYPE html&gt;" and the closing line should be "&lt;/html&gt;" (without quotation marks), though I later realized that the latter was probably either unnecessary or incomplete.  I also needed a second line that read, "This is my file," because otherwise everything that I had done would create a completely blank-looking page, leaving me uncertain and confused.  So I added those lines to dirlist.txt, saved it as dirlist.htm, opened it in Internet Explorer (Ctrl-O or Alt-File &gt; Open), and tried the Alt-F &gt; Print &gt; Options tab &gt; "Print all linked documents" option mentioned above.  (Note that dirlist.htm still had to be in the same folder as the .mht files that I wanted to print.)<br/>
<br/>
That worked, sort of.  It automatically gave me a boatload of .pdf files, and may I say it did so in a hell of a hurry.  Problem was, they were all blank.  It tentatively appeared that Bullzip and Internet Explorer were going to go through the motions of printing those linked files; but because I was dealing with MHTs instead of HTMs, they would passive-aggressively give me output with nothing inside.  So, like Columbus finding Haiti instead of Malaysia, I had figured out how to bulk-print HTML files, but that wasn't what I had told everyone I was trying to do.<br/>
<br/>
<strong>Bulk Converting MHTs to HTML with mht2htm</strong><br/>
<br/>
Well.  Could I bulk-convert MHTs to HTMs and call it a day?  <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?q=%22MHT+to+HTM%22+OR+%22MHT+to+HTML%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">A search</a> led to <a href="https://web.archive.org/web/20151118082655/http://sourceforge.net/projects/mht2htm/files/mht2htm/1.7.3.15%20%2816.apr.2011%29/" target="_blank">mht2htm</a>.  I downloaded the Win32 versions (both GUI and command line), along with the Readme and the Help file.  Basically, it looked like I just needed to (1) copy mht2htmcl.exe into the folder containing my MHT files, (2) create a subfolder, there, called OutputDir, (3) edit dirlist.htm to comment out the non-file (i.e., starting and ending) lines, and then (4) do another couple of searches and replaces in dirlist.htm, so that my lines looked like this:<br/>
<blockquote>mht2htmcl "First File Name.mht" OutputDir<br/>
mht2htmcl "Another File Name.mht" OutputDir</blockquote>According to the very brief documentation accompanying mht2htm, these commands would do the trick.  I made these changes, and then renamed dirlist.htm to be dirlist.bat, made sure it was in the folder containing the MHTs and mht2htmcl.exe, and ran it.  It didn't work.  I wasn't sure why not.  So I tried the GUI version instead.  Much easier, and it did produce something in the Output directory.  What it produced was a bunch of folders, one for each MHT file, with names like "First File Name_Files."  Each folder held a couple dozen files, mostly GIFs for the graphic elements of the HTM file.  The key file in each folder wa scalled _0_start_me.htm.  If I double-clicked on that, it would open in Firefox (my default web browser), with a line near the top that said, "Click here to open page"; and if I clicked on that, I got a nice-looking webpage in Firefox.<br/>
<br/>
So that was not fantastic.  Now, instead of opening MHT files one at a time in Word or a web browser, and printing from there, I would have to convert them to HTM so that I could dig into their separate folders and do the same thing with a _0_start_me.htm file.  It would probably be easier to print HTMs than it had been to print MHTs, but there was the problem that those _0_start_me.htm files did not have the original filename.  Fortunately, the file name had been preserved in the name of the folder created by mht2htm.  So I would have to use an Excel spreadsheet to produce printing or renaming commands that would rename the PDF version of the first _0_start_me.htm file to be "First File Name.pdf," and likewise for all the others.  But I wasn't ready to do that yet.<br/>
<br/>
<strong>Reviewing How to Use wkHTMLtoPDF</strong><br/>
<br/>
So far, as discussed in <a href="https://web.archive.org/web/20151118082655/http://raywoodcockslatest.blogspot.com/2011/04/windows-7-archiving-thunderbird-emails.html" target="_blank">a previous post</a>, the best tool I had found for batch converting HTMs to PDFs was <a href="https://web.archive.org/web/20151118082655/http://code.google.com/p/wkhtmltopdf/" target="_blank">wkHTMLtoPDF</a>.  Somewhat past the halfway point in that long post, in a section titled "Revised Final Step:  Converting TXT to HTML to PDF," I had worked out an approach for using wkHTMLtoPDF.  The first step, as I reconstructed my efforts from that previous post, was to install wkHTMLtoPDF.  That created a folder:  C:\Program Files\wktohtml.  wkHTMLtoPDF was a command-line program.  Windows would have to know where to look to find it.  To address that need, I copied everything from the C:\Program Files\wktohtml folder to a new, empty folder called D:\Workspace.  Now I could type a command referring to wkHTMLtoPDF, in a batch file or command window running in D:\Workspace, and the computer would be able to execute the command. I also created a subfolder, under D:\Workspace, called OutputDir.<br/>
<br/>
Next, I went into a command window, running in D:\Workspace, and typed "wkhtmltopdf /?" to get a list of command options.  My previous post, interpreted in light of that command and a glance at <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?q=wktohtmlpdf+manual&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">wkHTMLtoPDF's manual</a>, seemed to say that the command options that had worked best for me included "-s" to set the output paper size; options to set top (-T), bottom (-B), left (-L), and right (-R) margins (in millimeters); and --dpi (to specify dots per inch).  It seemed, then, that the command line that I would need to use, for each of the _0_start_me.htm files, would use this basic syntax:  <br/>
<blockquote>start /wait wkhtmltopdf [options] [input folder and HTM file name] [output folder and PDF file name]</blockquote>I would run that command in the Workspace folder, where I had now placed the wkHTMLtoPDF program files.  With a command of that type, wkHTMLtoPDF would find the _0_start_me.htm file created by mht2htm (above), and would convert it to a PDF file saved in D:\Workspace\OutputDir.  The source folder and file names were pretty long in some cases, but this D:\Workspace\OutputDir part of the command was brief, so hopefully my full wkHTMLtoPDF command would not exceed any command line limits.  So now I was ready to try an actual command.  I made a copy of one of the folders created by mht2htm, renamed it to be simply "Test," and ran this command in D:\Workspace:<br/>
<blockquote>start /wait wkhtmltopdf -s Letter -T 25 -B 25 -L 25 -R 25 --minimum-font-size 10 "D:\Test\_0_start_me.htm" "D:\Workspace\OutputDir\Testfile.pdf"</blockquote>That worked.  But, of course, the resulting Testfile.pdf was just a PDF of the HTML page that said, "Click here to open page."  I wouldn't get my actual MHT page in HTML format until I clicked on that link, in each of those _0_start_me.htm files, and the resulting HTML page would be open in Firefox, where I would still have to come up with a batch printing option to handle all of the tabs that I would be opening.  It still wasn't an automated solution.  I assumed that the approach of using Internet Explorer &gt; Print All Linked Documents as above (but this time with HTMs instead of MHTs) would likewise give me webpages with that "Click here to open page" option.  <br/>
<br/>
<strong>Trying VeryPDF HTML Converter</strong><br/>
<br/>
My immediate problem seemed to be that I didn't have a good way to automate the conversion of MHTs to HTMs -- a way that wouldn't give me that funky "Click here to open page" stuff from mht2htm.  My larger problem was that, of course, I didn't have a way to automate getting PDFs from those MHTs, which was the original issue.<br/>
<br/>
The possibilities that I had developed so far seemed to be as follows:  (1) Forget automation; just print the MHTs manually, selecting 15 at a time and choosing the Print option, which would start 15 sessions of Word.  (2) Select and open them in Firefox or some other browser, which would open up 15 (or whatever number) of individual tabs, each likewise calling for manual printing as PDFs unless I could find a way to automate the printing of multiple browser tabs.  (3) Try to figure out why the Internet Explorer approach was giving me blank PDFs.  (4) Look again for something other than mht2htm, to convert MHTs to HTML.  (5) Play some more with the wkHTMLtoPDF approach, in case some automated solution emerged from that.<br/>
<br/>
As I wrote those words of review, I wondered whether Windows XP might handle one or more of those alternatives differently.  I had already installed Windows Virtual PC, with its pre-installed virtual Windows XP session; all I needed was to go in there and, if necessary, <a href="https://web.archive.org/web/20151118082655/http://raywoodcockslatest.blogspot.com/2012/01/unlocking-pdfs.html" target="_blank">install programs</a> in it.  But I hadn't encountered any specific indications that some program or approach had worked better in Windows XP, so I decided not to pursue this.<br/>
<br/>
I thought I could at least search for some other MHT converter.  It suddenly appeared that, in my focus on PDF <em>printers</em>, I might not have done a simple search for an MHT to PDF <em>converter</em>.  <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?q=%22MHT+to+PDF%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">That search,</a> done at this point, led to <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?q=novaPDF&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">novaPDF</a>, a piece of commercial software that would apparently do the job.  But on closer examination, novaPDF did not seem to have a batch printing capability.  Another program, <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/htmltools/htmltools.zip" target="_blank">VeryPDF HTML Converter</a>, came in a <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/wordpress/201201/convert-mht-to-pdf-and-encrypt-pdf-20325.html" target="_blank">command line version</a> whose basic syntax was apparently like this:<br/>
<blockquote>htmltools [options] [source file] [output file]</blockquote>This syntax assumed, as with wkHTMLtoPDF (above), that htmltools.exe was being run in a folder, like my D:\Workspace, where the command files would be present -- unless, again, the user wanted to fiddle with path or environment variable adjustments.  Typing just "htmltools" on the command line, or opening the accompanying Readme file, demonstrated that this had lots of options.  I thought I might try just using it, to see if it worked at all, before fiddling with options.  So I copied the full contents of the VeryPDF program folder (i.e., several folders and 15-20 files, including htmltools.exe) to D:\Workspace, made sure Test.mht was there as well, opened a command window there, and typed this:<br/>
<blockquote>htmltools Test.mht TestOut.pdf</blockquote>The command window gave me a message, "You have 299 time to evaluate this product, you may purchase a full version from <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/">http://www.verypdf.com</a>."  I didn't find a reference to htmltools on their <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/" target="_blank">products webpage</a> or on their list of <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/custom/select-pdf-products.htm" target="_blank">PDF Products By Functions</a>, and this particular message didn't give me another name to look for, so I wasn't sure whether I would be buying the right program.  A review of a couple of webpages eventually revealed that this was <a href="https://web.archive.org/web/20151118082655/http://www.verypdf.com/htmltools/index.html#dl" target="_blank">VeryPDF HTML Converter</a>.  The GUI version, which I didn't want, would cost $59.  Sixty bucks to convert MHTs?  But it got better, or worse.  The command-line version was $399.  I guess while I was at it, I could ask them to throw in Gold Support for only $1,200 a year.  Beyond a certain level of ridiculousness, a casual user might be forgiven for considering the option of just running this puppy in a disposable virtual machine, if uninstalling and reinstalling didn't do the trick.  In all fairness, they seemed to be thinking of server administators, not private home users.  And they did give us 300 free conversions.  Still, at prices like these, it would have been nice if that would be 300 copies a year, not 300 lifetime.  They were basically persuading me to use the program once and then forget about it.<br/>
<br/>
Anyway, the program ran for a few seconds and then claimed it had succeeded.  I looked.  TestOut.pdf definitely did exist, and it looked good.  No apparent need for any additional options.  I wondered if it would default to the same filename with a PDF extension if I just typed "htmltools Test.mht," without specifying TestOut.pdf, so I ran the command again with that alteration.  That worked.  I tried it once more, this time specifying a source folder and an output folder without a filename ("htmltools D:\Workspace\Source\Test.mht D:\Workspace\Output").  This time, it said, "Save to file failed!"  Its messages seemed to say that it found Test.mht without a problem.  Why wouldn't it write to Output?  Maybe it was trying to write a file called Output, when I already had a folder by that name.  I repeated the command, this time with a trailing backslash (i.e., "htmltools D:\Workspace\Source\Test.mht D:\Workspace\Output\").  Still failed.  And the bastards docked me anyway.  I was down to 296 free tries.  So what were we saying:  it could output a file without a need to specify a filename, but it couldn't output to another folder?  If all else fails, <a href="https://web.archive.org/web/20151118082655/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=cYC&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=RTFM+%22read+the%22+manual&amp;oq=RTFM+%22read+the%22+manual&amp;aq=f&amp;aqi=g1&amp;aql=&amp;gs_sm=e&amp;gs_upl=11417l14729l0l14901l18l13l0l0l0l0l525l2732l3.3.0.2.2.1l11l0" target="_blank">RTFM</a>.  But the Readme.txt didn't contain any references to folders or directories.  Well, would it at least work if I specified everything (i.e., "htmltools D:\Workspace\Source\Test.mht D:\Workspace\Output\Test.pdf")?  Yes, it would.  So that was the answer:  I would have to work up my command lines in Excel (above) to include the full file and path names for both the source and the target.  With those commands in a batch file, I decided to give it a run with a couple dozen files, just to make sure, before blowing my remaining 295 budgeted conversions on a futile gesture.  It ran well.  I was set.  My fear that some commands might be too long was unfounded:  the htmltools commands ran successfully with a command as long as 451 characters.  I converted the rest of these MHTs and then deleted them, and hoped never to see them again.<br/>
<br/>
Technically speaking, the project was done.  If I needed more MHT conversions than I could accommodate within the limited private usage of VeryPDF's htmltools.exe, I would go back to the five options enumerated at the start of this last section of this post.  Since I already had all this stuff in mind, and my Excel spreadsheet was set to go, I ran a couple more lines:<br/>
<blockquote>DIR D:\*.mht /s /a-d /b &gt; D:\MHTlist.txt<br/>
DIR E:\*.mht /s /a-d /b &gt;&gt; D:\MHTlist.txt</blockquote>to see if I had any other MHTs on D or E.  (Note the double &gt;&gt; marks in the second line -- that says add to MHTlist.txt instead of overwriting it, if it already exists.  Of course, once I had the command set, I could just hit the Up arrow in the command window to bring the previous command back, after running it, and then use Home and left &amp; right arrow keys to revise it.)  This gave me a file called MHTlist.txt, containing a list of additional MHTs that I thought I might as well convert to PDFs while I was at it.  For these, the command lines would produce a PDF back in the source folder.  Once those PDFs were created in the source folders, I used Excel (and could probably also have used Ctrl-H in Notepad), to do a DIR [filename].* &gt;&gt; listing (which would show both \Source Folder\File.mht and \Source Folder\File.pdf in the resulting dirlist.txt file) for each specific file that I had converted.  This produced a nice pairs for each filename (i.e., x.mht and x.pdf).  The process seemed to work.  Now I just needed one more go with Excel, to produce DEL lines that would get rid of the MHTs in the source files.  One more check:  no MHTs left.  Project completed.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
If this sort of project came along again, I would want to take a look atthe PrintHTML webpageon printing HTML from the command line, to see if its approach would work for MHTs.

**Anonymous**:
Funny!I wanted to convert about 80 mht files into pdf today and was going same way thru applications as you! :)

**raywood**:
Brilliant minds work alike.

**raywood**:
A later postprovides another angle on this.

**Gallows**:
Brilliant minds lol. Here are some tips for you ppl.1. "Linkify" is an firefox addon that converts text to links. so you just save a directory list with path as a text file and then change the extension to .html, open it in firefox to see it as links.2. "Unmht" is a firefox addon to read and save as mht. (Just in case)3. "Print pages to pdf" is a firefox addon that helps print all tabs to pdf. So just open all your mht files and use the addon to print it in one go!

**Freddy Crosby**:
Thanks for describing this tool in such detail. I didn't know about it. I had been using a tool at http://mhtviewer.com to convert mht files into pdf files using their commandline line tool.

**sunk818**:
Unless you have hundreds or thousands to batch process, it might be faster to just open in IE and print to PDF.Anyway, you're welcome to try my solution:Try this MHTML converter:http://www.softpedia.com/get/Internet/Other-Internet-Related/MHTML-Converter.shtmlUse 7-zip Portable to Open the Inside of the EXE. You will find MHTML Converter.exe inside. This can run standalone.You might have to manually rename some folders with non friendly characters such as # (pound) in the folder name and file name.Delete your MHT files now as they are all HTML files within their respective folders.You can finally use a forfiles (available from Vista and on, not forfiles 1.1 from 1998) and use a command line this:forfiles /m *.htm* /s /c "cmd /c echo wkhtmltopdf.exe @path @fname.pdf"The echo just creates the batch file that you can run to process all your HTML files into PDFs. All your PDF will be saved to the path you are running the batch file from.Alternatively, you can run do dir /b /s *.htm* to get a list of HTML files in all your subdirectories. Then have to create your batch file manually from there.

**Александр Букуров**:
I would also add descriptions of two more programs: Print Conductor and 2Printer. The first one is simple and convenient. It is able to automate the conversion of a large number of files to the popular formats. It also supports MHT (HTML):http://www.print-conductor.com/news/batch-print-mht.html. The second program is the command line that can be utilized within the corporate network and can also convert files with fine tuning. It supports MHT files as well:http://www.print-conductor.com/news/batch-print-mht.html. We have made this software part of our corporate document flow system.

