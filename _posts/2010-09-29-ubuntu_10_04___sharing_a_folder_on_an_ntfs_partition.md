---
layout: post
title: "Ubuntu 10.04:  Sharing a Folder on an NTFS Partition"
date: 2010-09-29
---

<div class="post-body">
<p>I had two computers running Ubuntu 10.04.  These machines were connected by ethernet cable through a router.  Both had Samba installed, and both had a shared folder set up as described in <a href="https://web.archive.org/web/20141017113119/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-ethernet-networking-two.html">another post</a>.  I had set up one of those shared folders on an ext3 partition.  As that other post indicates, I was able to see the contents of that shared folder from the other computer.  But without thinking about it, I had set up the other computer's shared folder on an NTFS partition.  Seeing a folder on that partition turned out to be a more complicated matter than I had expected.  This post describes my efforts in that regard.<br/>
<br/>
Right away, <a href="https://web.archive.org/web/20141017113119/http://raywoodcockslatest.blogspot.com/2010/06/ubuntu-1004-rsync-failed-to-set.html">I rediscovered</a> that chown wouldn't work as expected with NTFS drives, and that it was therefore necessary or advisable to type "sudo gedit /etc/fstab" and change the lines for NTFS drives or partitions to something like this:<br/>
<blockquote>UUID=[UUID for the drive] /media/partitionname ntfs-3g rw,suid,dev,exec,auto,user,async,umask=000 0 0</blockquote>and then unmount ("sudo umount /media/partitionname") and remount the partition.  Remounting would apparently force a look at the new contents of fstab, and could be done with "sudo mount /dev/sdc3 /media/drive1" or just "sudo mount -a" (assuming a folder named /media/drive1 had already been created (e.g., "sudo mkdir /media/drive1")).  That fstab line was one I had developed to replace the "defaults" word that appeared in some fstab lines previously:  it made all of the default settings explicit, and changed some of them.  Yet even with this change, when I tried to set the Sharing Options in Nautilus, I got this error message:<br/>
<blockquote>Folder Sharing<br/>
<br/>
'net usershare' returned error 255: net usershare add: cannot share path /media/partitionname/folder2 as we are restricted to only sharing directories we own.<br/>
<br/>
Ask the administrator to add the line "usershare owner only=false" to the [global] section of the smb.conf to allow this.</blockquote>I was willing to go into smb.conf and make that change, but first I wanted to know why (as I confirmed with a right-click &gt; Properties) root still owned that folder.  This led to the insight that NTFS filesystems (such as the one I was trying to share) did not remember ownership, so the partition would need to be reminded each time I mounted it.  One way to do this was to modify the fstab line to include user and group identifications:<br/>
<blockquote>UUID=[UUID for the drive] /media/partitionname ntfs-3g rw,suid,dev,exec,auto,user,async,umask=000,uid=username,gid=groupname 0 0</blockquote>and then save fstab and unmount and remount the partition (above).  And yet that still didn't do it.  The better statement seemed to be, not that NTFS partitions needed to be reminded, but that they simply didn't have an ownership concept.  There seemed, then, to be no alternative but to type "sudo gedit /etc/samba/smb.conf" and add the line "usershare owner only=false" to its [global] section, as advised above.  I saved and closed that and tried Sharing Options again.  This time it worked, or at least it didn't give me an error message.<br/>
<br/>
Unfortunately, the shared folder still wasn't showing up on the other computer's Places &gt; Network list.  <a href="https://web.archive.org/web/20141017113119/https://bugs.launchpad.net/ubuntu/+source/samba/+bug/175689">It sounded like</a> the solution might be to try Sharing Options as root ("sudo nautilus").  Unfortunately, at this point "sudo nautilus" was giving me an error message on that computer:<br/>
<blockquote>(nautilus:23890): Unique-DBus-WARNING **: Error while sending message: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.</blockquote>I wondered what would happen if I stepped away from the NTFS situation for a moment.  I decided to try sharing a folder on an ext3 partition in that same computer.  I right-clicked on the ext3 partition in Nautilus, chose Create Folder, named the folder, went to the Share tab, and selected "Share this folder" and "Allow others to create and delete files in this folder."  This gave me an error message:<br/>
<blockquote>'net usershare' returned error 255: net usershare add:<br/>
cannot stat path /media/partitionname/foldername to ensure this is a directory.  Error was No such file or directory</blockquote>I guessed that this might be because I had gone directly to the Share tab without first clicking Close in the Basic tab there in the P4 Share Properties dialog.  So, OK, I saved the new folder first, and then right-clicked on it in Nautilus and chose Sharing Options.  This time it went OK.  I went into System &gt; Administration &gt; Samba, as described in <a href="https://web.archive.org/web/20141017113119/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-ethernet-networking-two.html">the other post</a>, and added this folder there.  But I still wasn't able to see it from the other computer.  I rebooted this problematic machine and tried again.  In doing so, I noticed that GParted and some other things were still running on another desktop, so that may have explained why "sudo nautilus" worked OK after the reboot.  The sharing step just described also worked OK.  But Places &gt; Network on the other computer still didn't show the problematic computer.   <br/>
<br/>
I was just about to change some hardware and reinstall Ubuntu on that machine anyway, so I deferred further effort on this project until after that was done.  At that point, though, I found a better folder-sharing solution by <a href="https://web.archive.org/web/20141017113119/http://raywoodcockslatest.blogspot.com/2010/10/ubuntu-1004-connecting-to-synology.html">using a Synology network-attached storage (NAS) unit</a>.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**johnh10000**:
Thanks mate, johnh10000, that worked fine on my Ubuntu Lucid box!johnh10000@gmail.comSaved me hours of copying 2tb

