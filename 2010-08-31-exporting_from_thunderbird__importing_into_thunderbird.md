---
layout: post
title: "Exporting from Thunderbird, Importing into Thunderbird"
date: 2010-08-31
---

<div class="post-body">
<p>I was using <a href="https://web.archive.org/web/20151205115226/http://www.mozillamessaging.com/en-US/thunderbird/">Thunderbird</a> as my e-mail program in Ubuntu.  I decided to switch to using Thunderbird 3.1 for Windows as my e-mail program.  It seemed, at this writing, that <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+import&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">most people</a> who were transitioning to Thunderbird were going toward Ubuntu, not away from it.  So in this post I am writing up some things that I had to figure out along the way.<br/>
<br/>
I decided to switch to Thunderbird for Windows because I was planning to keep Ubuntu as my underlying operating system, but to focus my applications on Windows XP, which I would be running in a virtual machine in VMware.  This arrangement, I found, gave me dual-boot advantages without having to reboot.<br/>
<br/>
I was particularly interested in using <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+portable&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8#num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=thunderbird+portable&amp;fp=35ecbd3c1d90e59c">the portable version</a> of Thunderbird as my Windows XP e-mail application.  This would enable me to take my e-mail and my address book with me on a USB flash drive.  The discussion of Thunderbird for Windows in this post relates specifically to the portable version.<br/>
<br/>
After setting up Thunderbird Portable on a Windows computer and making a backup copy, I went into Ubuntu and simply copied over my data.  I found the relevant data in Nautilus (i.e., Ubuntu's File Browser, the equivalent of Windows Explorer), in this location:  Home Folder / .thunderbird / 6abstqrst.default.  (The 6abstqrst part of that name was apparently generated at random, and as such would have a different name in other installations.  Point is, it's the "default" folder.)<br/>
<br/>
I copied that entire default folder to a USB jump drive and compared its subfolders, item by item, to those on the computer where I had installed Thunderbird Portable.  (Of course, I did these and other folder manipulations (below) while Thunderbird was <i>*</i>not* running.)  The comparable e-mail account data seemed especially to be located under the Data\profile\Mail folder.  Thunderbird's Address Book seemed to be in Data\profile\abook.mab.  The Address Book copied and worked without any problem.  The following discussion focuses on problems in getting the e-mail accounts to work correctly.<br/>
<br/>
The simple process of copying e-mail accounts over seemed to work well enough.  I copied all of the folders from Ubuntu via my jump drive to the corresponding Thunderbird folders on the Windows machine.  I kept backups and did this rather painstakingly.  After replacing the contents of one subfolder in Thunderbird Portable with the contents brought over from Thunderbird for Linux, I would start up Thunderbird Portable and make sure that it still seemed to be functioning OK.  Through this process, I ended up with a Thunderbird Portable setup where the desired e-mail accounts did exist.  This may have been helped by the decision to run Thunderbird's Tools &gt; Import option, which I did somewhere along the way.<br/>
<br/>
When I was done, unfortunately, the e-mail accounts that showed up when I ran Thunderbird Portable were still not showing the contents that I wanted them to show.  For example, my Hotmail account was there, but its Inbox was empty, whereas the Hotmail Inbox on Thunderbird for Linux had contained a dozen e-mail messages.  I could see, moreover, that the Data\profile\Mail\pop3.live.com folder contained an Inbox that was 96MB in size.  That was larger than I would have expected, and in any case much larger than an Inbox containing nothing, which is what Thunderbird Portable was showing me.<br/>
<br/>
It seemed that Thunderbird Portable was recognizing the e-mail accounts themselves, but was drawing the contents of those accounts from the wrong place.  I verified this by removing the entire Mail subfolder from Thunderbird Portable.  When I started it up, it was still seeing the same few old items in the same accounts.  I thought it might have observed or figured out where I had moved the Mail folder, so I removed it from that computer entirely; yet Portable was still seeing those same ghostly remnants of some previous state of my Thunderbird for Linux installation.<br/>
<br/>
It took a bit of effort to figure out where those ghostly remains were hanging out.  Portable wasn't drawing them from Data\profile\Cache; they persisted even after I emptied that.  To find the answer, I started Portable, changed the system date to a year in the future, copied one of those old e-mail messages from one folder to another, changed the system date back to the correct year, and exited Portable.  Then I copied the entire Portable folder to a workspace folder elsewhere on the computer, and searched for files bearing that future year's date.  Aside from cache files and scripts, there turned out to be only a handful of files dated in that future year.<br/>
<br/>
That effort led to the discovery that the Data\profile\prefs.js file that I had brought over from Ubuntu was not suited for Windows.  I went to the original backup of my Thunderbird for Windows Portable and copied its prefs.js file to the Portable installation that I was tinkering with, thus overwriting the Ubuntu prefs.js file.  Both of them began with a warning:  "Do not edit this file."  Instead, the warning said, I could follow the instructions provided on <a href="https://web.archive.org/web/20151205115226/http://www.mozilla.org/unix/customixing.html#prefs">a webpage </a>that, as it turned out, was no longer in existence.  <a href="https://web.archive.org/web/20151205115226/http://kb.mozillazine.org/Empty_folders#Absolute_paths_in_prefs.js">A different webpage</a> did advise me to edit prefs.js directly.  Again, of course, I would want to do this while Thunderbird was not running; and if there was any doubt about that, Windows Task Manager (Ctrl-Alt-Del &gt; Processes tab) would confirm whether there was an instance of thunderbird.exe or ThunderbirdPortable.exe currently running.<br/>
<br/>
I opened prefs.js in Notepad, widened the Notepad window to prevent lines from wrapping, and took a look.  I decided I didn't know exactly how to edit prefs.js, so I tried the alternative that the instructions at the top of prefs.js seemed to prefer:  I started Firefox, typed about:config in the address line, and looked to see what was there.  (Note that I did not have any other copies or versions of Thunderbird installed on that computer, else things could have become very confusing.)  <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;q=thunderbird%20%22about%3Aconfig%22%20prefs.js%20folders&amp;um=1&amp;biw=1679&amp;bih=889&amp;ie=UTF-8&amp;sa=N&amp;tab=iw#num=50&amp;hl=en&amp;newwindow=1&amp;biw=1679&amp;bih=889&amp;q=%22thunderbird+portable%22+%22about%3Aconfig%22+prefs.js+folders+email+OR+%22e-mail%22+-seamonkey&amp;fp=35ecbd3c1d90e59c">I searched</a> for instructions, and eventually realized that it might not make sense to use about:config to change system preferences for a portable program.<br/>
<br/>
So I tried <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;q=thunderbird%20%22about%3Aconfig%22%20prefs.js%20folders&amp;um=1&amp;biw=1679&amp;bih=889&amp;ie=UTF-8&amp;sa=N&amp;tab=iw#num=50&amp;hl=en&amp;newwindow=1&amp;biw=1679&amp;bih=889&amp;q=%22thunderbird+portable%22+prefs.js+folders+email+OR+%22e-mail%22&amp;fp=35ecbd3c1d90e59c">another search</a>.  This led to a webpage that led, eventually, to <a href="https://web.archive.org/web/20151205115226/http://kb.mozillazine.org/Importing_folders">a mozillaZine webpage</a> that advised me to start over and try using the Kaosmos <a href="https://web.archive.org/web/20151205115226/http://www.nic-nac-project.org/%7Ekaosmos/mboximport-en.html">ImportExportTools</a> utility.  So I made a fresh start, replacing my munged-up Thunderbird Portable with a copy of the backup, and then I installed the ImportExportTools utility as instructed.  Then, in Thunderbird Portable, I went to Tools &gt; ImportExportTools &gt; Import mbox file.  At this point, I had to ask myself:  What, exactly, is an mbox file?  A search led to <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=mbox+mail&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8#num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=mbox+email+OR+%22e-mail%22&amp;fp=35ecbd3c1d90e59c">the discovery</a> that mbox is an e-mail storage format that didn't seem very relevant to Thunderbird's own storage format <br/>
<br/>
To test this, I went ahead with where I was in the ImportExportTools process:  I selected the "Select a directory where searching the mbox files to import (also in subdirectories)" option, and pointed it toward the top level of the folder I had copied over from Ubuntu Thunderbird.  To my surprise, the tool asked me if I wanted to import various programs.  I said no to parentlock and yes to all the other folders it asked me about.  After asking me about those folders, it didn't seem to be doing anything, except that I could see movement in the green progress bar at the bottom of the screen.  When it seemed to be finished, I didn't see any change in Thunderbird's list of folders.  I killed and restarted Thunderbird.  Still no change.  I poked around and then, whoa, I discovered that it had imported everything, including my archives, into the Hotmail Inbox folder (not the actual online one -- just the copy of it that Thunderbird keeps).  I killed T-bird again, made a backup copy of this remarkable state of Thunderbird Portable, restarted the program, and began moving and rearranging folders.<br/>
<br/>
This was looking good, but there were still some things to fix.  First, in T-bird Portable, I tried sending a message that I had kept in the Hotmail drafts folder in Thunderbird for Ubuntu.  I got this message:<br/>
<blockquote>Send Message Error<br/>
Sending of message failed.<br/>
An error occurred sending mail.  Unable to establish a secure link with SMTP server smtp.live.com using STARTTLS since it doesn't advertise that feature.  Switch off STARTTLS for that server or contact your service provider.</blockquote><a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+%22sending+of+message+failed%22&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8#num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=thunderbird+%22sending+of+message+failed%22+STARTTLS&amp;fp=35ecbd3c1d90e59c">A search</a> and then <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+%22sending+of+message+failed%22&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8#num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=thunderbird+%22sending+of+message+failed%22+STARTTLS+%22smtp.live.com%22&amp;fp=35ecbd3c1d90e59c">a refined search</a> led to the quick answer that I just had to stop my avast! antivirus software from scanning outgoing messages.<br/>
<br/>
Next, I wanted to <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+delete+unwanted+folders&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">get rid of some Local Folders</a>, especially the Inbox and Outbox.  I found <a href="https://web.archive.org/web/20151205115226/http://www.windowsbbs.com/firefox-thunderbird-seamonkey/91210-how-delete-unwanted-folder-thunderbird.html">a thread</a> that made me think these folders were a product of <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+smartfolders+OR+%22smart+folders%22&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">Smart Folders</a>, which would supposedly combine all of my e-mail inboxes into one Inbox, etc.  I did not want this.  Actually, I wasn't sure this was even the correct explanation, because I was seeing new incoming messages in my Hotmail Inbox, and they were not being mirrored in my Local Folders Inbox.  The advice I got from <a href="https://web.archive.org/web/20151205115226/http://answers.yahoo.com/question/index?qid=20091210205032AACe40m">Yahoo! Answers</a>, usually a font of goofy bewilderment, was as follows:<br/>
<blockquote>You can't remove the Smart Folders account using Tools -&gt; Account  Settings. You need to either edit prefs.js with a text editor or use the  Config editor to delete the account from mail.accountmanager.accounts.</blockquote>I was inclined to believe this because I had just run across <a href="https://web.archive.org/web/20151205115226/http://howto.gumph.org/content/removing-local-folders-from-thunderbird/">another webpage</a> with more or less the same conclusion.  But the advice on that webpage was oriented toward deleting all local folders, whereas I was using the Local Folders heading as the place to park my e-mail archive.  I right-clicked and saw, from Properties, that Outbox folder was located at Data\profile\Mail\Local Folders\Unsent Messages.  I quit T-bird, made a backup copy of the whole T-bird Portable folder, went into that Local Folders folder in Windows Explorer, and deleted the Unsent Messages entries.  I then restarted T-bird.  No joy.  As expected, the Outbox was still there and the Unsent Messages entries were back.  <a href="https://web.archive.org/web/20151205115226/http://www.google.com/search?hl=&amp;q=thunderbird+delete+unwanted+folders&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8#num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=thunderbird+delete+%22local+folders%22+-imap+outbox+%22unsent+messages%22&amp;fp=35ecbd3c1d90e59c">A new search</a> led to <a href="https://web.archive.org/web/20151205115226/http://forums.mozillazine.org/viewtopic.php?f=28&amp;t=1752545">a blanket statement</a> that you could not delete the Outbox because it served an essential function, different from a Drafts folder:  it held messages that the user had tried to send but (because of e.g., no Internet connection) had not yet actually been sent.<br/>
<br/>
So I turned to the next problem arising from the import into Thunderbird Portable for Windows.  I now had two top-level folders appearing at the left side of the T-bird window.  One was for my Hotmail account; the other was for Local Folders.  There should have been a third one, for another e-mail account that had appeared as a top-level folder in T-bird in Ubuntu.  This seemed to be a simple matter of going into T-bird Portable &gt; File &gt; New &gt; Mail Account and entering the information about the account as it was recorded in T-bird for Ubuntu.  But the Mail Account Setup process stayed stuck for a long time on "Looking up configuration:  Trying common server names."  I finally went into Manual Setup and got it working that way.  And with that, the project was done.  I had transitioned from Thunderbird (Ubuntu) to Thunderbird Portable for Windows.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**Michael Anthony**:
Hi RayHave been having a similar problem; it only started when Thunderbird Portable 3 was released.I have a 1and1 IMAP server in Germany, which is at least a good backup. Having had issues with my ISP, I cancelled by DSL subscription, and now use a local internet cafe. Therefore, I want to be able to use Thunderbird Portable to see my my mail when I'm using my system at home (Windows 7 Ultimate), without an internet connection.Same problem occurs: the mail is not being shown, but the accounts (7 of them) are.When I go back to the internet cafe, it simply overwrites the profile folders with newly downloaded email - and then disappears again when I go offline.I have tried playing with relative paths, and ensuring RunLocally (ThunderBirdPortable.exe) is turned off; but to no avail.Any ideas? I really don't want to have to switch to Opera Portable for Mail, it really irritates me.Thanks in advance. :)Michael

**raywood**:
Michael -- I am hoping to do some more work in Thunderbird within the next couple of weeks.  I may blog that if I do.  Check back.  One possibility is that I will just switch to a non-portable version.

**Michael Anthony**:
Hi Ray - thanks for the quick response.The problem seems to only occur if I don't use the PortableApps launcher (well, I only tried once...)Still, I don't think that Thunderbird has been made into a proper portable app - much can be done to enhance it...Take care, and Happy Holidays. :)Mike

