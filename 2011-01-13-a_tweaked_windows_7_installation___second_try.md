---
layout: post
title: "A Tweaked Windows 7 Installation:  Second Try"
date: 2011-01-13
---

<div class="post-body">
<p>I was installing Windows 7.  I had spent days exploring various possibilities.  Unfortunately, I had also acquired a networking problem for which a new installation seemed to be the only solution.  This post consolidates what I learned in <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-first-try.html">the first installation attempt</a>, and adds some new items.  As in that previous post, some of these items were recorded after the fact, and may not look or function precisely as described here.  For example, settings may already have been changed by the time they come into focus in the sequence described here. <br/>
My first step was to delete all accounts except the Administrator and the Guest.  The changes described here thus had to be made only to the Administrator account.  I also allowed Windows and other updates whenever they seemed to be ready for installation.  In Windows Update, after installing desired updates, I highlighted all unwanted updates (e.g., foreign language packs) &gt; right-click &gt; "Hide updates."<br/>
<br/>
I made some preliminary adjustments in Windows Explorer.  These included Organize &gt; Layout &gt; Details pane, right-click on the menu and turn on Classic Explorer Bar, and also in Windows Explorer, in Tools &gt; Folder Options.  Also, in my early usage of Internet Explorer, I allowed it to turn on AutoComplete (Tools &gt; Content &gt; Settings).  (This did not fix <a href="https://web.archive.org/web/20151125204350/http://social.answers.microsoft.com/Forums/en-US/InternetExplorer/thread/54391701-3eb0-4cbf-a7b3-a0a4deff2dbd">the perennial problem</a> of IE not remembering passwords, by the way.)<br/>
<br/>
During the first installation, I organized programs that I was installing (including drivers, batch files, and other materials) into folders.  I numbered the folders (01, 02, 03 ...) so that they would appear in the correct sequential order in Windows Explorer.  The contents of all of these folders had to be checked to make sure that I was using programs and other materials designed for Windows 7.  Some but not all of my Windows XP programs fit that description.  The first several folders, at this point, had these names:<br/>
<blockquote>01 Motherboard Drivers and Utilities<br/>
02 Programs Needed at Start<br/>
03 Other Installation &amp; Tweaking Programs<br/>
04 Broadly Useful Programs<br/>
05 Experimental and New Programs</blockquote>The contents of folder 05 are addressed in later posts.  This post goes up through folder 04.  In other words, this post describes what I installed, and how I adjusted it, to set up a general-purpose system, mostly using software that I had used previously.<br/>
<br/>
Folder 01 contained several subfolders, likewise numbered sequentially.  The first contained drivers that I would need to load during the Windows 7 installation process if I wished to install Win7 in a RAID array.  I had decided against that.  The second subfolder contained drivers to be installed after the basic Windows 7 installation.  I installed these, and continued on to install motherboard utilities.<br/>
<div></div><div>Folder 02 contained a few items that I found very useful during the installation and setup process:</div><ul><li>Antivirus.  I was currently using just Microsoft Security Essentials and Windows Defender, for convenience during installation.</li>
<li>AvaFind Professional.  A program that quickly finds filenames.  Some program of this sort was invaluable for locating files needed for various purposes during installation and tweaking.</li>
<li>7-Zip.  Programs to be installed, that had to be downloaded, often came in zipped format.  Windows provided an unzipping feature, but this one was more versatile.</li>
<li>Google Chrome.  I found it easier to use Chrome, rather than Internet Explorer, to search for installation-related information.  Turning on Chrome's sync feature minimized the time needed to configure this tool.  Basically, my list of <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/google-chrome-recommended-extensions.html">favored extensions</a> was available as soon as I installed Chrome.</li>
<li>Bullzip PDF Printer.  There were a few items that I wanted to save as PDF during this process.</li>
<li>Router driver and utilities.</li>
</ul>Folder 03 contained hardware drivers, registry edit (.reg) and batch (.bat) files used to configure the system, and other programs needed for the basic installation and tweaking process.  <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-first-try.html">The previous post</a> describes most of the materials in this folder.  I have added links in the following list to those that are not mentioned in that previous post.  For the most part, I ran straight through these materials, installing them all after the initial Windows installation.  I installed the programs before turning to the manual tweaking tasks (below) because these programs would take care of some of those tasks automatically.  The programs I installed at this point, in approximately this order, were as follows:<br/>
<ul><li>Printer drivers and utility software.</li>
<li><a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-win7regeditreg.html">Win7NewInstall.bat and Win7RegTweaks.reg</a>.  These contained a collection of registry tweaks and other adjustments and customizations.</li>
<li>Classic Shell, to change the look and some functions of the Windows 7 Start Menu and Windows Explorer to what I considered the more efficient form of Windows XP.  I went ahead and configured these items at this point.</li>
<li>Somehow <a href="https://web.archive.org/web/20151125204350/http://windows.microsoft.com/en-US/windows7/products/features/windows-live-essentials">Windows Live Essentials</a> came up, asking how much of Live Essentials I wanted to install.  I chose Messenger, Movie Maker, and Windows Live Mesh.</li>
<li>The first time I tried to play an audio file, Windows Media Player popped up and had to be configured.</li>
<li><a href="https://web.archive.org/web/20151125204350/http://www.iobit.com/iobitsmartdefrag.html">IOBit Smart Defrag</a>.  I had used this defragmenter for several years and had no problems with it.</li>
<li><a href="https://web.archive.org/web/20151125204350/http://lockhunter.com/">LockHunter</a>.  This was experimental, for me -- a replacement for Unlocker.  Preliminarily, it appeared less functional.  I wanted integration with the Windows Explorer context menu.  I hoped for a Win7-compatible update of Unlocker.</li>
<li><a href="https://web.archive.org/web/20151125204350/http://www.apple.com/quicktime/download/">QuickTime</a>.  It appeared that several other programs depended upon this program being installed.</li>
</ul>After installing those necessary programs, I changed the following items from the default in Ultimate Windows Tweaker (clicking Apply after each bullet point):<br/>
<div></div><div></div><ul><li>Personalization:  Hide detail pane.</li>
<li>User Accounts &amp; UAC:  Enable admin approval mode for the built-in administrator account.</li>
<li>System Performance:  Enable support for 4GB of RAM on 32-bit Windows OS.  Disable Tablet PC Input service.</li>
<li>Network Tweaks:  Disable auto-discovery of media contents in shared network by Windows Media Player.</li>
<li>Internet Explorer:  Uncheck "Open first home page when IE starts."  Uncheck "Disable IE check for updates."  Uncheck "Notify when download completes."</li>
<li>Additional Tweaks:  Uncheck "Show 'Search ...'"  Show "Move To Folder..."  Remove "-Shortcut" suffix for new shortcuts.</li>
<li>It appeared, in some cases, that Ultimate Windows Tweaker was not always effective.  I installed <a href="https://web.archive.org/web/20151125204350/http://www.tweaknow.com/">TweakNow</a> PowerPack 2010 and used it to deselect drives not to be displayed in Windows Explorer (in my case, floppy drive A). This setting was in Windows Secret &gt; Windows Explorer.</li>
</ul>After restarting the machine, I made changes in Control Panel.  These, too, follow but also modify the steps described in the previous post.  Some (Action Center, Administrative Tools) had already been done in previous steps (e.g., while installing updates or resizing partitions)  Auto-Play was already set the way I wanted, which was suspicious:  had I made more changes to the two-week-old image on which I was doing these tweaks than I had recorded?  Likewise for Personalization (Windows Classic theme. Window Color &gt; Adjust at least Active Title Bar, Inactive Title Bar, Menu, and Desktop).  Regarding Backup and Restore, I was still using Acronis as a fail-safe, but was also using the Win7 system image option.  I would make both after completing some more tweaks.  For regular data backup, I was still using <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2010/06/ubuntu-1004-rsync-failed-to-set.html">Beyond Compare</a>, which I found was pretty good at showing me when I had nested files too deep.  <br/>
<br/>
Control Panel options still requiring attention were as follows:<br/>
<ul><li>Internet Options: I went into General tab &gt; Tabs &gt; Settings &gt; adjust as desired. I went to Security tab &gt; Custom Level &gt; Scripting section (near the bottom) &gt; Allow programmatic clipboard access &gt; Enable. I saved and closed those.  I went into Content tab &gt; Autocomplete Settings &gt; turn on.  Then I navigated to YouTube.com and played a video, so as to trigger the process of installing Adobe Flash Player.</li>
<li>Power Options: Show additional plans &gt; High performance &gt; Change plan settings &gt; Change advanced power settings &gt; Change settings that are currently unavailable &gt; High performance &gt; change individual items as desired &gt; Apply.</li>
<li>Programs and Features: Turn Windows features on or off &gt; Make sure Indexing Service is off.</li>
<li>System: Windows Activation &gt; Activate. System Protection &gt; Hardware tab &gt; Device Manager &gt; verify no yellow-circle exclamation marks. Hardware tab &gt; Device Installation Settings &gt; Yes, do this automatically. Advanced tab &gt; Performance &gt; Settings &gt; Advanced &gt; Change &gt; Uncheck automatically manage paging file size for all drivers; instead, set a paging file of 4000-8000 MB (or more) on each hard drive (not on each partition). System Protection tab &gt; Configure &gt; adjust Disk Space Usage as needed.</li>
<li>Taskbar and Start Menu: Start Menu tab &gt; Customize. Adjust various items to taste. Turn on Run command. Save and close.</li>
</ul>Additional tweaks:<br/>
<ul><li> I now had a more or less <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-setting-up-customized-start.html">complete approach</a> for developing a custom-organized Start Menu on a drive other than drive C, where it could be shared with other computers and would survive a Windows crash and reinstallation.  As described in <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-first-try.html">the previous post</a>, Win7NewInstall.bat, used in the previous installation, had created a so-called God Mode folder on this Start Menu.  That folder was still there, so I did not need to recreate it.  I just needed to get around to distributing, across my Start Menu, the shortcuts to every Windows function that I had created via the God Mode folder.</li>
<li><a href="https://web.archive.org/web/20151125204350/http://www.askvg.com/how-to-make-folder-band-auto-hidden-in-windows-vista/">As advised</a>, I used <a href="https://web.archive.org/web/20151125204350/http://download.cnet.com/Resource-Hacker/3000-2352_4-10178587.html">Resource Hacker</a> to open C:\Windows\System32\Shellstyle.dll.  There, I went into UIFILE &gt; 1 &gt; 1033.  I searched (Ctrl-F) for the line that said, &lt;style resid="FolderBandStyle"&gt;.  I inserted this code after that line:  &lt;if mousefocused="false" mousewithin="false"&gt;&lt;Element padding="rect(0rp,0rp,0rp,-28rp)"/&gt;&lt;/if&gt;.  I left it conditional, able to come up on a mouseover, because I wasn't sure if I might need it in the future.  Later, if possible, I would make this change permanent, without the mouseover option, by inserting only the "Element padding" portion of the line.  With this change made, I clicked on the Compile Script button, there in Resource Hacker. Then I saved the file as Shellstyle.dll in a backup location, so I would not have to do this again.  I right-clicked on C:\Windows\System32\Shellstyle.dll and took ownership, using one of the tweaks installed above.  I copied that backup Shellstyle.dll to C:\Windows\System32, overwriting the existing Shellstyle.dll there.  Then I logged off and back on to see the change.</li>
<li>Shut off an annoying question. On the Desktop, right-click Recycle Bin &gt; Propeties &gt; deselect "Display delete confirmation dialog."</li>
<li>To make Windows remember size and position of a window, I found two solutions mentioned near the end of <a href="https://web.archive.org/web/20151125204350/http://www.sevenforums.com/customization/8801-make-windows-7-remember-window-positions-size-20.html">a very long thread</a> on the subject.  What worked for me:  right-click on the title (top) bar of a Window.  Choose "Size."  Drag the window and its edges around.  Even if it's exactly where you want it, move it somewhere else and then back, all in one motion.  Then click on the top right X to close the window.  If that technique hadn't worked, I would have gone on to try <a href="https://web.archive.org/web/20151125204350/http://www.sevenforums.com/customization/40916-shellfolderfix-manage-folder-window-positions-size.html#post396744">ShellFolderFix</a>.</li>
<li>Every time I started the system, Windows Defender would give me the message, "This program is turned off."  <a href="https://web.archive.org/web/20151125204350/http://social.answers.microsoft.com/Forums/en-US/w7security/thread/a92b86af-51bd-42e6-ab30-d8bcbbce2ee8">Someone said</a> Windows Defender was unnecessary if I was running Microsoft Security Essentials.  Posts in that thread suggested many remedies, almost none of which worked for the original poster.  A post about two-thirds of the way down that thread offered a solution that worked for me.  I added that solution to <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-installation-win7regeditreg.html">Win7NewInstall.bat</a>.</li>
<li>Somehow, a <a href="https://web.archive.org/web/20151125204350/http://www.google.com/search?sourceid=chrome&amp;ie=UTF-8&amp;q=boot+folder+%22Windows+7%22">Boot folder</a> wound up on drive D.  <a href="https://web.archive.org/web/20151125204350/http://windows7forums.com/windows-7-support/36465-bootmgr-boot-folder-partition-[how-change-].html">A thread</a> suggested that (as administrator) I type "bcd c:\Windows /s C:" to get that folder onto drive C with the other system folders.  Before doing that, I made a System Restore point.  To do that, I went into Control Panel &gt; System &gt; Advanced system settings &gt; System Protection tab &gt; Create a restore point.  Then I went ahead with that bcdboot command.  It said, "Boot files successfully created."  I looked at C and, sure enough, there was now a Boot folder there too.  (Maybe there had been before; I hadn't thought to look.)  Now, <a href="https://web.archive.org/web/20151125204350/http://social.answers.microsoft.com/Forums/en-US/w7security/thread/2ae14df2-190b-4037-a411-871811fa65fb">as advised</a>, to delete that hopefully unnecessary Boot folder, I tried steps through the user interface (taking ownership of the folder), but those did not work.  Using another approach, I went to Start &gt; "cmd" and typed these commands (running as Administrator):</li>
</ul><span style='font-family: "Courier New", Courier, monospace;'></span>Finally, folder 04.  These were the programs, mostly familiar but some new, that I installed to set up a complete system.  These were as follows: <br/>
<ul><li>Adobe Acrobat.  I already had a copy, else I would have considered checking out some of the steadily more competent freeware alternatives.</li>
<li>Adobe Premiere Elements.  I found that a basic ability to do some video editing was valuable for many purposes.</li>
<li>CamStudio.  I was not yet finding good freeware alternatives.  CamStudio, at this point, still did not have a Windows 7 compatible version, so this was a tentative solution.  I was considering buying a copy of Debut, which had done screen video capture pretty well during my trial use of it.  I also installed Jing as an alternative, though it seemed to me that I had already tried and rejected it once if not twice.  When I rebooted, there was suddenly an unexplained, virus-looking dialog offering to let me "Enter or Create a Screencast Account."  When I figured out that this was Jing's doing, I went ahead and created the account.</li>
<li>CoolEdit.  An old audio-editing program that still had capabilities and familiarity.</li>
<li>Copernic Desktop Search.  My search had led to this as the best desktop search option, much more useful than Google Desktop Search had been.</li>
<li>Gadgets.  These were new in Vista and Win7.  Mine were not currently arranging properly on the desktop.  I was not sure how much I would use them.</li>
<li>Microsoft Office 2003.  I had OpenOffice Portable already in place as an alternative.</li>
<li>Shortcuts to copy into C:\Windows.  As noted in a comment following <a href="https://web.archive.org/web/20151125204350/http://raywoodcockslatest.blogspot.com/2010/07/tweaking-windows-xp-virtual-machine.html">a previous post</a>, I had discovered that putting shortcuts to programs would make them available for easy reference in batch files.</li>
<li>Aqua Deskperience.  I had bought this for capturing text from a region onscreen.  There were freeware alternatives that did the same thing now.</li>
<li>EditPadLite.  A Notepad alternative.  After installing this, I decided to rely on Notepad++ instead.</li>
<li>File Checksum Integrity Verifier.</li>
<li>Firefox.  The portable version had not been reliable for me.</li>
<li>Freeware PDF Unlocker.  Drag a PDF onto this desktop icon to make a non-locked copy, so that you can add highlights and comments.</li>
<li>Glary Registry Repair.  My Windows 7 replacement for Advanced WindowsCare V2 Personal.  A registry cleaner that I planned to run each time the system started.  I put a shortcut to it in the Start Menu's Startup folder.</li>
<li>Google Earth.</li>
<li>Handbrake.  For video conversions.</li>
<li>iRotate.  Turn the monitor on its side for improved screen captures in some cases.</li>
<li>Oxelon Media Converter.  Valuable context-menu addition for all sorts of conversions (e.g., getting audio out of a video file).</li>
<li>Paradox dBase Viewer.  For extracting data from old Paradox for DOS files.</li>
<li>Skype.</li>
<li>TClockEx.  For giving me date and time in the system tray.  I didn't have those because I was using Win7's classic desktop skin.</li>
<li>Thunderbird.  For email.  Again, the portable version wasn't up to the job.</li>
<li>Total Commander (above).  I wasn't actually using it much, though.  I had largely managed, by this point, to tweak Windows Explorer to suit me.</li>
</ul>Note that these were in addition to portable (i.e., standalone) applications that I already had in place and was using for many purposes.  Those were incorporated into my customized Start Menu (above) and therefore did not need to be reinstalled, or even relinked in my Start Menu, at this point.<br/>
<br/>
This gave me a complete working Windows 7 installation.  It represented a great improvement over the previous try.  I was sure there would be further ways to streamline it in future installations.<br/>
<blockquote><span style='font-family: "Courier New", Courier, monospace;'>takeown /f D:\Boot /r /d y</span><br/>
<span style='font-family: "Courier New", Courier, monospace;'>icacls D:\Boot /grant administrators:F /T</span></blockquote></p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
This post is updated bya more recent one.

**Cara Install Ulang Windows 7**:
why i always failed at the middle?

