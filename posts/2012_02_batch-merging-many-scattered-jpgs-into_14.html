<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.google.com/2005/gml/b" xmlns:data="http://www.google.com/2005/gml/data" xmlns:expr="http://www.google.com/2005/gml/expr">
 <head>
  <link href="https://web-static.archive.org/_static/css/banner-styles.css?v=1utQkbB3" rel="stylesheet" type="text/css"/>
  <link href="https://web-static.archive.org/_static/css/iconochive.css?v=3PDvdIFv" rel="stylesheet" type="text/css"/>
  <!-- End Wayback Rewrite JS Include -->
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="blogger" name="generator"/>
  <link href="https://web.archive.org/web/20141124092347im_/http://raywoodcockslatest.blogspot.com/favicon.ico" rel="icon" type="image/x-icon"/>
  <link href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/02/batch-merging-many-scattered-jpgs-into_14.html" rel="canonical"/>
  <link href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/feeds/posts/default" rel="alternate" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <link href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/feeds/posts/default?alt=rss" rel="alternate" title="Ray Woodcock's Latest - RSS" type="application/rss+xml"/>
  <link href="http://www.blogger.com/feeds/3377753575825500498/posts/default" rel="service.post" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <link href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/feeds/6329913800390976589/comments/default" rel="alternate" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
  <title>
   Ray Woodcock's Latest: Batch Merging Many Scattered JPGs into Many Multipage PDFs - Clarified
  </title>
  <link href="https://web.archive.org/web/20141124092347cs_/https://www.blogger.com/static/v1/widgets/3841957138-widget_css_bundle.css" rel="stylesheet" type="text/css"/>
  <link href="https://web.archive.org/web/20141124092347cs_/https://www.blogger.com/dyn-css/authorization.css?targetBlogID=3377753575825500498&amp;zx=0a1b8d71-88ad-400d-bb05-002a27b27ee7" rel="stylesheet" type="text/css"/>
  <style id="page-skin-1" type="text/css">
   <!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Rounders 4
Date:     27 Feb 2004
Updated by: Blogger Team
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="mainBgColor" description="Main Background Color"
type="color" default="#466">
<Variable name="mainTextColor" description="Text Color" type="color"
default="#ced">
<Variable name="postTitleColor" description="Post Title Color" type="color"
default="#fff">
<Variable name="dateHeaderColor" description="Date Header Color"
type="color" default="#cf4">
<Variable name="borderColor" description="Post Border Color" type="color"
default="#bbb">
<Variable name="mainLinkColor" description="Link Color" type="color"
default="#fff">
<Variable name="mainVisitedLinkColor" description="Visited Link Color"
type="color" default="#fff">
<Variable name="titleTextColor" description="Blog Title Color"
type="color" default="#fff">
<Variable name="topSidebarHeaderColor"
description="Top Sidebar Title Color"
type="color" default="#fff">
<Variable name="topSidebarBgColor"
description="Top Sidebar Background Color"
type="color" default="#9b5">
<Variable name="topSidebarTextColor" description="Top Sidebar Text Color"
type="color" default="#fff">
<Variable name="topSidebarLinkColor" description="Top Sidebar Link Color"
type="color" default="#fff">
<Variable name="topSidebarVisitedLinkColor"
description="Top Sidebar Visited Link Color"
type="color" default="#eee">
<Variable name="bottomSidebarBgColor"
description="Bottom Sidebar Background Color"
type="color" default="#fff">
<Variable name="bottomSidebarTextColor"
description="Bottom Sidebar Text Color"
type="color" default="#666">
<Variable name="bottomSidebarLinkColor"
description="Bottom Sidebar Link Color"
type="color" default="#475">
<Variable name="bottomSidebarVisitedLinkColor"
description="Bottom Sidebar Visited Link Color"
type="color" default="#798">
<Variable name="bodyFont" description="Text Font" type="font"
default="normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="pageTitleFont" description="Blog Title Font" type="font"
default="normal bold 200% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="descriptionFont" description="Description Font" type="font"
default="normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="headerFont" description="Sidebar Title Font" type="font"
default="normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="postTitleFont" description="Post Title Font" type="font"
default="normal bold 135% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="startSide" description="Start side in blog language"
type="automatic" default="left">
<Variable name="endSide" description="End side in blog language"
type="automatic" default="right">
*/
body {
background:#bca;
margin:0;
text-align:center;
line-height: 1.5em;
font: x-small Trebuchet MS, Verdana, Arial, Sans-serif;
color:#e6ffa2;
font-size/* */:/**/small;
font-size: /**/small;
}
/* Page Structure
----------------------------------------------- */
/* The images which help create rounded corners depend on the
following widths and measurements. If you want to change
these measurements, the images will also need to change.
*/
#outer-wrapper {
width:740px;
margin:0 auto;
text-align:left;
font: normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
#main-wrap1 {
width:485px;
float:left;
background:#446666 url("https://web.archive.org/web/20141124092347im_/http://www1.blogblog.com/rounders4/corners_main_bot.gif") no-repeat left bottom;
margin:15px 0 0;
padding:0 0 10px;
color:#e6ffa2;
font-size:97%;
line-height:1.5em;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
#main-wrap2 {
float:left;
width:100%;
background:url("https://web.archive.org/web/20141124092347im_/http://www1.blogblog.com/rounders4/corners_main_top.gif") no-repeat left top;
padding:10px 0 0;
}
#main {
background:url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/rails_main.gif") repeat-y left;
padding:0;
width:485px;
}
#sidebar-wrap {
width:240px;
float:right;
margin:15px 0 0;
font-size:97%;
line-height:1.5em;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
.main .widget {
margin-top: 0;
margin-right: 13px;
margin-bottom: 4px;
margin-left: 13px;
}
.main .Blog {
margin: 0;
}
/* Links
----------------------------------------------- */
a:link {
color: #ffff66;
}
a:visited {
color: #f3ffd1;
}
a:hover {
color: #f3ffd1;
}
a img {
border-width:0;
}
/* Blog Header
----------------------------------------------- */
#header-wrapper {
background: #476 url("https://web.archive.org/web/20141124092347im_/http://www2.blogblog.com/rounders4/corners_cap_top.gif") no-repeat left top;
margin-top:22px;
margin-right:0;
margin-bottom:0;
margin-left:0;
padding-top:8px;
padding-right:0;
padding-bottom:0;
padding-left:0;
color:#ffffff;
}
#header {
background:url("https://web.archive.org/web/20141124092347im_/http://www1.blogblog.com/rounders4/bg_hdr_bot.jpg") no-repeat left bottom;
padding:0 15px 8px;
}
#header h1 {
margin:0;
padding:10px 30px 5px;
line-height:1.2em;
font: normal bold 200% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
#header a,
#header a:visited {
text-decoration:none;
color: #ffffff;
}
#header .description {
margin:0;
padding:5px 30px 10px;
line-height:1.5em;
font: normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
/* Posts
----------------------------------------------- */
h2.date-header {
margin-top:0;
margin-right:28px;
margin-bottom:0;
margin-left:43px;
font-size:85%;
line-height:2em;
text-transform:uppercase;
letter-spacing:.2em;
color:#ccff44;
}
.post {
margin:.3em 0 25px;
padding:0 13px;
line-height:1.5em;
border:1px dotted #bbbbbb;
border-width:1px 0;
}
.post h3 {
margin:0;
background:url("https://web.archive.org/web/20141124092347im_/http://www2.blogblog.com/rounders4/icon_arrow.gif") no-repeat 10px .5em;
display:block;
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
padding-top:2px;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
color: #ffffff;
font: normal bold 135% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
.post h3 a, .post h3 a:visited {
text-decoration:none;
color: #ffffff;
}
.post h3 a:hover {
background-color: #bbbbbb;
color: #ffffff;
}
.post-body {
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
border-bottom-color:#446666;
padding-top:10px;
padding-right:14px;
padding-bottom:1px;
padding-left:29px;
}
html>body .post-body {
border-bottom-width:0;
}
.post-body {
margin:0 0 .75em;
}
.post-body blockquote {
line-height:1.3em;
}
.post-footer {
background: #577;
margin:0;
padding-top:2px;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
border:1px dotted #bbbbbb;
border-width:1px;
font-size:100%;
line-height:1.5em;
color: #acb;
}
/*
The first line of the post footer might only have floated text, so we need to give it a height.
The height comes from the post-footer line-height
*/
.post-footer-line-1 {
min-height:1.5em;
_height:1.5em;
}
.post-footer p {
margin: 0;
}
html>body .post-footer {
border-bottom-color:transparent;
}
.uncustomized-post-template .post-footer {
text-align: right;
}
.uncustomized-post-template .post-author,
.uncustomized-post-template .post-timestamp {
display: block;
float: left;
text-align:left;
margin-right: 4px;
}
.post-footer a {
color: #fff;
}
.post-footer a:hover {
color: #eee;
}
a.comment-link {
/* IE5.0/Win doesn't apply padding to inline elements,
so we hide these two declarations from it */
background/* */:/**/url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat left 45%;
padding-left:14px;
}
html>body a.comment-link {
/* Respecified, for IE5/Mac's benefit */
background:url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat left 45%;
padding-left:14px;
}
.post img, table.tr-caption-container {
margin-top:0;
margin-right:0;
margin-bottom:5px;
margin-left:0;
padding:4px;
border:1px solid #bbbbbb;
}
.tr-caption-container img {
border: none;
margin: 0;
padding: 0;
}
blockquote {
margin:.75em 0;
border:1px dotted #bbbbbb;
border-width:1px 0;
padding:5px 15px;
color: #ccff44;
}
.post blockquote p {
margin:.5em 0;
}
#blog-pager-newer-link {
float: left;
margin-left: 13px;
}
#blog-pager-older-link {
float: right;
margin-right: 13px;
}
#blog-pager {
text-align: center;
}
.feed-links {
clear: both;
line-height: 2.5em;
margin-left: 13px;
}
/* Comments
----------------------------------------------- */
#comments {
margin:-25px 13px 0;
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
padding-top:20px;
padding-right:0;
padding-bottom:15px;
padding-left:0;
}
#comments h4 {
margin:0 0 10px;
padding-top:0;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
border-bottom:1px dotted #bbbbbb;
font-size:120%;
line-height:1.4em;
color:#ffffff;
}
#comments-block {
margin-top:0;
margin-right:15px;
margin-bottom:0;
margin-left:9px;
}
.comment-author {
background:url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat 2px .3em;
margin:.5em 0;
padding-top:0;
padding-right:0;
padding-bottom:0;
padding-left:20px;
font-weight:bold;
}
.comment-body {
margin:0 0 1.25em;
padding-top:0;
padding-right:0;
padding-bottom:0;
padding-left:20px;
}
.comment-body p {
margin:0 0 .5em;
}
.comment-footer {
margin:0 0 .5em;
padding-top:0;
padding-right:0;
padding-bottom:.75em;
padding-left:20px;
}
.comment-footer a:link {
color: #ced;
}
.deleted-comment {
font-style:italic;
color:gray;
}
.comment-form {
padding-left:20px;
padding-right:5px;
}
#comments .comment-form h4 {
padding-left:0px;
}
/* Profile
----------------------------------------------- */
.profile-img {
float: left;
margin-top: 5px;
margin-right: 5px;
margin-bottom: 5px;
margin-left: 0;
border: 4px solid #ffffff;
}
.profile-datablock {
margin-top: 0;
margin-right: 15px;
margin-bottom: .5em;
margin-left: 0;
padding-top: 8px;
}
.profile-link {
background:url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/icon_profile_left.gif") no-repeat left .1em;
padding-left:15px;
font-weight:bold;
}
.profile-textblock {
clear: both;
margin: 0;
}
.sidebar .clear, .main .widget .clear {
clear: both;
}
#sidebartop-wrap {
background:#99bb55 url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/corners_prof_bot.gif") no-repeat left bottom;
margin:0px 0px 15px;
padding:0px 0px 10px;
color:#ffffff;
}
#sidebartop-wrap2 {
background:url("https://web.archive.org/web/20141124092347im_/http://www2.blogblog.com/rounders4/corners_prof_top.gif") no-repeat left top;
padding: 10px 0 0;
margin:0;
border-width:0;
}
#sidebartop h2 {
line-height:1.5em;
color:#ffffff;
border-bottom: 1px dotted #ffffff;
font: normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
margin-bottom: 0.5em;
}
#sidebartop a {
color: #ffffff;
}
#sidebartop a:hover {
color: #eeeeee;
}
#sidebartop a:visited {
color: #eeeeee;
}
/* Sidebar Boxes
----------------------------------------------- */
.sidebar .widget {
margin:.5em 13px 1.25em;
padding:0 0px;
}
.widget-content {
margin-top: 0.5em;
}
#sidebarbottom-wrap1 {
background: #ffffff url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/corners_side_top.gif") no-repeat left top;
margin:0 0 15px;
padding:10px 0 0;
color: #666666;
}
#sidebarbottom-wrap2 {
background:url("https://web.archive.org/web/20141124092347im_/http://www1.blogblog.com/rounders4/corners_side_bot.gif") no-repeat left bottom;
padding:0 0 8px;
}
#sidebar {
background:url("https://web.archive.org/web/20141124092347im_/http://www1.blogblog.com/rounders4/rails_side.gif") repeat-y;
}
#sidebar {
color: #666666;
}
#sidebar h2 {
color: #666666;
border-bottom: 1px dotted #666666;
margin-bottom: 0.5em;
}
#sidebar a {
color: #447755;
}
#sidebar a:hover,
#sidebar a:visited {
color: #779988;
}
.sidebar h2 {
margin:0;
padding:0 0 .2em;
line-height:1.5em;
font:normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
.sidebar ul {
list-style:none;
margin:0 0 1.25em;
padding:0;
}
.sidebar ul li {
background:url("https://web.archive.org/web/20141124092347im_/http://www2.blogblog.com/rounders4/icon_arrow_sm.gif") no-repeat 2px .25em;
margin:0;
padding-top:0;
padding-right:0;
padding-bottom:3px;
padding-left:16px;
margin-bottom:3px;
border-bottom:1px dotted #bbbbbb;
line-height:1.4em;
}
.sidebar p {
margin:0 0 .6em;
}
/* Footer
----------------------------------------------- */
#footer-wrap1 {
clear:both;
margin:0 0 10px;
padding:15px 0 0;
}
#footer-wrap2 {
background:#447766 url("https://web.archive.org/web/20141124092347im_/http://www2.blogblog.com/rounders4/corners_cap_top.gif") no-repeat left top;
color:#ffffff;
}
#footer {
background:url("https://web.archive.org/web/20141124092347im_/http://www.blogblog.com/rounders4/corners_cap_bot.gif") no-repeat left bottom;
padding:8px 15px;
}
#footer hr {display:none;}
#footer p {margin:0;}
#footer a {color:#ffffff;}
#footer .widget-content {
margin:0;
}
/** Page structure tweaks for layout editor wireframe */
body#layout #main-wrap1,
body#layout #sidebar-wrap,
body#layout #header-wrapper {
margin-top: 0;
}
body#layout #header, body#layout #header-wrapper,
body#layout #outer-wrapper {
margin-left:0,
margin-right: 0;
padding: 0;
}
body#layout #outer-wrapper {
width: 730px;
}
body#layout #footer-wrap1 {
padding-top: 0;
}

-->
  </style>
 </head>
 <body>
  <div class="navbar section" id="navbar">
   <div class="widget Navbar" id="Navbar1">
    <div id="navbar-iframe-container">
    </div>
   </div>
  </div>
  <div id="outer-wrapper">
   <div id="header-wrapper">
    <div class="header section" id="header">
     <div class="widget Header" id="Header1">
      <div id="header-inner">
       <div class="titlewrapper">
        <h1 class="title">
         <a href="../index.html">
          Ray Woodcock's Latest
         </a>
        </h1>
       </div>
       <div class="descriptionwrapper">
        <p class="description">
         <span>
         </span>
        </p>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div id="main-wrap1">
    <div id="main-wrap2">
     <div class="main section" id="main">
      <div class="widget Blog" id="Blog1">
       <div class="blog-posts">
        <!-- google_ad_section_start -->
        <h2 class="date-header">
         Tuesday, February 14, 2012
        </h2>
        <div class="post">
         <a name="6329913800390976589">
         </a>
         <h3 class="post-title">
          <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/02/batch-merging-many-scattered-jpgs-into_14.html">
           Batch Merging Many Scattered JPGs into Many Multipage PDFs - Clarified
          </a>
         </h3>
         <div class="post-header-line-1">
         </div>
         <div class="post-body">
          <p>
           I had
           <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/01/batch-merging-many-scattered-jpgs-into.html" target="_blank">
            recently streamlined
           </a>
           a spreadsheet-oriented technique for working up file names and batch commands to merge multiple JPGs into single- or multi-page PDFs.  I had yet another task calling for that process.  This post presents the same steps as in that previous writeup, but in clearer and more organized terms.  The various steps are described in different terms in
           <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/01/batch-merging-many-scattered-jpgs-into.html" target="_blank">
            the previous post
           </a>
           and in its much more
           <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/01/batch-merging-many-scattered-jpgs-into.html" target="_blank">
            convoluted predecessor
           </a>
           .  Note that the simplification of steps here yields a longer explanation.
           <br/>
           <br/>
           <strong>
            Generate the Input PDF Filenames
           </strong>
           <br/>
           <br/>
           In this discussion, the project had already been brought to the point where there was a spreadsheet containing the names of JPGs to be converted to PDF.  (A list of such files could come from a command like DIR D:\*.jpg /s /a-d /b &gt; JPGLIST.TXT.)  In that spreadsheet, row 1 was reserved for column names (e.g., "Original Filename," "Path").  The name of the first file to be converted appeared in cell A2 (e.g., "Test File.jpg"), and the others appeared below it in column A.
           <br/>
           <br/>
           Column B was used to calculate the endpoint of the path (e.g., "D:\Folder 1\Test File.jpg").  This calculation required or at least benefited from the use of a REVERSE function.  The REVERSE function was created by inserting the following text into a module:
           <br/>
           <blockquote>
            Function Reverse(Text As String) As String
            <br/>
            Dim i As Integer
            <br/>
            Dim StrNew As String
            <br/>
            Dim StrOld As String
            <br/>
            StrOld = Trim(Text)
            <br/>
            For i = 1 To Len(StrOld)
            <br/>
            StrNew = Mid(StrOld, i, 1) &amp; StrNew
            <br/>
            Next i
            <br/>
            Reverse = StrNew
            <br/>
            End Function
           </blockquote>
           To create the module, I closed all Excel files other than the one being worked on.  I went into Tools &gt; Macro &gt; Visual Basic Editor &gt; Insert &gt; Module.  I pasted the text there.  I went to to File &gt; Close and Return to Microsoft Excel.  The formulas in the next several cells were then as follows:
           <br/>
           <blockquote>
            B2:  =LEN(A2)-FIND("\",REVERSE(A2))+1
            <br/>
            C2:  =LEFT(A2,B2)
            <br/>
            D2:  =MID(A2,B2+1,LEN(A2))
           </blockquote>
           I was reconstructing some of these steps after the fact; hopefully I was not misstating anything or leaving anything out of this description.  I focused on the formulas for row 2 because, when I was done filling out row 2, it would be easy to copy all of its formulas at once to fill the spreadsheet, so that the same formulas would be applied to the filenames in rows 3, 4, 5 et seq.
           <br/>
           <br/>
           The next step was to identify which files I wanted to convert.  I was able to use the spreadsheet to help in this process.  For example, I had files with names like these:
           <br/>
           <blockquote>
            Test File page 01.jpg
            <br/>
            Test File page 02.jpg
           </blockquote>
           I could determine that these belonged together by using a column that showed these filenames without the ending X characters.  That column would use a command like =RIGHT(D2,$E$1), where I would put a number in E1.  The number I used in this example was 12, because I would have to eliminate 12 characters from the right end of "Test File page 01.jpg" to get the name that I wanted to give to the new PDF, which would be simply "Test File."  I manually entered 12 in cell E2.  I filtered the rows so that the ones with numbers in column E would not show, so as to reduce clutter.  I repeated this process until each row had a number in column E, indicating how many characters I had to trim from the right end of the filename to get a common stem.  Then cell F2 contained =LEFT(D2,LEN(D2)-E2), to produce the stem filename.  So, for example, if there were two pages that had to go into Test File.pdf, then (assuming I had sorted my spreadsheet correctly), the contents of cells F2 et seq. would look like this:
           <br/>
           <blockquote>
            F2:  Test File
            <br/>
            F3:  Test File
            <br/>
            F4:  Another File
           </blockquote>
           and so forth, continuing down the list, so that each JPG would be assigned to a stem filename.  I discovered at this point that I had brought over a bunch of JPGs that did not belong in a multipage PDF, or at least I could not be sure of it.  I put these back where they came from, and thus had a smaller set of files to work on.
           <br/>
           <br/>
           Now I could sort the spreadsheet to insure that the JPGs I wanted to merge into a specific PDF would be next to each other.  Once I had the files sorted into the desired order, I used column G as an Index column, numbering each row in that order.  This column would be useful to restore the desired order if I resorted the spreadsheet for some reason, and it would also provide the key ingredient in the unique filename that I was about to calculate.  (To generate an index number, I used either a +1 formula, incrementing the number in the preceding row by 1, followed by an Edit &gt; Copy, Edit &gt; Paste Special &gt; Values sequence to convert those formulas to fixed numbers that would not be affected by resorting the spreadsheet; or, easier, I entered 1 in the first row, 2 in the second row, and then highlighted the cells to be filled and used Edit &gt; Insert &gt; Series to add the sequential numbers.)  Then I used columns G through I to calculate a simple, unique filename and produce a renaming command:
           <br/>
           <blockquote>
            G2:  unique Index number
            <br/>
            H2:  ="Input_"&amp;REPT("0",4-LEN(G2))&amp;G2&amp;".pdf"
            <br/>
            I2:  ="ren "&amp;CHAR(34)&amp;A2&amp;CHAR(34)&amp;" "&amp;H2
           </blockquote>
           Cell H2 would produce the file name of "Input_0001.pdf."  (More or fewer digits could be appropriate, depending on the number of files involved.)  This name worked for me because a search of my files verified that my computer contained no other files whose names began with Input_.  Otherwise, a different name might have been advisable.  Cell I2 would produce a command that would rename Test File page 01.jpg to be Input_0001.pdf.  (Of course, this wasn't a conversion.  IrfanView would be doing that.  This was just a translation of file names, to make subsequent steps easier.)
           <br/>
           <br/>
           Then, as usual, I copied these commands from row 2 down to fill the remaining rows of the spreadsheet.  Next, I copied all of the commands from column I into Notepad, saved that file with a .bat extension (e.g., "Renamer.bat"), and ran it in Windows Explorer.  That renamed all of the JPGs that I hoped to merge into multipage PDFs.  (Obviously, I had a backup.)
           <br/>
           <br/>
           Now I would use column J for commands to move all those JPGs to a single folder.  (I did the renaming before the moving in case I had two separate sets of incoming JPGs with the same name, such as D:\Folder A\Test File page 01.jpg and E:\Folder R\Test File page 01.jpg.)  In my actual example, the files were all moved to V:\Workspace, so my command in cell J2 looked like this:
           <br/>
           <blockquote>
            J2:  ="move /-y "&amp;CHAR(34)&amp;C2&amp;H2&amp;CHAR(34)&amp;" V:\Workspace"
           </blockquote>
           I combined the commands in column J into another batch file, Mover.bat, and used it to move all those renamed JPGs to V:\Workspace.  Now that they were together, I could use IrfanView's File &gt; Batch Conversion/Rename option to convert all those JPGs to single-page PDFs.  I output those PDFs to V:\Workspace and then removed the JPGs from V:\Workspace to V:\Workspace\Original JPGs, where they would probably not be needed further.
           <br/>
           <br/>
           <strong>
            Generate the File Value Lines
           </strong>
           <br/>
           <br/>
           So now I had files starting with Input_0001.pdf in V:\Workspace.  The project now was to merge those single-page input PDFs into multipage output PDFs.  In column K, I entered a number indicating where each input PDF should go.  As I could see from column F (above), the files that used to be called Test File page 01.jpg and Test File page 02.jpg, which had now been converted to uniquely named single-page PDFs, were both going to end up in Output_0001.pdf, so both of those had the number 1 in column K.   I needed to pad out that number so that the resulting filename would sort correctly.  So the next formulas were as follows:
           <br/>
           <blockquote>
            K2:  =LEFT(H2,11)&amp;"pdf"
            <br/>
            L2:   =REPT("0",4-LEN(K2))&amp;K2
           </blockquote>
           But I wasn't ready, yet, to generate the ultimate Output PDF files.  I needed to make sure that PDFsam (below) would have all the instructions needed to insert multiple single-page PDFs into one Output PDF.  Those instructions would come from lines of XML code, one line per input PDF.  The lines of XML code would be combined into a smaller number of FileValueLines files.  In my example, the instruction lines for the erstwhile Test File page 01.jpg and Test File page 02.jpg files (now called Input_0001.pdf and Input_0002.pdf) would both go into a single FileValueLines file.  A FileValueLines file could contain any number of lines of XML code; it just depended on how many single-page PDFs were going to be combined into it.  What I needed, then, was the command that would shovel those XML code lines into the appropriate FileValueLines files.  The next formulas in my spreadsheet looked like this:
           <br/>
           <blockquote>
            M2:  ="FileValueLines_"&amp;L2
            <br/>
            N2:  ="echo ^&lt;file value="&amp;CHAR(34)&amp;"V:\Workspace\PDF\"&amp;H2&amp;CHAR(34)&amp;" /^&gt; &gt;&gt; "&amp;M2
           </blockquote>
           and cell N2 produced this command:
           <br/>
           <blockquote>
            echo ^&lt;file value="V:\Workspace\PDF\Input_0002.pdf" /^&gt; &gt;&gt; FileValueLines_0001
           </blockquote>
           Note that this command assumed that the PDFs created by IrfanView were in a folder called V:\Workspace\PDF.  I filled the lower rows of the spreadsheet with these formulas and copied the commands in column N into a new Notepad file called _ValueMaker.bat.  I ran _ValueMaker.bat in V:\Workspace.  It produced 545 FileValueLines files in V:\Workspace, as expected.  (I added an underscore before the file's name so that it would appear near the top of the potentially cluttered list of files in V:\Workspace.)
           <br/>
           <br/>
           This was a point of transition.  Until now, I had been working with a total of 3,894 spreadsheet rows, one for each of the 3,894 JPGs that I wanted to combine into multipage PDFs.  Each of those 3,894 JPGs (converted into single-page PDFs called Input_0001.pdf et seq.) was represented in exactly one File Value line.  Those 3,894 File Value lines were now contained within a total of 545 FileValueLine_ files.  In other words, we were transitioning from a focus on 3,894 individual JPGs to a focus on 545 multipage PDFs.
           <br/>
           <br/>
           <strong>
            Building the XML Files
           </strong>
           <br/>
           <br/>
           The 545 FileValueLines files (FileValueLines_0001 and so forth) needed more lines before they would function.  To add those lines, I needed a new spreadsheet.  I started this one with a list of the FileValueLines files I had just created.  (A command like "dir FileValueLines* /b /a-d &gt; _FVLlist.txt" would produce that list.)  In other words, column A contained the list of the new FileValueLines files.  Next, I calculated the name of the resulting XML file, and then wrote the formula that would create those XML files:
           <br/>
           <blockquote>
            B2:  =RIGHT(A2,4)
            <br/>
            C2:  ="XMLfile_"&amp;B2&amp;".xml"
            <br/>
            D2:  ="copy /b _Header.txt+"&amp;A2&amp;"+_Tailer.txt "&amp;C2
           </blockquote>
           That formula in D2 produced the command that I would need to create the complete XML files:  "copy /b _Header.txt+FileValueLines_0001+_Tailer.txt XMLfile_0001.xml."  This command called for me to create just one _Header.txt and one _Tailer.txt file that would be added to the start and end of each of my XML files.  The _Header.txt file read as follows:
           <br/>
           <blockquote>
            &lt;?xml version="1.0" encoding="UTF-8"?&gt;
            <br/>
            &lt;filelist&gt;
           </blockquote>
           I saved those two lines in a new _Header.txt file.  It was important to make sure the file ended on a blank line.  In other words, if I moved my cursor down to the end of _Header.txt, it needed to be on the line below &lt;filelist&gt;, not at the end of the line containing &lt;filelist&gt;.  The same was true for _Tailer.txt, which contained this line:
           <br/>
           <blockquote>
            &lt;/filelist&gt;
           </blockquote>
           Once _Header.txt and _Tailer.txt existed, I could run the commands contained in column D.  I copied those 545 commands into a new batch file called _Builder.bat and ran it.  That gave me 545 XML files, starting with XMLfile_0001.xml.  Again, V:\Workspace was filling up, so I moved the no longer needed FileValueLines files to their own archival subfolder.
           <br/>
           <br/>
           <strong>
            Generating the PDFsam Commands
           </strong>
           <br/>
           <br/>
           At this point, I would use a batch file to generate batch files.  This would call for the same kind of process as above:  a header text file (but no tailer) containing lines that would be standard in all of these batch files, combined with another text file containing unique commands.  In this new _HeaderB.txt file, I placed these lines:
           <br/>
           <blockquote>
            @echo off
            <br/>
            <br/>
            set JAVA=%JAVA_HOME%\BIN\JAVA
            <br/>
            <br/>
            set JAVA_OPTS=-Xmx256m  -Dlog4j.configuration=console-log4j.xml
            <br/>
            <br/>
            set CONSOLE_JAR="C:\Program Files  (x86)\pdfsam\lib\pdfsam-console-2.3.1e.jar"
            <br/>
            <br/>
            @echo on
           </blockquote>
           Apparently these first lines set up a few essential Java variables.  (In case of difficulty here, as elsewhere, see
           <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/01/batch-merging-many-scattered-jpgs-into.html" target="_blank">
            the preceding post
           </a>
           .)  The second part of the batch file -- the unique command -- would tell PDFsam (below) what to do.  The command looked like this:
           <br/>
           <blockquote>
            E2:  ="echo %%JAVA%% %%JAVA_OPTS%% -jar %%CONSOLE_JAR%% -l V:\Workspace\"&amp;C2&amp;" -o V:\Workspace\Merged\Output_"&amp;B2&amp;".pdf concat &gt;&gt; Command_"&amp;B2&amp;".txt"
           </blockquote>
           Basically, this would produce a command that said, "Write a command that will create Output_*.pdf, and put that command in a file called Command_*.txt."  In other words, that spreadsheet formula in cell E2 produced a command that looked like this:
           <br/>
           <blockquote>
            echo %%JAVA%% %%JAVA_OPTS%% -jar %%CONSOLE_JAR%% -l V:\Workspace\XMLfile_0001.xml -o V:\Workspace\Merged\Output_0001.pdf concat &gt;&gt; Command_0001.txt
           </blockquote>
           Spreadsheet column E gave me 545 variations on that command.  I copied them all and ran them in a new batch file called _Texter.bat.  The resulting 545 Command_*.txt files would have to share V:\Workspace with my preexisting XMLfile_*.xml files; both would be needed shortly.
           <br/>
           <br/>
           Now it was time to combine _HeaderB.txt and Command_*.txt into a batch file that would run PDFsam and produce an multipage Output PDF.  This was easy enough:
           <br/>
           <blockquote>
            F2:  ="copy /b _HeaderB.txt+"&amp;RIGHT(E2,16)&amp;" Ready_"&amp;B2&amp;".bat"
           </blockquote>
           The 545 versions of that command, run via _Commander.bat, created 545 Ready_*.bat files, each containing the header information from _HeaderB.txt plus the single command line from Command_*.txt.  Now I was done with the Command_*.txt files, and could archive them.
           <br/>
           <br/>
           <strong>
            Final Run:  Creating the Merged Output PDFs
           </strong>
           <br/>
           <br/>
           If I double-clicked on one of those Ready batch files, it would run and produce a final merged Output.pdf.  But I wanted to run them all at once.  So, back to the spreadsheet:
           <br/>
           <blockquote>
            G2:  ="call "&amp;RIGHT(F2,14)&amp;" &gt;&gt; _Errorlog.txt"
           </blockquote>
           That produced "call Ready_0001.bat &gt;&gt; _Errorlog.txt."  I copied the 545 CALL commands from column G into a file called _Runner.bat and -- you guessed it -- I ran it.  It took a few minutes, but it produced 542 merged PDFs.  Not 545.  I searched _Errorlog.txt for occurrences of "Error."  Sure enough, three occurrences.  In each case, the error was the same:  "Input_0838.pdf (and Input_0947.pdf, and Input_1090.pdf) not found as file or resource."  Apparenly PDFsam had not gone ahead to create the Output PDFs anyway, without the offending Input file.  I checked and, indeed, those three files were not included among my input.  I was not sure what happened to them.  They appeared to have disappeared during this process.  I made a note to retrieve them from backup.
           <br/>
           <br/>
           Otherwise, though, the process seemed to have succeeded.  Spot checks indicated that I had working multipage PDFs.  Now it was time to rename them to be something other than Output_0001.pdf etc.  I went back to my first spreadsheet, saved it, and went to work on a temporary copy of it.  Specifically, I converted all of its formulas to numerical values.  (In Excel 2003, this involved going to the top left corner, selecting the whole spreadsheet, and using the Edit &gt; Copy, Edit &gt; Paste Special Values combination.)  With that done, I was free to delete and rearrange columns as needed, without having cells recalculate in undesirable ways.  I kept only columns C (showing the original source folder), F (showing the name I had chosen for the combined output PDF), and L (showing the output file number).  I rearranged those columns in reverse order, so that the output file number column could function as a rather redundant index.  I went to the second spreadsheet and, working likewise on a copy of that, deleted all columns except column B, containing the output file number.  In an adjacent column, I used VLOOKUP to look up the filenames, from the other spreadsheet, to which these Output_0001.pdf etc. files should be renamed.
           <br/>
           <br/>
           Through such steps, I renamed these files.  Yet something went wrong.  Due to distraction and time delay during the last stages of this process, somehow the renaming did not bring me back to a coherent set of files.  Spot checks indicated that the ones that did rename were renamed correctly.  That is, if a file wound up being renamed as Letter to Joe, it did seem to be exactly that.  But I was left with 60 files -- more than 10% of the total -- that did not rename at all.  There may have been a way to fix them through the spreadsheet, but I had run out of time for the project.  Under the circumstances, I defaulted to putting those files aside into a separate folder, pending a future manual renaming effort.
           <br/>
           <br/>
           The process described in this post did seem to work.  But its numerous steps continued to hold the threat of something going wrong, somewhere along the line, and being difficult to retrace.  This did not seem to be nearly the last word on batch merging scattered JPGs into multipage PDFs.
          </p>
          <div style="clear: both;">
          </div>
         </div>
         <div class="post-footer">
          <p class="post-footer-line post-footer-line-1">
           <span class="post-author">
            Posted by
raywood
           </span>
           <span class="post-timestamp">
           </span>
           <span class="post-comment-link">
           </span>
           <span class="post-icons">
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/post-edit.g?blogID=3377753575825500498&amp;postID=6329913800390976589&amp;from=pencil" title="Edit Post">
              <span class="quick-edit-icon">
              </span>
             </a>
            </span>
           </span>
          </p>
          <p class="post-footer-line post-footer-line-2">
           <span class="post-labels">
            Labels:
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/batch" rel="tag">
             batch
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/combine" rel="tag">
             combine
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/concatenate" rel="tag">
             concatenate
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/jpg" rel="tag">
             jpg
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/merge" rel="tag">
             merge
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/pdf" rel="tag">
             pdf
            </a>
            ,
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/search/label/spreadsheet" rel="tag">
             spreadsheet
            </a>
           </span>
          </p>
          <p class="post-footer-line post-footer-line-3">
          </p>
         </div>
        </div>
        <div class="comments" id="comments">
         <a name="comments">
         </a>
         <h4>
          4
comments:
         </h4>
         <dl id="comments-block">
          <dt class="comment-author" id="comment-6999305268948536734">
           <a name="comment-6999305268948536734">
           </a>
           <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/profile/05411560299249509335" rel="nofollow">
            raywood
           </a>
          </dt>
          <dd class="comment-body">
           <p>
            As it turns out, the problem with those 60 files was that I made the mistake of renaming before moving, instead of afterwards.  There were duplicate filenames, so the batch file didn't rename until I moved some of the renamed files out of that folder.
           </p>
          </dd>
          <dd class="comment-footer">
           <span class="comment-timestamp">
            <a href="#comment-6999305268948536734" title="comment permalink">
             February 15, 2012 at 1:42 PM
            </a>
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/delete-comment.g?blogID=3377753575825500498&amp;postID=6999305268948536734" title="Delete Comment">
              <span class="delete-comment-icon">
              </span>
             </a>
            </span>
           </span>
          </dd>
          <dt class="comment-author" id="comment-2445441419851775532">
           <a name="comment-2445441419851775532">
           </a>
           <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/profile/05411560299249509335" rel="nofollow">
            raywood
           </a>
          </dt>
          <dd class="comment-body">
           <p>
            It looked like
            <a href="https://web.archive.org/web/20141124092347/http://www.karenware.com/powertools/ptdirprn.asp" rel="nofollow">
             Karen's Directory Printer
            </a>
            would provide an alternative to DIR for some purposes.
           </p>
          </dd>
          <dd class="comment-footer">
           <span class="comment-timestamp">
            <a href="#comment-2445441419851775532" title="comment permalink">
             March 11, 2012 at 7:19 PM
            </a>
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/delete-comment.g?blogID=3377753575825500498&amp;postID=2445441419851775532" title="Delete Comment">
              <span class="delete-comment-icon">
              </span>
             </a>
            </span>
           </span>
          </dd>
          <dt class="comment-author" id="comment-2660347414648181257">
           <a name="comment-2660347414648181257">
           </a>
           <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/profile/05411560299249509335" rel="nofollow">
            raywood
           </a>
          </dt>
          <dd class="comment-body">
           <p>
            As described near the bottom of
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/06/finding-and-cleaning-up-emls-that.html" rel="nofollow">
             another post
            </a>
            , I later found pdftk much easier to use than PDFsam.
           </p>
          </dd>
          <dd class="comment-footer">
           <span class="comment-timestamp">
            <a href="#comment-2660347414648181257" title="comment permalink">
             June 22, 2012 at 1:27 PM
            </a>
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/delete-comment.g?blogID=3377753575825500498&amp;postID=2660347414648181257" title="Delete Comment">
              <span class="delete-comment-icon">
              </span>
             </a>
            </span>
           </span>
          </dd>
          <dt class="comment-author" id="comment-9183161083884212668">
           <a name="comment-9183161083884212668">
           </a>
           <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/profile/05411560299249509335" rel="nofollow">
            raywood
           </a>
          </dt>
          <dd class="comment-body">
           <p>
            <a href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/2012/05/batch-converting-multiple-word-doc.html" rel="nofollow">
             A later post
            </a>
            pulls together some of these remarks in a more summary fashion.
           </p>
          </dd>
          <dd class="comment-footer">
           <span class="comment-timestamp">
            <a href="#comment-9183161083884212668" title="comment permalink">
             January 5, 2013 at 2:08 PM
            </a>
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/delete-comment.g?blogID=3377753575825500498&amp;postID=9183161083884212668" title="Delete Comment">
              <span class="delete-comment-icon">
              </span>
             </a>
            </span>
           </span>
          </dd>
         </dl>
         <p class="comment-footer">
          <a href="https://web.archive.org/web/20141124092347/http://www.blogger.com/comment.g?blogID=3377753575825500498&amp;postID=6329913800390976589" onclick="">
           Post a Comment
          </a>
         </p>
         <div id="backlinks-container">
          <div id="Blog1_backlinks-container">
          </div>
         </div>
        </div>
        <!-- google_ad_section_end -->
       </div>
       <div class="clear">
       </div>
       <div class="post-feeds">
        <div class="feed-links">
         Subscribe to:
         <a class="feed-link" href="https://web.archive.org/web/20141124092347/http://raywoodcockslatest.blogspot.com/feeds/6329913800390976589/comments/default" target="_blank" type="application/atom+xml">
          Post Comments (Atom)
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
<!--
     FILE ARCHIVED ON 09:23:47 Nov 24, 2014 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 23:56:18 Dec 27, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.814
  exclusion.robots: 0.085
  exclusion.robots.policy: 0.069
  esindex: 0.016
  cdx.remote: 11.912
  LoadShardBlock: 81.263 (3)
  PetaboxLoader3.datanode: 113.414 (4)
  load_resource: 87.462
  PetaboxLoader3.resolve: 30.883
-->
