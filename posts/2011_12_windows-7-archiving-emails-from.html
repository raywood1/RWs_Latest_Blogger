<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.google.com/2005/gml/b" xmlns:data="http://www.google.com/2005/gml/data" xmlns:expr="http://www.google.com/2005/gml/expr">
 <head>
  <link href="https://web-static.archive.org/_static/css/banner-styles.css?v=1utQkbB3" rel="stylesheet" type="text/css"/>
  <link href="https://web-static.archive.org/_static/css/iconochive.css?v=3PDvdIFv" rel="stylesheet" type="text/css"/>
  <!-- End Wayback Rewrite JS Include -->
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="blogger" name="generator"/>
  <link href="https://web.archive.org/web/20140529005509im_/http://raywoodcockslatest.blogspot.com/favicon.ico" rel="icon" type="image/x-icon"/>
  <link href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2011/12/windows-7-archiving-emails-from.html" rel="canonical"/>
  <link href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/feeds/posts/default" rel="alternate" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <link href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/feeds/posts/default?alt=rss" rel="alternate" title="Ray Woodcock's Latest - RSS" type="application/rss+xml"/>
  <link href="http://www.blogger.com/feeds/3377753575825500498/posts/default" rel="service.post" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <link href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/feeds/2494756520523218614/comments/default" rel="alternate" title="Ray Woodcock's Latest - Atom" type="application/atom+xml"/>
  <!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
  <title>
   Ray Woodcock's Latest: Converting Email (EML) Files to PDF - Another (Partial) Try
  </title>
  <link href="https://web.archive.org/web/20140529005509cs_/https://www.blogger.com/static/v1/widgets/3841957138-widget_css_bundle.css" rel="stylesheet" type="text/css"/>
  <link href="https://web.archive.org/web/20140529005509cs_/https://www.blogger.com/dyn-css/authorization.css?targetBlogID=3377753575825500498&amp;zx=9bb9c619-69a3-4f38-bb00-36771e1d78df" rel="stylesheet" type="text/css"/>
  <style id="page-skin-1" type="text/css">
   <!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Rounders 4
Date:     27 Feb 2004
Updated by: Blogger Team
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="mainBgColor" description="Main Background Color"
type="color" default="#466">
<Variable name="mainTextColor" description="Text Color" type="color"
default="#ced">
<Variable name="postTitleColor" description="Post Title Color" type="color"
default="#fff">
<Variable name="dateHeaderColor" description="Date Header Color"
type="color" default="#cf4">
<Variable name="borderColor" description="Post Border Color" type="color"
default="#bbb">
<Variable name="mainLinkColor" description="Link Color" type="color"
default="#fff">
<Variable name="mainVisitedLinkColor" description="Visited Link Color"
type="color" default="#fff">
<Variable name="titleTextColor" description="Blog Title Color"
type="color" default="#fff">
<Variable name="topSidebarHeaderColor"
description="Top Sidebar Title Color"
type="color" default="#fff">
<Variable name="topSidebarBgColor"
description="Top Sidebar Background Color"
type="color" default="#9b5">
<Variable name="topSidebarTextColor" description="Top Sidebar Text Color"
type="color" default="#fff">
<Variable name="topSidebarLinkColor" description="Top Sidebar Link Color"
type="color" default="#fff">
<Variable name="topSidebarVisitedLinkColor"
description="Top Sidebar Visited Link Color"
type="color" default="#eee">
<Variable name="bottomSidebarBgColor"
description="Bottom Sidebar Background Color"
type="color" default="#fff">
<Variable name="bottomSidebarTextColor"
description="Bottom Sidebar Text Color"
type="color" default="#666">
<Variable name="bottomSidebarLinkColor"
description="Bottom Sidebar Link Color"
type="color" default="#475">
<Variable name="bottomSidebarVisitedLinkColor"
description="Bottom Sidebar Visited Link Color"
type="color" default="#798">
<Variable name="bodyFont" description="Text Font" type="font"
default="normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="pageTitleFont" description="Blog Title Font" type="font"
default="normal bold 200% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="descriptionFont" description="Description Font" type="font"
default="normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="headerFont" description="Sidebar Title Font" type="font"
default="normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="postTitleFont" description="Post Title Font" type="font"
default="normal bold 135% 'Trebuchet MS',Verdana,Arial,Sans-serif">
<Variable name="startSide" description="Start side in blog language"
type="automatic" default="left">
<Variable name="endSide" description="End side in blog language"
type="automatic" default="right">
*/
body {
background:#bca;
margin:0;
text-align:center;
line-height: 1.5em;
font: x-small Trebuchet MS, Verdana, Arial, Sans-serif;
color:#e6ffa2;
font-size/* */:/**/small;
font-size: /**/small;
}
/* Page Structure
----------------------------------------------- */
/* The images which help create rounded corners depend on the
following widths and measurements. If you want to change
these measurements, the images will also need to change.
*/
#outer-wrapper {
width:740px;
margin:0 auto;
text-align:left;
font: normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
#main-wrap1 {
width:485px;
float:left;
background:#446666 url("https://web.archive.org/web/20140529005509im_/http://www1.blogblog.com/rounders4/corners_main_bot.gif") no-repeat left bottom;
margin:15px 0 0;
padding:0 0 10px;
color:#e6ffa2;
font-size:97%;
line-height:1.5em;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
#main-wrap2 {
float:left;
width:100%;
background:url("https://web.archive.org/web/20140529005509im_/http://www1.blogblog.com/rounders4/corners_main_top.gif") no-repeat left top;
padding:10px 0 0;
}
#main {
background:url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/rails_main.gif") repeat-y left;
padding:0;
width:485px;
}
#sidebar-wrap {
width:240px;
float:right;
margin:15px 0 0;
font-size:97%;
line-height:1.5em;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
.main .widget {
margin-top: 0;
margin-right: 13px;
margin-bottom: 4px;
margin-left: 13px;
}
.main .Blog {
margin: 0;
}
/* Links
----------------------------------------------- */
a:link {
color: #ffff66;
}
a:visited {
color: #f3ffd1;
}
a:hover {
color: #f3ffd1;
}
a img {
border-width:0;
}
/* Blog Header
----------------------------------------------- */
#header-wrapper {
background: #476 url("https://web.archive.org/web/20140529005509im_/http://www2.blogblog.com/rounders4/corners_cap_top.gif") no-repeat left top;
margin-top:22px;
margin-right:0;
margin-bottom:0;
margin-left:0;
padding-top:8px;
padding-right:0;
padding-bottom:0;
padding-left:0;
color:#ffffff;
}
#header {
background:url("https://web.archive.org/web/20140529005509im_/http://www1.blogblog.com/rounders4/bg_hdr_bot.jpg") no-repeat left bottom;
padding:0 15px 8px;
}
#header h1 {
margin:0;
padding:10px 30px 5px;
line-height:1.2em;
font: normal bold 200% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
#header a,
#header a:visited {
text-decoration:none;
color: #ffffff;
}
#header .description {
margin:0;
padding:5px 30px 10px;
line-height:1.5em;
font: normal normal 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
/* Posts
----------------------------------------------- */
h2.date-header {
margin-top:0;
margin-right:28px;
margin-bottom:0;
margin-left:43px;
font-size:85%;
line-height:2em;
text-transform:uppercase;
letter-spacing:.2em;
color:#ccff44;
}
.post {
margin:.3em 0 25px;
padding:0 13px;
line-height:1.5em;
border:1px dotted #bbbbbb;
border-width:1px 0;
}
.post h3 {
margin:0;
background:url("https://web.archive.org/web/20140529005509im_/http://www2.blogblog.com/rounders4/icon_arrow.gif") no-repeat 10px .5em;
display:block;
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
padding-top:2px;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
color: #ffffff;
font: normal bold 135% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
.post h3 a, .post h3 a:visited {
text-decoration:none;
color: #ffffff;
}
.post h3 a:hover {
background-color: #bbbbbb;
color: #ffffff;
}
.post-body {
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
border-bottom-color:#446666;
padding-top:10px;
padding-right:14px;
padding-bottom:1px;
padding-left:29px;
}
html>body .post-body {
border-bottom-width:0;
}
.post-body {
margin:0 0 .75em;
}
.post-body blockquote {
line-height:1.3em;
}
.post-footer {
background: #577;
margin:0;
padding-top:2px;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
border:1px dotted #bbbbbb;
border-width:1px;
font-size:100%;
line-height:1.5em;
color: #acb;
}
/*
The first line of the post footer might only have floated text, so we need to give it a height.
The height comes from the post-footer line-height
*/
.post-footer-line-1 {
min-height:1.5em;
_height:1.5em;
}
.post-footer p {
margin: 0;
}
html>body .post-footer {
border-bottom-color:transparent;
}
.uncustomized-post-template .post-footer {
text-align: right;
}
.uncustomized-post-template .post-author,
.uncustomized-post-template .post-timestamp {
display: block;
float: left;
text-align:left;
margin-right: 4px;
}
.post-footer a {
color: #fff;
}
.post-footer a:hover {
color: #eee;
}
a.comment-link {
/* IE5.0/Win doesn't apply padding to inline elements,
so we hide these two declarations from it */
background/* */:/**/url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat left 45%;
padding-left:14px;
}
html>body a.comment-link {
/* Respecified, for IE5/Mac's benefit */
background:url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat left 45%;
padding-left:14px;
}
.post img, table.tr-caption-container {
margin-top:0;
margin-right:0;
margin-bottom:5px;
margin-left:0;
padding:4px;
border:1px solid #bbbbbb;
}
.tr-caption-container img {
border: none;
margin: 0;
padding: 0;
}
blockquote {
margin:.75em 0;
border:1px dotted #bbbbbb;
border-width:1px 0;
padding:5px 15px;
color: #ccff44;
}
.post blockquote p {
margin:.5em 0;
}
#blog-pager-newer-link {
float: left;
margin-left: 13px;
}
#blog-pager-older-link {
float: right;
margin-right: 13px;
}
#blog-pager {
text-align: center;
}
.feed-links {
clear: both;
line-height: 2.5em;
margin-left: 13px;
}
/* Comments
----------------------------------------------- */
#comments {
margin:-25px 13px 0;
border:1px dotted #bbbbbb;
border-width:0 1px 1px;
padding-top:20px;
padding-right:0;
padding-bottom:15px;
padding-left:0;
}
#comments h4 {
margin:0 0 10px;
padding-top:0;
padding-right:14px;
padding-bottom:2px;
padding-left:29px;
border-bottom:1px dotted #bbbbbb;
font-size:120%;
line-height:1.4em;
color:#ffffff;
}
#comments-block {
margin-top:0;
margin-right:15px;
margin-bottom:0;
margin-left:9px;
}
.comment-author {
background:url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/icon_comment_left.gif") no-repeat 2px .3em;
margin:.5em 0;
padding-top:0;
padding-right:0;
padding-bottom:0;
padding-left:20px;
font-weight:bold;
}
.comment-body {
margin:0 0 1.25em;
padding-top:0;
padding-right:0;
padding-bottom:0;
padding-left:20px;
}
.comment-body p {
margin:0 0 .5em;
}
.comment-footer {
margin:0 0 .5em;
padding-top:0;
padding-right:0;
padding-bottom:.75em;
padding-left:20px;
}
.comment-footer a:link {
color: #ced;
}
.deleted-comment {
font-style:italic;
color:gray;
}
.comment-form {
padding-left:20px;
padding-right:5px;
}
#comments .comment-form h4 {
padding-left:0px;
}
/* Profile
----------------------------------------------- */
.profile-img {
float: left;
margin-top: 5px;
margin-right: 5px;
margin-bottom: 5px;
margin-left: 0;
border: 4px solid #ffffff;
}
.profile-datablock {
margin-top: 0;
margin-right: 15px;
margin-bottom: .5em;
margin-left: 0;
padding-top: 8px;
}
.profile-link {
background:url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/icon_profile_left.gif") no-repeat left .1em;
padding-left:15px;
font-weight:bold;
}
.profile-textblock {
clear: both;
margin: 0;
}
.sidebar .clear, .main .widget .clear {
clear: both;
}
#sidebartop-wrap {
background:#99bb55 url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/corners_prof_bot.gif") no-repeat left bottom;
margin:0px 0px 15px;
padding:0px 0px 10px;
color:#ffffff;
}
#sidebartop-wrap2 {
background:url("https://web.archive.org/web/20140529005509im_/http://www2.blogblog.com/rounders4/corners_prof_top.gif") no-repeat left top;
padding: 10px 0 0;
margin:0;
border-width:0;
}
#sidebartop h2 {
line-height:1.5em;
color:#ffffff;
border-bottom: 1px dotted #ffffff;
font: normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
margin-bottom: 0.5em;
}
#sidebartop a {
color: #ffffff;
}
#sidebartop a:hover {
color: #eeeeee;
}
#sidebartop a:visited {
color: #eeeeee;
}
/* Sidebar Boxes
----------------------------------------------- */
.sidebar .widget {
margin:.5em 13px 1.25em;
padding:0 0px;
}
.widget-content {
margin-top: 0.5em;
}
#sidebarbottom-wrap1 {
background: #ffffff url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/corners_side_top.gif") no-repeat left top;
margin:0 0 15px;
padding:10px 0 0;
color: #666666;
}
#sidebarbottom-wrap2 {
background:url("https://web.archive.org/web/20140529005509im_/http://www1.blogblog.com/rounders4/corners_side_bot.gif") no-repeat left bottom;
padding:0 0 8px;
}
#sidebar {
background:url("https://web.archive.org/web/20140529005509im_/http://www1.blogblog.com/rounders4/rails_side.gif") repeat-y;
}
#sidebar {
color: #666666;
}
#sidebar h2 {
color: #666666;
border-bottom: 1px dotted #666666;
margin-bottom: 0.5em;
}
#sidebar a {
color: #447755;
}
#sidebar a:hover,
#sidebar a:visited {
color: #779988;
}
.sidebar h2 {
margin:0;
padding:0 0 .2em;
line-height:1.5em;
font:normal bold 100% 'Trebuchet MS',Verdana,Arial,Sans-serif;
}
.sidebar ul {
list-style:none;
margin:0 0 1.25em;
padding:0;
}
.sidebar ul li {
background:url("https://web.archive.org/web/20140529005509im_/http://www2.blogblog.com/rounders4/icon_arrow_sm.gif") no-repeat 2px .25em;
margin:0;
padding-top:0;
padding-right:0;
padding-bottom:3px;
padding-left:16px;
margin-bottom:3px;
border-bottom:1px dotted #bbbbbb;
line-height:1.4em;
}
.sidebar p {
margin:0 0 .6em;
}
/* Footer
----------------------------------------------- */
#footer-wrap1 {
clear:both;
margin:0 0 10px;
padding:15px 0 0;
}
#footer-wrap2 {
background:#447766 url("https://web.archive.org/web/20140529005509im_/http://www2.blogblog.com/rounders4/corners_cap_top.gif") no-repeat left top;
color:#ffffff;
}
#footer {
background:url("https://web.archive.org/web/20140529005509im_/http://www.blogblog.com/rounders4/corners_cap_bot.gif") no-repeat left bottom;
padding:8px 15px;
}
#footer hr {display:none;}
#footer p {margin:0;}
#footer a {color:#ffffff;}
#footer .widget-content {
margin:0;
}
/** Page structure tweaks for layout editor wireframe */
body#layout #main-wrap1,
body#layout #sidebar-wrap,
body#layout #header-wrapper {
margin-top: 0;
}
body#layout #header, body#layout #header-wrapper,
body#layout #outer-wrapper {
margin-left:0,
margin-right: 0;
padding: 0;
}
body#layout #outer-wrapper {
width: 730px;
}
body#layout #footer-wrap1 {
padding-top: 0;
}

-->
  </style>
 </head>
 <body>
  <div class="navbar section" id="navbar">
   <div class="widget Navbar" id="Navbar1">
    <div id="navbar-iframe-container">
    </div>
   </div>
  </div>
  <div id="outer-wrapper">
   <div id="header-wrapper">
    <div class="header section" id="header">
     <div class="widget Header" id="Header1">
      <div id="header-inner">
       <div class="titlewrapper">
        <h1 class="title">
         <a href="../index.html">
          Ray Woodcock's Latest
         </a>
        </h1>
       </div>
       <div class="descriptionwrapper">
        <p class="description">
         <span>
         </span>
        </p>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div id="main-wrap1">
    <div id="main-wrap2">
     <div class="main section" id="main">
      <div class="widget Blog" id="Blog1">
       <div class="blog-posts">
        <!-- google_ad_section_start -->
        <h2 class="date-header">
         Sunday, December 18, 2011
        </h2>
        <div class="post">
         <a name="2494756520523218614">
         </a>
         <h3 class="post-title">
          <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2011/12/windows-7-archiving-emails-from.html">
           Converting Email (EML) Files to PDF - Another (Partial) Try
          </a>
         </h3>
         <div class="post-header-line-1">
         </div>
         <div class="post-body">
          <p>
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2011/04/windows-7-archiving-emails-with.html" target="_blank">
            Once before
           </a>
           , I had converted individual email messages in EML format (from Thunderbird) to PDF format.  That had been a long and complicated process that I'd had to
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2011/04/windows-7-archiving-thunderbird-emails.html" target="_blank">
            revisit
           </a>
           a few weeks later.  It was now time to export some more emails from T-bird.  I decided to look for a simpler approach.
           <br/>
           <br/>
           In the first stage of this inquiry, I was working with some EML files that had already been exported.  So this post starts halfway through the process.  The ordinary starting point, exporting emails from T-bird, appears later in this post.
           <br/>
           <br/>
           <strong>
            Conversion Approaches
           </strong>
           <br/>
           <br/>
           <a href="https://web.archive.org/web/20140529005509/http://www.powerbasic.com/support/pbforums/showthread.php?t=41998" target="_blank">
            A thread
           </a>
           gave me some ideas to play with.  It seemed that an EML, renamed to an HTM, could be opened in Internet browsers (e.g., Firefox) and also in editors (e.g.,  Microsoft Word, Wordpad).  Unfortunately, an email's
           <a href="https://web.archive.org/web/20140529005509/https://www.google.com/search?q=email+header&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a" target="_blank">
            header
           </a>
           , containing the most recent sender, recipient, date, and subject information, was not inclined to print properly.  Some of the programs reviewed in the previous post would print the header with funky colors and other formatting stuff I didn't want.  Some would also produce tiny print.
           <br/>
           <br/>
           I was able to produce better-looking output by changing the EML to an HTM extension and opening it in Notepad.  At the end of each line in the header, and twice more after the header, I inserted &lt;br /&gt; and then saved it.  Now it would open in Firefox with a halfway decent appearance.  There were also some lines in the header that I wanted to remove, technical lines other than the customary To, From, Date, and Subject lines.
           <br/>
           <br/>
           The question was how to automate these changes.  I saw that
           <a href="https://web.archive.org/web/20140529005509/http://www.makeuseof.com/tag/how-to-find-and-replace-words-in-multiple-files/" target="_blank">
            Notepad++
           </a>
           would do changes for all opened files, but I didn't want to have to open large numbers of emails.  I found indications that
           <a href="https://web.archive.org/web/20140529005509/http://lifehacker.com/5810026/quickly-find-and-replace-text-across-multiple-documents-via-the-command-line" target="_blank">
            a one-line Perl command
           </a>
           and also an editor called
           <a href="https://web.archive.org/web/20140529005509/http://www.addictivetips.com/windows-tips/find-and-replace-text-inside-multiple-files-using-texfinderx/" target="_blank">
            TexFinderX
           </a>
           would change all occurrences of certain text within multiple documents, but I didn't want to change all occurrences.  I wanted to change the first occurrence of "From:" to be "&lt;br /&gt;From:" and likewise with Date and Subject, and I wanted to make other changes as well.
           <br/>
           <br/>
           <a href="https://web.archive.org/web/20140529005509/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=uMZ&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=multiple+text+files+search+replace+%22first+occurrence%22&amp;oq=multiple+text+files+search+replace+%22first+occurrence%22&amp;aq=f&amp;aqi=&amp;aql=&amp;gs_sm=3&amp;gs_upl=1168572l1171140l0l1172738l19l15l0l0l0l0l340l1587l8.6.0.1l15l0&amp;gs_l=serp.3...1168572l1171140l0l1172738l19l15l0l0l0l0l340l1587l8j6j0j1l15l0" target="_blank">
            A search
           </a>
           led to
           <a href="https://web.archive.org/web/20140529005509/http://stackoverflow.com/questions/6278057/replace-only-first-match-in-multiple-files-with-perl" target="_blank">
            another Perl command
           </a>
           that would apparently perform at least some of these tasks.  It was tempting to try to pick up enough Perl fluency to make that command work.  I decided, though, that it would be better to start by learning Perl more thoroughly (someday), so as to have a clearer understanding of what this command might or might not be doing inside some large number of files.  The search led, similarly, to various
           <a href="https://web.archive.org/web/20140529005509/http://stackoverflow.com/questions/148451/how-to-use-sed-to-replace-only-the-first-occurrence-in-a-file" target="_blank">
            SED and AWK commands
           </a>
           , with the same reservations on my end.
           <br/>
           <br/>
           For some reason, it felt safer to use a utility programmed to achieve the same thing as those command-line approaches, even though I would still not be able to see what was being changed.  Maybe it was just reassuring to think that someone with programming knowledge was trying to solve the problem.  It helped to find
           <a href="https://web.archive.org/web/20140529005509/http://www.techsupportalert.com/best-free-search-and-replace-utility.html" target="_blank">
            a Gizmo recommendation
           </a>
           for ReplaceText (formerly
           <a href="https://web.archive.org/web/20140529005509/http://www.softpedia.com/get/System/File-Management/BK-ReplaceEm.shtml" target="_blank">
            BK ReplaceEm
           </a>
           ).  My faith was shaken, however, when I saw that the Gizmo recommendation, dated October 17, 2011, was pointing to
           <a href="https://web.archive.org/web/20140529005509/http://www.ecobyte.com/replacetext/" target="_blank">
            a webpage
           </a>
           that said ReplaceText was no longer supported and "has known problems with some Windows 7 installations."  Not the end of the world, but also not ideal.  Gizmo's second recommendation was
           <a href="https://web.archive.org/web/20140529005509/http://www.fauland.com/af9.htm" target="_blank">
            A.F.9
           </a>
           , which appeared to have been last updated in 2002.  It seemed I might have to come up with some other approach.
           <br/>
           <br/>
           <strong>
            Dealing with Headers
           </strong>
           <br/>
           <br/>
           Another problem I was dealing with was that not all emails had the same kind of header.  Some had at least a dozen lines, with references to things like "X-Message-Delivery," where others had a smaller set of header lines.  It appeared that a fully automated approach could easily make a mess.  I noticed, for instance, that the Birdie conversion program would just run multiple lines together, in files with some kinds of headers.
           <br/>
           <br/>
           Having spent a lot of time undoing messes caused by the previous EML conversion process, I decided to take a slower and more cautious approach, at least for starters.  I began with FIND commands, on the Windows command line, designed to distinguish EML files with different kinds of headers.  These FIND commands ran into Access Denied errors, resolved in
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/03/windows-7-access-denied-on-command-line.html" target="_blank">
            a separate post
           </a>
           .
           <br/>
           <br/>
           It turned out that emails could contain a variety of header fields.  Some (e.g., Date, From, Subject) were essential and self-explanatory.  Others (e.g., Content-Type) were evidently common but were not ordinarily displayed in email readers (e.g., Outlook, Hotmail, Thunderbird).  Another category was the X-field.  According to
           <a href="https://web.archive.org/web/20140529005509/http://www.markdigital.com/2011/03/19/internet-email-and-reading-internet-email-message-headers/" target="_blank">
            one source
           </a>
           , "X-fields are experimental [though evidently X was intended to stand for "extension," not "experimental"] fields added by email clients or servers and may be useful valid information or may be forged."  Things seemed to have changed since 1993, when
           <a href="https://web.archive.org/web/20140529005509/ftp://www.ietf.org/rfc/rfc1521.txt" target="_blank">
            someone
           </a>
           seems to have felt that X-fields were to be "strongly discouraged."  At this point, they were widely used.  I had seen a number of them.  They were also called X-headers.  There was
           <a href="https://web.archive.org/web/20140529005509/http://archives.neohapsis.com/archives/postfix/2003-05/1654.html" target="_blank">
            apparently
           </a>
           no authoritative list of them; people were
           <a href="https://web.archive.org/web/20140529005509/http://www.jamesshuggins.com/h/web1/list-email-headers.htm" target="_blank">
            seemingly free
           </a>
           to invent them as they saw fit, perhaps by using ordinary email programs (e.g.,
           <a href="https://web.archive.org/web/20140529005509/http://email.about.com/od/eudoratips/qt/et_extra_header.htm" target="_blank">
            Eudora
           </a>
           ).  I found lists of X-headers for
           <a href="https://web.archive.org/web/20140529005509/http://everything2.com/title/X-Headers" target="_blank">
            Usenet
           </a>
           and
           <a href="https://web.archive.org/web/20140529005509/http://www.jamesshuggins.com/h/web1/list-email-headers.htm" target="_blank">
            listserv
           </a>
           posts.  After some hunting, I did finally find
           <a href="https://web.archive.org/web/20140529005509/http://mobiforge.com/developing/blog/useful-x-headers" target="_blank">
            a list
           </a>
           of X-headers that might appear in email messages, as well as a discussion of
           <a href="https://web.archive.org/web/20140529005509/http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html" target="_blank">
            standard HTTP header fields
           </a>
           .  By this point, though, it was clear that any such list had to be open-ended.  Even that lengthy list did not contain some of the X-headers that appeared in one of the first emails I looked it (i.e., headers of the X-Message variety).  I found no clear indication of
           <a href="https://web.archive.org/web/20140529005509/http://www.uic.edu/depts/accc/newsletter/adn29/legitmail.html" target="_blank">
            what headers
           </a>
           might appear in a legitimate email message.
           <br/>
           <br/>
           So apparently I was not going to be able to rely on someone's preconceived list of headers, as a guide to removing the unwanted ones from a large number of emails
           <em>
            en masse
           </em>
           (perhaps using some tool like TexFinderX, above).  The most reliable approach would seemingly require me to identify the header fields actually used in the emails I wanted to convert.  There did not seem to be an automated way to do that.  Some emails had HTML codes or empty lines dividing the two, but others did not.  I worked up
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/03/using-screenshots-to-examine-many-files.html" target="_blank">
            an approach
           </a>
           using screenshots, one per file (viewed in Notepad), to give me an impression of those codes.  But
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/03/optical-character-recognition-freeware.html" target="_blank">
            attempts
           </a>
           to use optical character recognition (OCR) software on those screenshots did not give me an ideally reliable indication, in text, of the header contents.
           <br/>
           <br/>
           It seemed that I probably had the ability to use macros in Word to eliminate unwanted headers and to reposition the wanted headers within the body of the email message, so as to produce a good appearance when the file was then printed to PDF.  (I was using
           <a href="https://web.archive.org/web/20140529005509/http://www.bullzip.com/products/pdf/info.php" target="_blank">
            Bullzip
           </a>
           as my PDF printer.)  I decided to approach that project by whittling down the size of the messages -- that is, by removing attachments first.
           <br/>
           <br/>
           <strong>
            PDFing the Attachments
           </strong>
           <br/>
           <br/>
           I had a sample set of 46 EML files.  I was not sure how many had attachments.  A look at some of them in Notepad suggested that not all EMLs announced the presence of attachments in the same way.  It did seem, though that a certain text string would be found in most cases where an attachment existed.  That string was:
           <br/>
           <blockquote class="tr_bq">
            Content-Disposition: attachment;
           </blockquote>
           On that starting hint, I ran a FIND command to see which of these 46 EMLs appeared to have attachments:
           <br/>
           <blockquote class="tr_bq">
            find /i /c "Content-Disposition: attachment;" "D:\Emails\*" &gt; Attachlist.txt
           </blockquote>
           Attachlist.txt gave me output like this:
           <br/>
           <blockquote class="tr_bq">
            ---------- D:\EMAILS\FILENAME.EML: 1
           </blockquote>
           apparently indicating that FILENAME.EML contained one occurrence of the Content-Disposition text string.  It said that maybe a third of the files had one such occurrence, with the rest having none.  An exception:  one file contained two occurrences.  I looked at it.  It seemed to be a case of a forwarded message, with the ATT00001.htm filename that I had often observed but never did understand.  The message was displayed in the EML, but was also apparently attached in that ATT format.  My guess was that the best approach would be to keep everything up to the last occurrence of the Content-Disposition string.
           <br/>
           <br/>
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/02/batch-merging-many-scattered-jpgs-into_14.html" target="_blank">
            I used Excel
           </a>
           to convert Attachlist.txt to a batch file that would move the files containing Content-Disposition to a separate folder.  Then I opened all of the EMLs to see how accurate this FIND command was.  It appeared that I had found the key to distinguishing those files that did contain attachments:  the ones with "Content-Disposition: attachment;" did contain attachments, and the others did not.
           <br/>
           <br/>
           I opened the EMLs containing attachments and manually printed their attachments as PDFs, with names that would help me link them to the emails later.  Some of them were
           <a href="https://web.archive.org/web/20140529005509/http://support.microsoft.com/kb/278061" target="_blank">
            extraneous winmail.dat attachments
           </a>
           that I ignored.  Some were already PDFs and thus didn't need to be printed to PDF.  So now, in that separate folder, I had about a dozen EMLs that contained attachments, and about a half-dozen attachments that I had just PDFed from those EMLs.  I wanted to convert those EMLs to PDF first, and separately from the larger group of non-attachment EMLs, so as not to get confused as to which emails the attachments belonged to.  (More precise naming of the PDFs would have alleviated that concern, but would have taken more time.)  So now it was time to figure out a solution for the EMLs themselves.
           <br/>
           <br/>
           <strong>
            Removing Attachment-Related Material from EMLs
           </strong>
           <br/>
           <br/>
           My original plan was to get the EML into Microsoft Word, where I could write macros to manipulate the text in useful ways.  If I just opened an EML in Word, it would appear without its header.  That is, it would not look like an ordinary email, as viewed in Thunderbird or Outlook.  I could get around that problem by opening Word and setting it to Options &gt; General tab &gt; Confirm conversion at Open, and then open the EML as Plain Text, but that would be an extra delay.  With a lot of emails, it could be cumbersome.
           <br/>
           <br/>
           I wanted to start by removing the contents of the emails that contained attachments, starting at the point of the last occurrence of "Content-Disposition: attachment."  Experimentation revealed that EMLs so truncated would still open and look fine in Thunderbird, and now they wouldn't have all that attachment material to prevent them from functioning like HTML files.  If they had more than one attachment, an attachment notice would still appear at the bottom of the Thunderbird EML screen, but I was OK with that.
           <br/>
           <br/>
           It occurred to me that it might be possible to find a text editor with macro capabilities, so as to handle multiple tasks without having to cycle through multiple programs.  This led to a separate search for a suitable text editor.  In a development that would doubtless provoke some to cheer and others to weep, I
           <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/03/choosing-emacs-as-text-editor-with.html" target="_blank">
            wound up with Emacs
           </a>
           .  In that process, I did manage to develop an Emacs macro that would eliminate, from an EML file, the post-HTML attachment material.
           <br/>
           <br/>
           I was only working with a dozen or so EMLs in that pilot test.  I wound up combining the extracted attachments and manually produced PDF printouts of the truncated EMLs (viewed in Thunderbird) manually, so as to remove this potentially complicating part of the larger EML-to-PDF project.
           <br/>
           <br/>
           <strong>
            Regular EMLs:  A First Pass in Emacs
           </strong>
           <br/>
           <br/>
           Now I was able to focus on the headers, without worrying about attachments.  I had a group of 34 EMLs, with various kinds of headers, that I wanted to manipulate into printable HTMs.  I opened 15 of them in Notepad and took a look.  I decided to take them in batches.  The first kind, the simplest, had "To: " as its very first four characters.  These seemed to follow a pattern of separate lines for To, Date, Subject, and From lines, which I would keep, followed by Content-type, MIME-Version, and Content-transfer-encoding lines, which I would discard.  The four keeper lines would be moved down into the text, immediately after the BODY tag, with &lt;br /&gt; tags added for line breaks as needed.  I manually edited one of these in that way, opened it as an HTM, and it looked good.
           <br/>
           <br/>
           As I thought about it some more, I thought that possibly a better strategy would be to write a macro that would go down to the &lt;BODY&gt; tag and then search upwards for the desired tags (From, To, etc.) and delete everything else.  And then, as I thought about it still more, I realized that all of the above were beyond my present Emacs ability.  I would get there ... but not today.
          </p>
          <div style="clear: both;">
          </div>
         </div>
         <div class="post-footer">
          <p class="post-footer-line post-footer-line-1">
           <span class="post-author">
            Posted by
raywood
           </span>
           <span class="post-timestamp">
           </span>
           <span class="post-comment-link">
           </span>
           <span class="post-icons">
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20140529005509/http://www.blogger.com/post-edit.g?blogID=3377753575825500498&amp;postID=2494756520523218614&amp;from=pencil" title="Edit Post">
              <span class="quick-edit-icon">
              </span>
             </a>
            </span>
           </span>
          </p>
          <p class="post-footer-line post-footer-line-2">
           <span class="post-labels">
            Labels:
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/conversion" rel="tag">
             conversion
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/convert" rel="tag">
             convert
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/Emacs" rel="tag">
             Emacs
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/email" rel="tag">
             email
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/EML" rel="tag">
             EML
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/headers" rel="tag">
             headers
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/HTM" rel="tag">
             HTM
            </a>
            ,
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/search/label/pdf" rel="tag">
             pdf
            </a>
           </span>
          </p>
          <p class="post-footer-line post-footer-line-3">
          </p>
         </div>
        </div>
        <div class="comments" id="comments">
         <a name="comments">
         </a>
         <h4>
          1 comments:
         </h4>
         <dl id="comments-block">
          <dt class="comment-author" id="comment-4213441460570558929">
           <a name="comment-4213441460570558929">
           </a>
           <a href="https://web.archive.org/web/20140529005509/http://www.blogger.com/profile/05411560299249509335" rel="nofollow">
            raywood
           </a>
          </dt>
          <dd class="comment-body">
           <p>
            <a href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/2012/06/exporting-thunderbird-emails-to-pdf.html" rel="nofollow">
             A more recent post
            </a>
            updates some aspects of this one.
           </p>
          </dd>
          <dd class="comment-footer">
           <span class="comment-timestamp">
            <a href="#comment-4213441460570558929" title="comment permalink">
             June 19, 2012 at 3:04 PM
            </a>
            <span class="item-control blog-admin pid-1700258349">
             <a href="https://web.archive.org/web/20140529005509/http://www.blogger.com/delete-comment.g?blogID=3377753575825500498&amp;postID=4213441460570558929" title="Delete Comment">
              <span class="delete-comment-icon">
              </span>
             </a>
            </span>
           </span>
          </dd>
         </dl>
         <p class="comment-footer">
          <a href="https://web.archive.org/web/20140529005509/http://www.blogger.com/comment.g?blogID=3377753575825500498&amp;postID=2494756520523218614" onclick="">
           Post a Comment
          </a>
         </p>
         <div id="backlinks-container">
          <div id="Blog1_backlinks-container">
          </div>
         </div>
        </div>
        <!-- google_ad_section_end -->
       </div>
       <div class="clear">
       </div>
       <div class="post-feeds">
        <div class="feed-links">
         Subscribe to:
         <a class="feed-link" href="https://web.archive.org/web/20140529005509/http://raywoodcockslatest.blogspot.com/feeds/2494756520523218614/comments/default" target="_blank" type="application/atom+xml">
          Post Comments (Atom)
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
<!--
     FILE ARCHIVED ON 00:55:09 May 29, 2014 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 23:56:16 Dec 27, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.74
  exclusion.robots: 0.085
  exclusion.robots.policy: 0.069
  esindex: 0.012
  cdx.remote: 12.743
  LoadShardBlock: 87.797 (3)
  PetaboxLoader3.datanode: 110.092 (4)
  PetaboxLoader3.resolve: 134.049 (2)
  load_resource: 211.207
-->
