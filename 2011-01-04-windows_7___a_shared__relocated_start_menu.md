---
layout: post
title: "Windows 7:  A Shared, Relocated Start Menu"
date: 2011-01-04
---

<div class="post-body">
<p>As described in <a href="https://web.archive.org/web/20141128211057/http://raywoodcockslatest.blogspot.com/2010/07/tweaking-windows-xp-virtual-machine.html">another post</a>, in Windows XP I had moved my Start Menu to a separate location.  That location was on a networked drive, where it would be backed up regularly, would not be affected by Windows reinstallations (as long as I reinstalled programs on each computer back to the same places as before), and would be available to multiple machines as needed.  It had grown into a monster that included not only shortcuts to installed programs but also the full contents of portable programs.<br/>
<br/>
Now that I was installing Windows 7, I wanted it to function the same way.  Unfortunately, Windows 7 was not set up to accommodate this desire.  Apparently there had been <a href="https://web.archive.org/web/20141128211057/http://www.winvistaclub.com/t78.html">a NoSimpleStartMenu registry option</a> in Vista that would have returned the system to the classic WinXP Start Menu, but I <a href="https://web.archive.org/web/20141128211057/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=miw&amp;rlz=1R1GGLL_en___US408&amp;q=%22Windows+7%22+NoSimpleStartMenu+-Vista+-XP&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=">wasn't finding much guidance</a> on that registry tweak in Win7.  In my own experimentation, it didn't work.<br/>
<br/>
There were some third-party utilities that would give me back the classic Start Menu.  I installed and played briefly with one of them.  It was the Classic Start Menu option within <a href="https://web.archive.org/web/20141128211057/http://classicshell.sourceforge.net/">Classic Shell</a>.  (Apparently there was at least <a href="https://web.archive.org/web/20141128211057/http://www.classicstartmenu.com/index.html">one other utility</a> calling itself Classic Start Menu, but that one wasn't free.)  <a href="https://web.archive.org/web/20141128211057/http://www.howtogeek.com/howto/7218/get-an-aero-styled-classic-start-menu-in-windows-7/">Classic Windows Start Menu</a> was another option:  it would apparently give me a Windows 7 Aero style combined with classic functionality, which sounded great.  It seemed to be <a href="https://web.archive.org/web/20141128211057/http://coreaffinity.megabyet.net/classicwinstartmenu.htm">a bit clunky</a>, though, in the sense that it added entries for Create Folder, Create Shortcut, and Sort in each submenu.  It didn't look like it offered as many settings as Classic Start Menu, but that initial impression could have been mistaken.<br/>
<br/>
Classic Start Menu <a href="https://web.archive.org/web/20141128211057/http://lifehacker.com/5432366/classic-shell-brings-the-old-start-menu-back-to-windows-7">seemed to be</a> the most developed utility for changing at least the looks if not also the functionality of the Win7 Start Menu.  In my brief introductory dabbling, it was actually better than the original WinXP Start Menu in terms of configurability, and it left the original Win7 Start Menu still available via Shift-Click.  Because of its features, I decided to stay with it for a while, if possible, rather than just use a relatively simple set of <a href="https://web.archive.org/web/20141128211057/http://www.howtogeek.com/howto/21992/show-the-classic-all-programs-menu-in-the-start-menu-in-windows-7/">registry edits</a> and adjustments that might have accomplished some of the same results.  The idea behind those registry edits was to <a href="https://web.archive.org/web/20141128211057/http://www.computerperformance.co.uk/windows7/windows7_menu_programs.htm">rewire the Favorites option</a> on the Win7 start menu so that it would point to C:\ProgramData.<br/>
<br/>
That pointer to C:\ProgramData might have been useful, for my purposes, if C:\ProgramData had been customizable.  It just wasn't.  It appeared that, as I installed more programs, it (and therefore a Start Menu built around it) would get very cluttered.  I had the same concern about Classic Start Menu:  I couldn't tell how to redirect it to look at the network drive.  <a href="https://web.archive.org/web/20141128211057/http://classicshell.sourceforge.net/faq.html">Their FAQs</a> didn't have a question on exactly that.  <a href="https://web.archive.org/web/20141128211057/http://classicshell.sourceforge.net/faq.html#menu_custom">It sounded like</a> their main plan was that I should drag and drop items into their settings dialog.  This, I thought, would not work for a shared Start Menu:  the changes would take effect only on the computer where I made them.  There appeared to be some possibility of future expansion in their Settings &gt; Customize Start Menu tab &gt; Programs Menu &gt; right-click &gt; Edit Item &gt; Link option, but presently that option was grayed out.  The Classic Shell people had a list of <a href="https://web.archive.org/web/20141128211057/http://classicshell.sourceforge.net/alternatives.html">alternative utilities</a>, but it sounded like they tended to have bugs.  I looked at <a href="https://web.archive.org/web/20141128211057/http://sourceforge.net/projects/classicshell/forums/forum/1049755">their forum</a>, but didn't see a question on relocating the Start Menu, so I <a href="https://web.archive.org/web/20141128211057/https://sourceforge.net/projects/classicshell/forums/forum/1049755/topic/4038738">posted a question</a> on it.  The question got no response.<br/>
<br/>
I tried to take a look at C:\Documents and Settings, which is where the Start Menu shortcuts were saved in WinXP.  (This was a hidden folder; I had already adjusted settings in Windows Explorer &gt; Tools to see it.)  When I went to that folder in Windows Explorer, I got an error:  "Location is not available.  C:\Documents and Settings is not accessible.  Access is denied."  <a href="https://web.archive.org/web/20141128211057/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=i7w&amp;rlz=1R1GGLL_en___US408&amp;q=%22Documents+and+settings+is+not+accessible.%22+%22Windows+7%22&amp;aq=f&amp;aqi=g1&amp;aql=&amp;oq=&amp;gs_rfai=">A search</a> on that led to <a href="https://web.archive.org/web/20141128211057/http://www.byteblocks.com/post/2009/08/10/Documents-and-Settings-folder-in-Windows-7.aspx">a page</a> that seemed to be telling me that, actually, Documents and Settings was just a link to C:\Users.  <a href="https://web.archive.org/web/20141128211057/http://www.svrops.com/svrops/articles/jpoints.htm">Another page</a> said C:\Documents and Settings was a "junction point" that existed for backwards compatibility.<br/>
<br/>
So I tried C:\Users instead.  That opened up.  There wasn't a Start Menu under Ray (my original username) because I had deleted that username.  I was only using Administrator.  I saw a Start Menu under Administrator, and I also saw one under All Users, as well as one under Default.  There might also have been one under Default User too; but when I tried to go into there, or into any of these several other Users subfolders, I got the "not accessible" error again, even though I was logged in as Administrator.  To defeat that, I entered a command to turn off User Access Control (UAC):<br/>
<blockquote><span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f</span></blockquote>But that didn't do it.  The message was still basically the same:  "C:\Users\All Users\Start Menu is not accessible."  (Later, I saw that Win7 had a message for me, saying that I had to reboot to turn off UAC.)  I did <a href="https://web.archive.org/web/20141128211057/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;rlz=1R1GGLL_en___US408&amp;q=%22Windows+7%22+Users+%22Start+Menu+is+not+accessible%22&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=">another search</a> and found <a href="https://web.archive.org/web/20141128211057/http://www.tek-tips.com/viewthread.cfm?qid=1621459&amp;page=5">a page</a> that said that, actually, that was a junction point too.  Where I *really* wanted to go under each username there at C:\Users, it seemed, was the AppData\Roaming\Microsoft\Windows\Start Menu folder.  I found those folders for Administrator and All Users.  So -- wasn't there a registry location pointing the Start Menu to those folders, the way WinXP's registry would point to specific folders (and could be modified to point to others instead)?<br/>
<br/>
As I thought about it, I wondered if I could use the approach (above) of doing a registry edit that would rewire the Favorites button in the classic Start Menu, and have it point to my shared Start Menu at D:\Installation\Start Menu.  That had already occurred to me, but the problem there was that, if I couldn't move items from C:\ProgramData, my Start Menu on D would be just ignoring the items on C.  But now I realized that I probably could create shortcuts to the items on C, and put those in my Start Menu on D.<br/>
<br/>
So I started to do the registry tweak as described in the sources cited above.  But when I got to HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders, I saw that there was in fact not only an entry for Favorites, which is what the abovementioned tweak would use, but also for Start Menu itself.  Well.  So why not just redirect that?<br/>
<br/>
My WinXP registry edits had redirected a number of items in that same folder, having to do with not only the Start Menu but also with other folders.  I decided to see if I could retain most of those redirections in the .reg file I was preparing to tweak new Windows 7 installations.  But for present purposes, I basically closed other programs, ran a .reg file with lines like these:<br/>
<blockquote><span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders]</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'></span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Administrative Tools"="D:\\Installation\\Start Menu"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Programs"="D:\\Installation\\Start Menu\\Programs"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Startup"="D:\\Installation\\Start Menu\\Programs\\Startup"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Start Menu"="D:\\Installation\\Start Menu"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders]</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Programs"="D:\\Installation\\Start Menu\\Programs"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Startup"="D:\\Installation\\Start Menu\\Programs\\Startup"</span><br/>
<span style='font-family: "Courier New", Courier, monospace; font-size: x-small;'>"Start Menu"="D:\\Installation\\Start Menu"</span></blockquote>and sat back to see what would happen.  The registry changes were visible instantly in regedit.  On reboot, Win7 gave me an error message:<br/>
<blockquote>Location is not available<br/>
D:\Current refers to a location that is unavailable.</blockquote>That was one of the locations I had specified in the reg file.  None of the registry edits had worked; I was still looking at the same Start Menu, or less.  Worse, the system wouldn't even run Windows Explorer.  I restarted in Safe Mode (i.e., I held F8 after the first BIOS bootup screen), but decided to try the System Recovery option instead.  But the last System Restore was even older than the most recent image backup, which seemed odd, so I went with the image.  (Apparently I was tired.  This was at day's end.  I didn't try checking the "Show more restore points" when I ran rstrui.exe.)  I probably could have just restored my backup of the affected registry keys, but I decided this would be a good first chance to test Win7's built-in system image feature.  I ran it and went to bed.<br/>
<br/>
When I got up, the image restore had worked, so I tried some of those registry edits again, one at a time.  This time, though, I saved System Restore points along the way, using Control Panel &gt; System &gt; System protection &gt; Create.  I saw that I had left out some steps.  First, as described in <a href="https://web.archive.org/web/20141128211057/http://raywoodcockslatest.blogspot.com/2011/01/windows-7-futile-attempt-to-move-fonts.html">a separate post</a>, I tried to move the fonts folder.  That failed.  It was OK; it was just an attempt to avoid having to save any new fonts in a separate location, to be restored as an extra step of any future system reinstallation.  <br/>
<br/>
Some time passed, as I worked on other parts of the Win7 installation.  Installation of other programs added more icons to the Start Menu.  When those other installations were done, I came back to this draft post.<br/>
<br/>
I decided to keep using the Classic Start Menu utility.  It worked for my purposes.  I saved its settings to a backup file.  With the registry edits shown in my post entitled "Windows 7 Installation - First Try," I was able to get the Start button to point to my shared Start Menu at D:\Installation\Start Menu.  With Classic Start Menu running, I clicked on Start &gt; right-clicked on Programs &gt; Properties &gt; Location .  I specified the place on drive D where I kept my customized Start Menu &gt; Programs folder.  I clicked Move and then closed out of that dialog.  I then went into C:\ProgramData\Microsoft\Windows\StartMenu and into the AppData\Roaming\Microsoft\Windows\Start Menu folder under each username at C:\Users, to see if there were any other program shortcuts that I would want to move to that location on D, or any other installed programs there to which I would want to link by shortcut.  There were none.<br/>
<br/>
Other than some rearranging, that was it.  I had a Windows 7 Start Menu on drive D.  Drive D could be a network share, or it could be mirrored to other computers, as described in another post I was developing at about this same time.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
Note that GoodSync (review forthcoming in this blog circa 1/22/2011) can also be set up to propagate changes to this Start Menu to other computers, so that all remain able to run alone (i.e., are not dependent on a network source) and yet all have the same current version of the Start Menu.

**raywood**:
Later, Imoved my Firefox bookmarksto the Start Menu too.

