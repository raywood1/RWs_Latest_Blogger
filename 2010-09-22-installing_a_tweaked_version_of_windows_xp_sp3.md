---
layout: post
title: "Installing a Tweaked Version of Windows XP SP3"
date: 2010-09-22
---

<div class="post-body">
<p>I was installing Windows XP Professional SP3 (referred to here sometimes as simply WinXP).  <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/09/installing-windows-xp-sp3-in-vmware.html">I was doing this in a virtual machine (VM) environment</a>, which meant that I could test and retry various steps in the process.  The VM environment (using VMware Workstation 7.1) did not appear to have much if any impact on the actual functioning of Windows.  So the following comments may contain a few notes of interest for VMware users, but should also work for general purposes.<br/>
<br/>
Since I was installing in a virtual environment, I probably avoided some hardware problems that non-virtual setups may encounter.  For example, when installing directly on a system with a Gigabyte motherboard, I had encountered a <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=markfun_load_nt_driver">MarkFun_Load_NT_Driver</a> error.  The solution for that was to make sure the latest Gigabyte drivers were installed and, if that failed, to uninstall the Gigabyte Easy Tune software.  The hardware situation was probably simpler and more stable in the VM environment.<br/>
<br/>
To somewhat simplify the process of installing and upgrading, I was installing from <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=slipstreamed+xp+sp3&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">a slipstreamed WinXP SP3 CD</a>.  My plan was to run the installation process from the CD, and then focus on setting up an all-purpose basic WinXP installation.  That is, I would be primarily concerned with settings and adjustments to Windows itself, as distinct from applications and other programs.  So this post describes the steps I took to configure WinXP.<br/>
<br/>
I had <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/07/winxp-you-must-be-logged-in-as.html">recently had a problem</a> in WinXP that I had addressed by getting rid of the user account (i.e., the one with my own name) and keeping only one account, Administrator.  <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=oNf&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=xp+%22as+administrator%22+standalone+permanently+OR+always+-vista+-%22windows+7%22&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=">A search</a> had led me to the information that, for security reasons, <a href="https://web.archive.org/web/20171105075733/http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/windows_security_whynot_admin.mspx?mfr=true">Microsoft recommended</a> against running the computer as an administrator on a regular basis; they recommended instead making that other user a member of the Power Users group.  A Power User, <a href="https://web.archive.org/web/20171105075733/http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/windows_security_whynot_admin.mspx?mfr=true">they said</a>, would still be able to run programs as an administrator to some extent.  But for reasons of convenience, I decided to go ahead and remove the user account:  Start &gt; Run &gt; control userpasswords2.  But In this case, I didn't see my own username.  Possibly VMware Workstation had bypassed that part when it set up the VM from the Windows disc.  So I didn't have to log in as Administrator to delete the user account; there was no such account.<br/>
<br/>
Now that I knew all of my adjustments were going to apply to the same (Administrator) account, I was free to start making them.  First, in a step that I should have taken at this point but did not actually take until later, I installed <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=antivirus+OR+firewall+top+OR+best&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">security software</a>.  I initially went with Panda Cloud and Comodo Firewall, but Panda was malfunctioning.  I also tried Avast, on a different machine, but I found that it <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=avast+thunderbird+smtp&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=RCT&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=avast+thunderbird+smtp+%22unable+to+connect+to+smtp+server%22&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=avast+thunderbird+smtp+%22unable+to+connect+to+smtp+server%22&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">interfered with outgoing email</a> sent in Thunderbird Portable.  So I tried again by installing <a href="https://web.archive.org/web/20171105075733/http://download.cnet.com/AVG-Anti-Virus-Free-Edition/3000-2239_4-10320142.html?tag=mncol">the free version</a> of AVG Antivirus.  I did that first, because it would complain during installation about conflicts if Comodo was already installed.  Then I did install Comodo (firewall only).  I had learned that installing multiple firewalls and antivirus programs could be counterproductive, and was migrating away from the temptation to install other sorts of vaguely security-related programs (e.g., Windows Defender, Spyware Blaster) that did not seem to do much (other than, perhaps, impair performance).  I had the impression that <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=ApX&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=threatfire+antivirus&amp;aq=f&amp;aqi=g6g-m1&amp;aql=&amp;oq=&amp;gs_rfai=">Threatfire</a> was somewhat different -- that it was designed to operate in conjunction with existing antivirus and firewall software -- but it hadn't seemed helpful, in my recent experiments, so I skipped it.<br/>
<br/>
My actual next step was to create a separate 4GB partition for my paging file.  (If I had not been working in a VM, I would have used <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=gparted&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">GParted</a>, provided by itself or on <a href="https://web.archive.org/web/20171105075733/http://www.ubuntu.com/desktop/get-ubuntu/download">Ubuntu Live CDs</a> at System &gt; Administration &gt; GParted, to create this small additional partition.)  After I created it and booted into WinXP, I went into Start &gt; Run &gt; diskmgmt.msc.  The Initialize and Convert Disk Wizard started up, wanting to make something useful of that unformatted 4GB paging drive.  I went ahead with that and then right-clicked on that partition and went through the New Volume Wizard.  I assigned drive letter P to that 4GB partition and labeled it PAGING.  No compression.  When that was done, I right-clicked on the CD-DVD drive and made it drive Y, and then right-clicked on drive C and labeled it PROGRAMS.<br/>
<br/>
Next, I made changes in Windows Explorer.  First, I arranged its Windows Explorer views and panes to suit me, including its menu bar and status bar.  I right-clicked on its Go button to get rid of that.  Then, in Tools &gt; Folder Options &gt; General Tab, I set classic folders.  In the File Types tab, I scrolled down and selected the REG (Registration Entries) file type, and clicked on Advanced &gt; Merge &gt; Set Default &gt; OK.  In the View tab, I told it to show me system folders, hidden files, extensions, and protected operating system files, but not to show me pop-up descriptions for folder and desktop items.  Finally, I clicked on the Apply to All Folders button.  I went back into Tools &gt; Map Network Drive and assigned drive letters to my VMware network drives (referred to, in that dialog, as VMware Shared Folders).  After finishing with that, I right-clicked on the names of the mapped drives in the left-hand pane, and changed them to the names I preferred.<br/>
<br/>
My drive arrangement included drive C, of course, for Windows programs, and also drive D, for data.  Within drive D, I created D:\Installation, where I saved things that I didn't want to have to recreate, reconfigure, or reorganize after a new Windows installation on drive C.  So now I copied the entire contents of the I386 folder on the Windows XP installation CD to D:\Installation\I386.  (To make sure it went right, there should not be a folder called D:\I386\I386.)  I could have installed WinXP <a href="https://web.archive.org/web/20171105075733/http://paulski.com/zpages.php?id=1711">from the hard drive</a> in the first place, but I wasn't sure whether that worked well in the case of a slipstreamed CD.  So instead, at this point I adjusted WinXP so that it would look to the hard drive whenever it needed files from the installation CD.  This would prevent messages like "Files Needed:  The file [filename] on Windows XP Professional Service Pack 3 CD is needed" and "Windows File Protection:  Files that are required for Windows to run properly must be copied to the DLL Cache."  This required a registry edit.  I could have done it manually, using regedit or a tool like <a href="https://web.archive.org/web/20171105075733/http://www.resplendence.com/downloads">Registrar Registry Manager Lite</a>.  Instead, I just ran this registry file, called RegTweak1.reg:<br/>
<span style='font-family: "Courier New", "Courier", monospace;'><span style="font-size: x-small;"><br/>
Windows Registry Editor Version 5.00 <br/>
<br/>
; ************* TWEAK SOURCES *************<br/>
; http://www.onecomputerguy.com/windowsxp_tips.htm#safe_boot <br/>
; http://www.kellys-korner-xp.com/xp_tweaks.htm <br/>
; http://www.theeldergeek.com <br/>
; and other assorted sources. <br/>
<br/>
; ************* NOTES ************* <br/>
; There are undo options for many of these at the sources (above). <br/>
; Items that are commented out were not needed on this system. <br/>
; Run this with no other programs running (even Windows Explorer). <br/>
<br/>
; ************* TWEAKS ************* <br/>
<br/>
; * * * Specific to a new installation * * *  <br/>
<br/>
; Set online registration as being completed <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion] <br/>
"RegDone"="1" <br/>
<br/>
; Disable Windows Tour  <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Applets\Tour] <br/>
"RunCount"=dword:00000000 <br/>
<br/>
; Specify source path to WinXP installation files <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup] <br/>
"SourcePath"="D:\\Installation\\" <br/>
"ServicePackSourcePath"="D:\\Installation\\" <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion] <br/>
"SourcePath"="D:\\Installation\\I386" <br/>
<br/>
; Set Control Panel to classic view <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] <br/>
"ForceClassicControlPanel"=dword:00000001</span></span><br/>
<br/>
After running that, I rebooted.  I did originally have that and the other reg files shown in this post (below) in a single file called Mega.reg.  After I ran it, though, I had lots of issues, and it was hard to nail down what had caused them.  So I went to this three-part approach.<br/>
<br/>
There were hundreds if not thousands of possible tweaks of Windows XP.  Many were listed at sites such as <a href="https://web.archive.org/web/20171105075733/http://www.kellys-korner-xp.com/xp_tweaks.htm">Kellys-Korner</a>, <a href="https://web.archive.org/web/20171105075733/http://www.theeldergeek.com/index.htm">The Elder Geek</a>, and <a href="https://web.archive.org/web/20171105075733/http://www.onecomputerguy.com/windowsxp_tips.htm#safe_boot">Bob Cerelli's Windows Page</a>.  Others could be created with scripts and .reg files and/or with tools like <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=regshot&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">RegShot</a>, <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=tweakui&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=f3h&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=tweakui+OR+%22tweak+ui%22&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">TweakUI</a>, and <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/07/using-xqdc-x-setup-pro-in-windows-xp.html">XQDC X-Setup Pro 9.2</a>.  The reg files shown in this post came from such sources.  Generally, I found that it was possible to find or create working .reg files (incorporated into Mega.reg) for simple changes, and less worthwhile to make the effort for more complicated tweaks.  I had originally included these several registry edits in a larger file that I ran all at once, but that file kept mutating.  Parts of it were proving unnecessary, and parts of it also seemed to be screwing up my installations.  But I left the initial explanatory notes here in RegTweak1.reg for future reference.  Anyway, after running RegTweak1, I rebooted and hit Start &gt; Run &gt; "sfc /scannow."  System File checker ran without requiring me to insert the Windows installation CD, so apparently the tweak worked.  If it had failed, I would have resorted to <a href="https://web.archive.org/web/20171105075733/http://www.infocellar.com/winxp/insert-cd-fix.htm">additional instructions</a>.<br/>
<br/>
Back in Windows Explorer, at the bottom of the file list in the Folders pane, I right-clicked on Recycle Bin  &gt; Properties &gt; Global tab &gt; uncheck "Display delete  confirmation dialog."  Also, near the bottom of the Folders pane, I made changes in Control Panel.  I started with Control Panel &gt; Add or Remove Programs &gt; Add/Remove Windows Components (on the  left side):  turn on Internet Information Services (IIS), turn off Indexing Service, and if there is a land line for phones, turn on <a href="https://web.archive.org/web/20171105075733/http://support.microsoft.com/kb/306550/EN-US/">Fax Service</a>.<br/>
<br/>
Going down the list in Control Panel, I changed Display, Mouse, and Power.  In Display, I made several changes to suit my preference, and also turned off the Desktop Cleanup Wizard by choosing the Desktop tab &gt; Customize Desktop &gt; uncheck "Run Desktop Cleanup wizard every 60 days."  Then, still in Control Panel, I customized Taskbar and Start Menu and then went into System.  Going down the list of tabs in System, I made sure System Restore was running only on drive C; requested downloads but not installation for automatic updates; set the computer's name; and checked Hardware to verify there were no problems in Device Manager.  Then I made several changes in the Advanced tab, under Performance Settings.  First, on the <a href="https://web.archive.org/web/20171105075733/http://tweakhound.com/xp/xptweaks/supertweaks3.htm">Visual Effects</a> tab, I deselected the items I didn't need.  (Note:  deselecting the wrong ones could make the video interface look pretty bad.)  Next, in the Advanced tab, I went into Virtual Memory Change.  There, I set "No paging file" for drive C and "Custom size" (minimum 2000, maximum 3800) for drive P.  (I had to click "Set" for each drive separately, else it wouldn't keep the value I had designated.)  I clicked Apply and OK to get out of there, and rebooted.<br/>
<br/>
Next, I moved the contents of the Start Menu folders for all users (C:\Documents and Settings\All Users\Start Menu) and for me specifically (C:\Documents and Settings\Ray Woodcock\Start Menu) to D:\Installation\Start Menu.  I had to copy rather than move some files and folders that didn't want to move.  Then I deleted all but the empty Start Menu folders from the source locations.  I was supposed to set the Hidden attribute for the desktop.ini file in the new Start Menu\Programs\Startup folder to keep it from opening at bootup, but it wouldn't let me, so I deleted it.  I would eventually rearrange the Start Menu considerably, but for now it was somewhat chaotic.  I did make one tweak there now, though.  I right-clicked on the shortcut for Windows Explorer in the Start menu and went into Properties &gt; Target box (not button).  I wanted Windows Explorer to open in drive D, so what I typed in the Target box was %SystemRoot%\explorer.exe /e,"D:\."  Then I ran RegTweak2.reg:<br/>
<span style='font-family: "Courier New", "Courier", monospace;'><span style="font-size: x-small;"><br/>
Windows Registry Editor Version 5.00 <br/>
<br/>
; * * * Additional useful tweaks * * *  <br/>
<br/>
; Turn off automatic restart after Windows Updates are installed <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU] <br/>
"NoAutoRebootWithLoggedOnUsers"=dword:00000001 <br/>
<br/>
; Disable automatic reboot after crash so you can see error messages <br/>
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashControl] <br/>
"AutoReboot "=dword:00000000 <br/>
<br/>
; Don't clear paging file at shutdown <br/>
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management] <br/>
"ClearPageFileAtShutdown"=dword:00000000 <br/>
<br/>
; Remove "Log Off" option from Start Menu <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] <br/>
"StartMenuLogoff"=dword:00000001 <br/>
<br/>
; Disable balloon tips <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced] <br/>
"EnableBalloonTips"=dword:00000000 <br/>
<br/>
; Remove Language Bar <br/>
; Could also use Control Panel &gt; Regional and Language Options &gt; Languages &gt; Details &gt; Language Bar button &gt; uncheck Show the Language bar on the desktop check box<br/>
[-HKEY_CLASSES_ROOT\CLSID\{540D8A8B-1C3F-4E32-8132-530F6A502090}] <br/>
@="Language bar" <br/>
"MenuTextPUI"="@%SystemRoot%\\System32\\msutb.dll,-325" <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] <br/>
"NoSaveSettings"=dword:00000000 <br/>
<br/>
; Increase Start Menu display speed -- default is 400 <br/>
[HKEY_CURRENT_USER\Control Panel\Desktop] <br/>
"MenuShowDelay"="200" <br/>
<br/>
; List My Computer before My Documents in Windows Explorer <br/>
[HKEY_CLASSES_ROOT\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}] <br/>
"SortOrderIndex"=dword:00000054 <br/>
<br/>
; Disable creation of Thumbs.db <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced] <br/>
"DisableThumbnailCache"=dword:00000001 <br/>
<br/>
; Double-pane Windows Explorer for network drives <br/>
[HKEY_CLASSES_ROOT\Folder\shell\open\ddeexec] <br/>
@="[ExploreFolder(\"%l\", %I, %S)]" <br/>
<br/>
; Windows Explorer classic search <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState] <br/>
"Use Search Asst"="no" <br/>
<br/>
; Disable beep on error<br/>
[HKEY_CURRENT_USER\Control Panel\Sound] <br/>
"Beep"="No" <br/>
<br/>
; Add "Command Prompt Here" option to context menu<br/>
[HKEY_CLASSES_ROOT\Directory\shell\Command Prompt Here] <br/>
@="Command &amp;Prompt Here" <br/>
[HKEY_CLASSES_ROOT\Directory\shell\Command Prompt Here\command] <br/>
@="cmd.exe /k cd %1 " <br/>
; ALTERNATIVE:  Command Window<br/>
; Context menu command window option <br/>
; [HKEY_CLASSES_ROOT\Directory\shell\cmd] <br/>
; @="Open Command Window Here" <br/>
; [HKEY_CLASSES_ROOT\Directory\shell\cmd\command] <br/>
; @="cmd.exe /k \"cd %L\"" <br/>
<br/>
; Add Copy To and Move To to context menu <br/>
[HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers] <br/>
[HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\Copy To] <br/>
@="{C2FBB630-2971-11D1-A18C-00C04FD75D13}" <br/>
[HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\Move To] <br/>
@="{C2FBB631-2971-11D1-A18C-00C04FD75D13}" <br/>
<br/>
; Disable context menu Send To <br/>
[HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\Send To] <br/>
@="" <br/>
<br/>
; Files with no extension open in Notepad <br/>
[HKEY_CLASSES_ROOT\*\shell] <br/>
[HKEY_CLASSES_ROOT\*\shell\open] <br/>
@="Open With Notepad" <br/>
[HKEY_CLASSES_ROOT\*\shell\open\command] <br/>
@="notepad.exe %1" <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.] <br/>
"Application"="Notepad" <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\Notepad] <br/>
@="Notepad" <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\Notepad\command] <br/>
@="C:\\Windows\\notepad" <br/>
<br/>
; Disable XP from asking "Do you want to open this file?" <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Download]  <br/>
"CheckExeSignatures"="no"  <br/>
"RunInvalidSignatures"=dword:00000001  <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Attachments]  <br/>
"SaveZoneInformation"=dword:00000001  <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Associations]<br/>
"LowRiskFileTypes"=".zip;.rar;.nfo;.txt;.exe;.bat;.com;.cmd;.reg;.msi;.htm;.html;.gif;.bmp;.jpg;.avi;.mpg;.mpeg;.mov;.mp3;.m3u;.wav;"<br/>
<br/>
; Turn off Auto-Play for removable devices <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] <br/>
"NoDriveTypeAutoRun"=dword:00000095 <br/>
"NoSaveSettings"=dword:00000000 <br/>
; ALTERNATE:  "NoDriveTypeAutoRun"=dword:000000FF <br/>
<br/>
; Disable CD autorun <br/>
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Cdrom] <br/>
"AutoRun"=dword:00000000 <br/>
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\NoDriveTypeAutoRun] <br/>
"NoDriveTypeAutoRun"=dword:000000b1 <br/>
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] <br/>
"NoDriveTypeAutoRun"=dword:000000b1</span></span><br/>
<br/>
While I was doing this, XP had been downloading updates.  So instead of rebooting, I went with the Turn Off option, allowing it to install those updates and shut down.  I made a backup of the installation so far.  This involved setting a System Restore point and doing an <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/08/tweaking-windows-xp-backups-proceeding.html">Acronis drive image backup</a>.  Then I continued with the process.  I went to <a href="https://web.archive.org/web/20171105075733/http://www.update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us">the Windows Update webpage</a> and, using the Custom option, downloaded all of the remaining updates they had.  I reran and rebooted and reran until there were no more updates to be had.  The only download I rejected was <a href="https://web.archive.org/web/20171105075733/http://www.microsoft.com/windows/products/winfamily/desktopsearch/technicalresources/techfaq.mspx">Windows Search 4.0</a>, and that was because I planned to try <a href="https://web.archive.org/web/20171105075733/http://www.copernic.com/en/products/desktop-search/index.html">Copernic</a> instead.<br/>
<br/>
(<a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/07/windows-xp-some-updates-were-not.html">Recent experience</a> had demonstrated the importance of making sure that updates were installed:  the situation could get worse if left unaddressed.  Steps to be taken in such a case included rebooting and trying again; confirming that there were no errors in the "Review your update history" option at the left side of the Windows Update webpage, and clicking on the question mark next to the red X for any failed items; consulting Control Panel &gt; Add or Remove Programs &gt; Show Updates to see if the offending item had been installed but could be removed and reinstalled; and <a href="https://web.archive.org/web/20171105075733/http://support.microsoft.com/search/default.aspx?query=KB974417+0x66a+&amp;catalog=LCID%3D1033&amp;mode=r">searching Microsoft support</a> for the KB item and error code.  In my most recent experience, involving a .NET framework error, the <a href="https://web.archive.org/web/20171105075733/http://blogs.msdn.com/b/astebner/archive/2008/08/28/8904493.aspx">.NET Framework Cleanup Tool</a> provided the apparent solution.  Fortunately, this time around, I had no such problems.)<br/>
<br/>
While I was in Internet Explorer (IE), I went to Tools &gt; Internet Options &gt; Security tab &gt; Trusted Sites &gt; Custom Level.  Near the bottom of this list, right before the Scripting section, I changed "Websites in less privileged web content zone can navigate into this zone" away from Prompt, to either Enable or Disable.  Also in the Security tab, I went into Local intranet &gt; Sites &gt; uncheck Automatic and checked all three "Include all" boxes.  Elsewhere in IE, I went to the Programs tab and named Hotmail as my default email program.  I clicked Apply &gt; OK.  Then I navigated to YouTube.com and played a video, so as to trigger the process of installing Adobe Flash Player.  (I could also have gone into Tools &gt; Internet Options &gt; General tab &gt; Browsing History &gt; Settings to move the Temporary Internet Files to another drive, but for some reason this was not working in my VM setup.)  Then I ran RegTweak3.reg and rebooted:<br/>
<span style='font-family: "Courier New", "Courier", monospace;'><span style="font-size: x-small;"><br/>
</span></span><span style="font-size: x-small;"><span style='font-family: "Courier New", "Courier", monospace;'>Windows Registry Editor Version 5.00 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; * * * Miscellaneous Tweaks * * * </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Skip logon screen </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"LogonType"=dword:00000001 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Eliminate "Windows cannot open this file" message </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"NoInternetOpenWith"=dword:00000001</span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"NoInternetOpenWith"=dword:00000001 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Use these lines to undo </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; "NoInternetOpenWith"=- </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; "NoInternetOpenWith"=- </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Set locations for Start Menu and special folders </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Music"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Video"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Pictures"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Start Menu"="D:\\Installation\\Start Menu" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Programs"="D:\\Installation\\Start Menu\\Programs" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Startup"="D:\\Installation\\Start Menu\\Programs\\Startup" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Music"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Video"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"My Pictures"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Start Menu"="D:\\Installation\\Start Menu" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Programs"="D:\\Installation\\Start Menu\\Programs" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Startup"="D:\\Installation\\Start Menu\\Programs\\Startup" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Administrative Tools"="D:\\Installation\\Start Menu\\Programs\\Miscellany\\Administrative Tools" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Cache"="E:\\Cache\\Temporary Internet Files" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Personal"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\MMFiles] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>@="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\MMFiles] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"MyMediaPath"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\MMFiles] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"GraphicsPath"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\MMFiles] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"GrWebPath"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Increase no. of remembered folder sizes to 5000; max of 8000 = 00001f40 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[-HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam\BagMRU] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[-HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam\Bags] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\Shell] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"BagMRU Size"=dword:00001388 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"BagMRU Size"=dword:00001388 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Save settings on exit </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"NoSaveSettings"=dword:00000000 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; * * * Internet Explorer and Online </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Specify IE download directory </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"Download Directory"="D:\\Current" </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Force IE to launch shortcuts in a new window </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"AllowWindowReuse"=dword:00000000 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Disable Microsoft and Internet Explorer error reporting </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PCHealth\ErrorReporting] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"DoReport"=dword:00000000 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"IEWatsonDisable"=dword:00000001 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Increase Internet download connections to 10 </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"MaxConnectionsPerServer"=dword:0000000a </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"MaxConnectionsPer1_0Server"=dword:0000000a </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; * * * Bug Fixes * * * </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'> </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>; Increase number of Page Table entries - prevent USB delayed write error </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management] </span><br style='font-family: "Courier New",Courier,monospace;'/><span style='font-family: "Courier New", "Courier", monospace;'>"SystemPages"=dword:00024fff</span></span><br/>
<br/>
Now it was time to install some programs that were designed to tweak various aspects of the system, and especially of the user interface.  Having already gone through X-Setup and others mentioned above, I was looking for more targeted, single-purpose programs here.  One was the <a href="https://web.archive.org/web/20171105075733/http://www.microsoft.com/typography/cleartype/tuner/Step1.aspx">Clear Type Tuner</a>, to improve readability onscreen -- although, in my case, the bad video I was getting seemed to come from my use of a VGA cable rather than a DVI cable to connect my monitor to the computer.  Others included <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=tclockex&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=NGj&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=tclockex+xp&amp;aq=f&amp;aqi=g-sx1g-o1&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">TClockEx</a>, <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=taskbarshuffle&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=sOh&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=taskswitch+OR+taskswitcher+powertoy&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">Taskswitch PowerToy</a>, <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=%22visual+task+tips%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=l4M&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22visual+task+tips+3.4%22&amp;aq=f&amp;aqi=g2g-o1&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">VisualTaskTips</a>, <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=filebox+extender&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=ctd&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22filebox+extender%22&amp;aq=f&amp;aqi=g3g-o1&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">FileBox eXtender</a>, and <a href="https://web.archive.org/web/20171105075733/http://ccollomb.free.fr/unlocker/">Unlocker</a> 1.8.5 (no Bing bar).  Some of these were familiar; some were new to me.  I also installed <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=bullzip+pdf&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#sclient=psy&amp;num=10&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=d13&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=bullzip+pdf+printer&amp;aq=f&amp;aqi=g5&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=7b3e9e0669ddb0a1">Bullzip PDF Printer</a>.  These were in addition to the portable utilities I had available on the hard drive.<br/>
<br/>
I noticed at this point that the system was running slowly, so I installed <a href="https://web.archive.org/web/20171105075733/http://www.google.com/search?q=Advanced+WindowsCare&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">Advanced WindowsCare</a> (precursor to Advanced SystemCare), ran and reran its first four items, and then rebooted.  I ran it again, this time also including its junk file cleaner, and put a shortcut to it in my Startup folder.  It seemed to help.  There was another problem, though, involving the failure of Windows Explorer to remember when I tried to cut and paste multiple files.  I have addressed that problem in <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/09/windows-explorer-fails-to-remember.html">a separate post</a>.  I also set up my Start Menu.  As described in <a href="https://web.archive.org/web/20171105075733/http://raywoodcockslatest.blogspot.com/2010/09/windows-xp-integrating-start-menu-with.html">another post</a>, I set it up to be portable -- that is, to be on drive D, to refer to default program locations on drive C, and to include portable apps.<br/>
<br/>
Next, I wanted to test some of what I had installed.  Using portable versions of the applications, I opened a .doc file in OpenOffice Writer, an .xls file in OpenOffice Calc, a .pdf in Sumatra, and a .wav file and a .jpg in IrfanView.  I also opened the .wav in its default application, which at that point was Windows Media Player, and this generated the process of validating Windows and going through the other steps necessary for WMP to run.  These all worked OK.<br/>
<br/>
This was the end of this effort to log the steps required to install one variety of a tweaked Windows XP installation.  I expected to continue to refine it and, eventually, to update it to a later version of Windows.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
**raywood**:
Later, I found that Filebox Extender was incompatible with AvaFind.  The latter was the best file-finder available, in my experience, so I gave Filebox Extender the boot.

**raywood**:
New discovery:  to create a shorthand reference to a program, copy the shortcut to C:\Windows.  For example, I wanted to be able to refer to FirefoxPortable.exe in a batch command.  I created a shortcut, named it Firefox, and put it in C:\Windows.  Now, when my batch file refers to "Firefox," that .exe runs.Thanks to http://superuser.com/questions/49075/windows-create-a-directory-alias for this one.

