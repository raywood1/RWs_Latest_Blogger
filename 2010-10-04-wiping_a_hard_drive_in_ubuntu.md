---
layout: post
title: "Wiping a Hard Drive in Ubuntu"
date: 2010-10-04
---

<div class="post-body">
<p>I had an old ATA (PATA) hard drive that I wanted to wipe and dump.  I didn't know if there had ever been anything particularly sensitive on there, but anything is possible, and anyway I wanted to know how to do it in Ubuntu.  This post presents what I learned in that process.<br/>
<br/>
After a preliminary search, I came across <a href="https://web.archive.org/web/20190906053711/http://www.uluga.ubuntuforums.org/showpost.php?p=5391445&amp;postcount=2">this advice</a>:  "The first thing to do is to see if hpa is enabled."  "HPA," <a href="https://web.archive.org/web/20190906053711/http://www.thinkwiki.org/wiki/Hidden_Protected_Area">according to Thinkwiki</a>, was short for "Hidden Protected Area" or "Host Protected Area."  It was "a special area (usually a few gigabytes in size)."  The recommended way to see if hpa was enabled was to type "sudo hdparm -N /dev/sdx."  I did that and got this:<br/>
<blockquote>625142448/4385456(625142448?), HPA setting seems invalid (buggy kernel device driver?)</blockquote><a href="//web.archive.org/web/20190906053711/https://www.google.com/search?hl&amp;q=%22hpa+setting+seems+invalid%22&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">A search</a> for that error message led to just a dozen or so hits, containing various bits of information.  For instance, <a href="https://web.archive.org/web/20190906053711/http://www.linuxquestions.org/questions/linux-hardware-18/bios-not-reporting-size-of-working-hdd-784061/#post3848488">thorkelljarl</a> noted that "The HDD utilities supplied by Seagate, Samsung and some other HDD makers can set the HDD capacity and should remove HPA totally."  <a href="https://web.archive.org/web/20190906053711/https://bugs.launchpad.net/ubuntu/+source/linux/+bug/380138/comments/10">NeCod</a> suggested trying this:<br/>
<blockquote>grep -i HPA /var/log/kern.log</blockquote>That produced two messages, each beginning with the date and time and then reading as follows:<br/>
<blockquote>ubuntu kernel: [    3.076473] ata5.01: HPA unlocked: 625140335 - &gt; 625142448, native 625142448<br/>
ubuntu kernel: [    3.482031] ata1.00: HPA unlocked: 156299375 - &gt; 156301488, native 156301488</blockquote>I wasn't sure what those messages meant.  I thought the system in question might have been confused about the hpa on this drive because I had booted the system using a live Ubuntu CD.  WilliTo offered <a href="https://web.archive.org/web/20190906053711/https://bugs.launchpad.net/ubuntu/+source/linux/+bug/380138/comments/11">some advice</a> pertaining to RAID, but the first two steps sounded more generically useful:<br/>
<blockquote>1- Disable backup bios to disk in gigabyte bios if enabled<br/>
2- Disable HPA with HDAT2 (disk must be in sata mode not raid)</blockquote>Similarly, that Thinkwiki page said "If the HPA is enabled in the BIOS (mode set to "Normal"), Linux may get confused about the correct partition geometry."  I tried rebooting, hit Del to go into the BIOS settings &gt; Advanced BIOS Features &gt; Dual BIOS Recovery Source.  That didn't have an option to disable this; it just had HPA or Backup BIOS options.  <a href="https://web.archive.org/web/20190906053711/https://bugs.launchpad.net/ubuntu/+source/linux/+bug/380138">A Launchpad page</a> gave me the impression that this was particularly a Gigabyte motherboard problem:<br/>
<blockquote>Virtual BIOS solutions - like GigaByte motherboards use<br/>
<br/>
This is absolutely CRITICAL. When the hd is unlocked and fully used new GigaByte boards tend to write 1.5 MB at the end of IDE or SATA drives in legacy mode as BIOS backup. Then HPA is activated, every OS has to respect this otherwise it will definitely overwrite data. That's usally not directly visable for the user, but it definitely happens. Depending of the filesystem used for the partition using that last mb will immediately kill data or it will take time till it is filled, but corruption is inevitable.</blockquote>That Launchpad page said that HPA takes only 1.5MB.  But I preferred not to have it there, for purposes of this erasure.  I had seen another note, somewhere, indicating that the person in question was finding that the HPA was more like 8GB.<br/>
<br/>
Going back to WilliTo's advice, I did <a href="//web.archive.org/web/20190906053711/https://www.google.com/search?hl&amp;q=hdat2&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">a search</a> for HDAT2.  According to <a href="//web.archive.org/web/20190906053711/https://www.google.com/search?hl&amp;q=hdat2&amp;sourceid=navclient-ff&amp;rlz=1B7GGLL_enUS379US380&amp;ie=UTF-8">its homepage</a>, HDAT2 was a "program for test or diagnostics of ATA/ATAPI/SATA, SSD and SCSI/USB devices."  A desultory glance at <a href="//web.archive.org/web/20190906053711/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=hdat2+review+-torrent+-rapidshare&amp;btnG=Search">a few reviews</a> suggested that HDAT2 was an OK program.  My next question was whether I could add it to a BartPE bootable USB stick as one more boot utility, but it looked like <a href="//web.archive.org/web/20190906053711/https://www.google.com/search?num=50&amp;hl=en&amp;newwindow=1&amp;rlz=1B7GGLL_enUS379US380&amp;q=ubcd4win+hdat2+bartpe&amp;btnG=Search">UBCD4Win</a> (the Ultimate Boot CD for Windows) and/or <a href="https://web.archive.org/web/20190906053711/http://www.ultimatebootcd.com/">UBCD</a> had beat me to it.  Rather than pursue that, however, I found that <a href="https://web.archive.org/web/20190906053711/http://www.dban.org/">Darik's Boot And Nuke (DBAN)</a> was a simple and highly recommended bootable eraser, so I went with that.</p>
<div style="clear: both;"></div>
</div>

---
### Comments
