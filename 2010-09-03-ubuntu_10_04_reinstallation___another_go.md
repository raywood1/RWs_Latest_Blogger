---
layout: post
title: "Ubuntu 10.04 Reinstallation:  Another Go"
date: 2010-09-03
---

<div class="post-body">
<p>I had <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/03/ubuntu-910-downgrading-from-64-bit-to.html">previously installed</a> Ubuntu 10.04 once or twice.  This post provides a synthesis of the process, done on a Windows XP dual-boot machine.<br/>
<br/>
<b>Things to Save</b><br/>
<br/>
The first thing to think about was, What did I want to save from my previous installation?  I was already keeping my data in an NTFS partition that WinXP recognized as D:.  I had named that partition DATA in both operating systems (OSs).  So I did not have most of my data on the root (commonly referred to with a simple slash, "/") partition containing my Ubuntu program installation.  The main exception was what Ubuntu knows as the /home partition.  (This and other Ubuntu folders, being included on a partition formatted in ext3 or ext4, were invisible to Windows.)  The /home partition was the default location for user data files.  My own files -- documents, PDFs, etc. -- were no longer there, but Ubuntu would still save various settings and other things there.  So I decided to try create a new /home partition, and copy the old /home <i>folder's </i>contents to the new /home <i>partition</i>,  before reinstalling Ubuntu.  That little effort became the subject of <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-creating-separate-home.html">a separate post</a>.<br/>
<br/>
Just in case, I saved my open tabs in Firefox (Ubuntu) using an extension whose name was not visible to me at this writing -- called (I believe) CopyAllURLs.  I also used the FEBE addon to save my complete Firefox setup; and since FEBE had failed in the past, I used the InfoLister addon to save at least the list of addons that I had currently installed.  I had previously saved their settings separately, for those addons (e.g., Tab Mix Plus, Forecastfox) that allowed me to do so.  I saved all of these things to my data drive, not to the Ubuntu programs drive that I was about to wipe out.  All of these steps proved to be unnecessary:  the separate /home partition (below) saved my entire Firefox setup just as I had left it.<br/>
<br/>
I started up Chrome and Opera, both of which I had installed on this machine, and saved a list of their open URLs.  This, too, was unnecessary, thanks to the separate /home partition.  I had already migrated my email and contacts from Thunderbird (Ubuntu) to the Windows portable version of Thunderbird.<br/>
<br/>
There was another thing to save, but I forgot until too late.  I should have run <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/03/ubuntu-910-downgrading-from-64-bit-to.html">the installed-software command</a> to make a current list of the programs I had installed on Ubuntu.  Instead, I was going to have to use the older list that I had saved some months earlier, and any programs installed since then would have to be rediscovered and reinstalled one at a time.<br/>
<br/>
I should also have saved /etc/fstab.  My set of hard drive partitions had mostly not changed.  I could have just edited that instead of starting over from scratch (below).<br/>
<br/>
That was pretty much all that I needed to save from the old Ubuntu programs partition that I was about to wipe out.  Most of my work was done in Windows virtual machines running on VMware Workstation, and those were on a separate partition already.  So now it was time to begin the installation.<br/>
<br/>
<b>Installation from CD</b><br/>
<br/>
This time, I installed Ubuntu 10.04 from scratch, using the CD.  <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/05/enabling-pae-on-ubuntu-1004.html">Previous inquiries</a> had suggested that the PAE-enabled kernel would be installed automatically when installing from the CD.  (PAE allowed 32-bit Ubuntu to access RAM well beyond the <a href="https://web.archive.org/web/20150408214132/http://www.google.com/search?q=limit+gigabytes+32-bit&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=zLx&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=limit+4GB+RAM+32-bit+Ubuntu+-Windows+-Vista+-XP&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=d331bd8e2d0de10c">4GB theoretical limit</a> -- apparently <a href="https://web.archive.org/web/20150408214132/http://www.google.com/search?q=pae+ram+limit+ubuntu&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=oPx&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=intitle%3Apae+ram+limit+ubuntu+64GB&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=d331bd8e2d0de10c">up to 64GB</a>.)  By right-clicking on individual items in the partition install screen during installation, I manually designated a 30GB root ("/") partition for programs.  The installer automatically detected my previously formatted 5GB swap partition.  It seemed that people were <a href="https://web.archive.org/web/20150408214132/http://ubuntuforums.org/showthread.php?t=1133719&amp;page=33">still having problems</a> with ext4, so I formatted the root partition as ext3.  At reboot, GRUB did say that I was installing a PAE kernel, so that was good.<br/>
<br/>
<b>Installing Software</b><br/>
<br/>
Now I ran the second half of <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/03/ubuntu-910-downgrading-from-64-bit-to.html">the installed-software command</a> (above) to restore the set of programs that I had installed on Ubuntu at various points.  This involved using Nautilus to put a copy of my installed-software list someplace accessible (I chose my Desktop), using "cd ~/Desktop" as the short way of getting to the desktop, and then typing the necessary commands:<br/>
<blockquote>sudo dpkg --set-selections &lt; installed-software<br/>
sudo apt-get install dselect<br/>
sudo dselect</blockquote>This gave me a menu, from which I chose option 3, "Install and upgrade wanted packages."  It did so.  It took about an hour.  During the process, it asked "Do you want to erase any previously downloaded .deb files?"  <a href="https://web.archive.org/web/20150408214132/http://www.google.com/search?q=%22do+you+want+to+erase+any+previously+downloaded+.deb+files%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=71g&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=%22do+you+want+to+erase+any+previously+downloaded+.deb+files%22+ubuntu+dselect&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;pbx=1&amp;fp=d331bd8e2d0de10c">My search</a> yielded no clear answer to this question.  I guessed, from a couple of things I saw in that search, that this was like the question that came up in some Windows installations (in Microsoft Office, perhaps), where you would have the option of keeping downloads on the hard drive to make future fixes or upgrades faster, at the expense of consuming additional disk space.  I tried the Yes option.  It paused for a minute and then put me back at the menu.  So I guess it deleted some .deb files.  Anyway, the installed packages included ntfs-config, so now I could run that ("sudo ntfs-config"), so that Ubuntu would recognize my NTFS (Windows) partitions and put appropriate entries in /etc/fstab.  So then /home would be recognized on reboot.<br/>
<br/>
Unfortunately, something in the install-software process screwed up my system, leading to a "udevadm" error message and a <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-udevadm-trigger-is-not.html">whole separate post</a>.  But then, when I rebooted, I had another problem.  I was looking at a nearly blank screen.  It just showed the name of Ubuntu across the top ("Ubuntu 10.04.1 LTS P4 tty1," where P4 was the name of my computer) and then gave me a simple login prompt:  "P4 login."  I wasn't sure what to search for, to solve this problem, so I booted with the <a href="https://web.archive.org/web/20150408214132/http://www.ubuntu.com/getubuntu/downloadmirrors">alternative installation CD</a> and chose the "Rescue a broken system" option.  Ultimately, it gave me two basic options:  either reinstall GRUB or execute a shell in my Ubuntu program partition (in my case, /dev/sdb8).  I had no idea what to type at the prompt, and I didn't seem to be having a GRUB problem, so I tried <a href="https://web.archive.org/web/20150408214132/http://www.google.com/search?q=ubuntu+10.04+%22blank+login+screen%22&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a#num=50&amp;hl=en&amp;newwindow=1&amp;client=firefox-a&amp;hs=mBf&amp;rls=org.mozilla%3Aen-US%3Aofficial&amp;q=ubuntu+10.04+%22blank+login+screen%22&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=ubuntu+10.04+%22blank+login+screen%22&amp;gs_rfai=&amp;pbx=1&amp;fp=70bfc538efc94ade">a search</a>; but it turned up stuff dealing with monitor problems.  I tried <a href="https://web.archive.org/web/20150408214132/http://www.google.com/search?q=ubuntu+tty1+prompt+login&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a">another search</a> and came across the idea that I could just type "startx" to open the graphical user interface (GUI), so I rebooted, entered my username and password at that prompt, and then typed startx.  But this gave me some error messages:  "Failed to open device," "No valid modes," and "Screen(s) found, but none have a usable configuration."<br/>
<br/>
Basically, it seemed that the installed-software process had messed up my system.  So I started over, installing Ubuntu from scratch, and this time I didn't use the installed-software option.  I had to go back through the process of setting up my separate /home partition, and then <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-manual-approach-to.html">I worked manually</a> through the installed-software process.  That entailed <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/09/ubuntu-1004-repositories.html">setting up my repositories</a>.  After that process, some programs were still not installed.  Drawing upon my previous installation and its <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/03/ubuntu-910-downgrading-from-64-bit-to.html">follow-on comments</a> (as well as notes in a few other posts), I used System &gt; Administration &gt; Synaptic Package Manager to install acroread, adobe-flashplugin, boinc, dvgrab, fdutils, gparted, mplayer, nautilus-open-terminal, ntfsprogs, p7zip-full, sysinfo, ubuntu-tweak, unetbootin, and webhttrack.  Then I installed several programs that I had downloaded separately, on the assumption they were not available via Synaptic.  These included VMware Workstation 7, which I installed, <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/06/vmware-workstation-7-installation.html">as I had learned</a> to do, by typing "sh VMware-Workstation-Full-7.1.0-261024.i386.bundle" in the folder containing that downloaded bundle file.  The simple "sudo sh" prefix was also adequate for installing my separate .bin downloads (i.e., GoogleEarthLinux.bin).  I installed Beyond Compare, Opera, and Google Chrome by just double-clicking on the .deb downloads.<br/>
<br/>
<b>Settings and Adjustments</b><br/>
<br/>
Creating the separate /home partition had preserved most of my Nautilus settings, but I still had to tweak a few of those manually.  It had not saved my monitor driver settings, so now I went into System &gt; Administration &gt; Hardware Drivers, searched for available drivers and, for my machine, found NVIDIA accelerated graphics driver (current version) &gt; Activate.  This, like other installation and activation steps, would work only when there was no other Synaptic or software installer running.  I rebooted to activate the hardware driver.  Unfortunately, I was still getting some bad ghosting.  Tightening my video cable connectors solved the problem.<br/>
<br/>
Most of my newly installed programs did not require immediate configuration.  To configure BOINC, I went to Applications &gt; System Tools &gt; BOINC Manager &gt; Next &gt; Choose a Project &gt; World Community Grid &gt; Next, and then went into Advanced &gt; Settings to adjust my preferences. <br/>
<br/>
GRUB2 had lost the setting by which it would remember which operating system I had booted last, and would reboot that one instead of defaulting to Ubuntu, so I typed "sudo gedit /etc/default/grub"; I changed one line to say GRUB_DEFAULT=saved instead of GRUB_DEFAULT=0; I added another line, right after it, that said "GRUB_SAVEDEFAULT=true"; I saved and closed that file; and then I typed "sudo update-grub."<br/>
<br/>
Following <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/06/ubuntu-1004-windows-dual-boot-customize.html">a previous post</a>, I pruned the list of entries shown in the GRUB2 menu at bootup.  First, I typed "sudo gedit /etc/grub.d/10_linux" and added a line, immediately after the comments section at the top, that said "GRUB_DISABLE_LINUX_RECOVERY=true" (without quotes, as always).  That would prevent me from seeing the "recovery" versions of Linux kernels in that menu.  At the end of that same file, I searched for the place that had these two lines:<br/>
<blockquote>list=`echo $list | tr ' ' '\n' | grep -vx $linux | tr '\n' ' '`<br/>
done</blockquote>and changed it by inserting another list line between those two:<br/>
<blockquote>list=`echo $list | tr ' ' '\n' | grep -vx $linux | tr '\n' ' '`<br/>
list=`version_find_latest $list`<br/>
done</blockquote>(Note that backticks ( ` ) are not the same as single quotes ( ' ) in such files.)  This, I hoped, would show me just the one or two most recent Linux kernels.  Finally, I saved and closed 10_linux and modified its companion file with this command:  "sudo chmod -x /etc/grub.d/20_memtest86+."  This command would hopefully prevent me from seeing the memtest options in the GRUB2 menu.  I rebooted and confirmed that it worked.<br/>
<br/>
Other settings did remain intact via the preserved /home partition.  Unlike the steps described in the previous installation and in <a href="https://web.archive.org/web/20150408214132/http://raywoodcockslatest.blogspot.com/2010/05/tweaking-ubuntu-1004.html">another tweak post</a>, I did not have to make manual adjustments to prevent icons for mounted drives from appearing on the desktop.  My previous list of programs that should run at startup remained intact.  Gedit was still my default crontab editor.  The permissions giving me access to various partitions as ordinary user, not root, were still in place.  My VMware settings seemed to have been preserved, except for what may have been a few new root-level settings in the new version of VMware Workstation that I had just installed.<br/>
<br/>
When these steps were complete, I ran Update Manager one last time, rebooted, and confirmed that everything looked good.  Then I rebooted with a CD and made an Acronis disk image on a separate partition.  Done!</p>
<div style="clear: both;"></div>
</div>

---
### Comments
